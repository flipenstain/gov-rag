{
    "target_table": "wh_db.DimCompany",
    "sources_summary": {
        "tables": [
            "wh_db_stage.FinWire",
            "wh_db.industry"
        ],
        "ctes": [
            "cmp"
        ]
    },
    "lineage": {
        "sk_companyid": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CAST(TRIM(SUBSTR(value, 61, 10)) AS BIGINT)",
                "transformation_type": "CAST",
                "role": "N/A"
            },
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "recdate",
                "path": [],
                "transformation_logic": "strftime(effectivedate, '%Y%m%d')",
                "transformation_type": "CAST",
                "role": "N/A"
            },
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "recdate",
                "path": [],
                "transformation_logic": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)",
                "transformation_type": "EXPRESSION_CONCAT",
                "role": "N/A"
            }
        ],
        "companyid": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CAST(TRIM(SUBSTR(value, 61, 10)) AS BIGINT)",
                "transformation_type": "CAST",
                "role": "N/A"
            }
        ],
        "status": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 71, 4))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            },
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
                "transformation_type": "CASE_MAPPING",
                "role": "condition input"
            }
        ],
        "name": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 1, 60))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "industry": [
            {
                "source_table": "wh_db.industry",
                "source_column": "in_name",
                "path": [],
                "transformation_logic": "ind.in_name",
                "transformation_type": "RENAME",
                "role": "N/A"
            }
        ],
        "sprating": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 77, 4))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            },
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
                "transformation_type": "CASE_MAPPING",
                "role": "condition input"
            }
        ],
        "islowgrade": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 77, 4))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            },
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
                "transformation_type": "CASE_MAPPING",
                "role": "condition input"
            }
        ],
        "ceo": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 330, 46))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "addressline1": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 89, 80))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "addressline2": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 169, 80))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "postalcode": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 249, 12))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "city": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 261, 25))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "stateprov": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 286, 20))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "country": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 306, 24))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "description": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRIM(SUBSTR(value, 376, 150))",
                "transformation_type": "SUBSTRING",
                "role": "N/A"
            }
        ],
        "foundingdate": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "TRY_CAST(TRY_CAST(SUBSTRING(value, 81, 8) AS TIMESTAMP) AS DATE)",
                "transformation_type": "CAST",
                "role": "N/A"
            }
        ],
        "iscurrent": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "recdate",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
                "transformation_type": "SCD2_LOGIC",
                "role": "N/A"
            }
        ],
        "batchid": [
            {
                "source_table": null,
                "source_column": null,
                "path": [],
                "transformation_logic": "1",
                "transformation_type": "CONSTANT",
                "role": "N/A"
            }
        ],
        "effectivedate": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "recdate",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "recdate",
                "transformation_type": "RENAME",
                "role": "N/A"
            }
        ],
        "enddate": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "recdate",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
                "transformation_type": "SCD2_LOGIC",
                "role": "N/A"
            }
        ]
    }
}