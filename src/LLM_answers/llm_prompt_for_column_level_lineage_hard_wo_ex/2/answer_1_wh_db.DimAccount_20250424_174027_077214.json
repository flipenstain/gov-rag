{
    "target_table": "wh_db.DimAccount",
    "sources_summary": {
        "wh_db_stage.CustomerMgmt": [
            "accountid",
            "customerid",
            "accountdesc",
            "taxstatus",
            "brokerid",
            "status",
            "update_ts"
        ],
        "wh_db.DimCustomer": [
            "sk_customerid",
            "customerid",
            "effectivedate",
            "enddate"
        ],
        "wh_db.DimBroker": [
            "sk_brokerid",
            "brokerid"
        ]
    },
    "lineage": {
        "sk_accountid": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "accountid"
                },
                {
                    "table": "account_cust_updates",
                    "column": "effectivedate"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)",
            "transformation_type": "EXPRESSION_CONCAT"
        },
        "accountid": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "accountid"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.accountid",
            "transformation_type": "RENAME"
        },
        "sk_brokerid": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "brokerid"
                },
                {
                    "table": "wh_db.DimBroker",
                    "column": "sk_brokerid"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a",
                "b"
            ],
            "transformation_logic": "b.sk_brokerid",
            "transformation_type": "JOIN_LOOKUP",
            "role": "join key"
        },
        "sk_customerid": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "customerid"
                },
                {
                    "table": "wh_db.DimCustomer",
                    "column": "sk_customerid"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.sk_customerid",
            "transformation_type": "RENAME"
        },
        "accountdesc": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "accountdesc"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.accountdesc",
            "transformation_type": "RENAME"
        },
        "taxstatus": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "taxstatus"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.TaxStatus",
            "transformation_type": "RENAME"
        },
        "status": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "status"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.status",
            "transformation_type": "RENAME"
        },
        "iscurrent": {
            "sources": [
                {
                    "table": "account_cust_updates",
                    "column": "enddate"
                }
            ],
            "path": [
                "a"
            ],
            "transformation_logic": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END",
            "transformation_type": "CASE_MAPPING"
        },
        "batchid": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "batchid"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.batchid",
            "transformation_type": "RENAME"
        },
        "effectivedate": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "update_ts"
                },
                {
                    "table": "wh_db.DimCustomer",
                    "column": "effectivedate"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.effectivedate",
            "transformation_type": "SCD2_LOGIC"
        },
        "enddate": {
            "sources": [
                {
                    "table": "wh_db_stage.CustomerMgmt",
                    "column": "update_ts"
                },
                {
                    "table": "wh_db.DimCustomer",
                    "column": "enddate"
                }
            ],
            "path": [
                "account",
                "account_final",
                "account_cust_updates",
                "a"
            ],
            "transformation_logic": "a.enddate",
            "transformation_type": "SCD2_LOGIC"
        }
    }
}