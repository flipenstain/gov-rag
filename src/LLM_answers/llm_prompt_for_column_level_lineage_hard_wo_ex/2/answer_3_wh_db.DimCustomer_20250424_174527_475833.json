{
    "target_table": "wh_db.DimCustomer",
    "sources_summary": {
        "tables": [
            "customers_final",
            "wh_db.TaxRate",
            "wh_db_stage.ProspectIncremental",
            "wh_db.DimCustomer"
        ],
        "ctes": [
            "MaxSK",
            "CustomerData"
        ]
    },
    "lineage": {
        "sk_customerid": {
            "sources": [
                {
                    "table": "wh_db.DimCustomer",
                    "column": "sk_customerid",
                    "path": [
                        "MaxSK"
                    ],
                    "transformation_type": "AGGREGATION",
                    "transformation_logic": "COALESCE(MAX(sk_customerid), 0)",
                    "role": "input"
                }
            ],
            "transformation_type": "ROW_NUMBER",
            "transformation_logic": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1",
            "description": "Assigning surrogate key based on max existing key"
        },
        "customerid": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "customerid",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.customerid"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.customerid"
        },
        "taxid": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "taxid",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.taxid"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.taxid"
        },
        "status": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "status",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.status"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.status"
        },
        "lastname": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "lastname",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.lastname"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.lastname"
        },
        "firstname": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "firstname",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.firstname"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.firstname"
        },
        "middleinitial": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "middleinitial",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.middleinitial"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.middleinitial"
        },
        "gender": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "gender",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "CASE_MAPPING",
                    "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')",
                    "role": "condition_input"
                }
            ],
            "transformation_type": "CASE_MAPPING",
            "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')"
        },
        "tier": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "tier",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.tier"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.tier"
        },
        "dob": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "dob",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.dob"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.dob"
        },
        "addressline1": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "addressline1",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.addressline1"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline1"
        },
        "addressline2": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "addressline2",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.addressline2"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline2"
        },
        "postalcode": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "postalcode",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.postalcode"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.postalcode"
        },
        "city": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "city",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.city"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.city"
        },
        "stateprov": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "stateprov",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.stateprov"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.stateprov"
        },
        "country": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "country",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.country"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.country"
        },
        "phone1": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone1",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone1"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone1"
        },
        "phone2": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone2",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone2"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone2"
        },
        "phone3": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone3",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone3"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone3"
        },
        "email1": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "email1",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.email1"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email1"
        },
        "email2": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "email2",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.email2"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email2"
        },
        "nationaltaxratedesc": {
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_NAME",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_nat.TX_NAME"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "nationaltaxratedesc"
        },
        "nationaltaxrate": {
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_RATE",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_nat.TX_RATE"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "nationaltaxrate"
        },
        "localtaxratedesc": {
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_NAME",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_lcl.TX_NAME"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "localtaxratedesc"
        },
        "localtaxrate": {
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_RATE",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_lcl.TX_RATE"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "localtaxrate"
        },
        "agencyid": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "agencyid",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.agencyid"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "agencyid"
        },
        "creditrating": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "creditrating",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.creditrating"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "creditrating"
        },
        "networth": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "networth",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.networth"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "networth"
        },
        "marketingnameplate": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "marketingnameplate",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.marketingnameplate"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "marketingnameplate"
        },
        "iscurrent": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "iscurrent",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.iscurrent"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "iscurrent"
        },
        "batchid": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "batchid",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.batchid"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "batchid"
        },
        "effectivedate": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "effectivedate",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.effectivedate"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "effectivedate"
        },
        "enddate": {
            "sources": [
                {
                    "table": "customers_final",
                    "column": "enddate",
                    "path": [
                        "CustomerData"
                    ],
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.enddate"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "enddate"
        }
    }
}