{
    "target_table": "wh_db.Financial",
    "sources_summary": {
        "wh_db_stage.FinWire": [
            "value",
            "recdate",
            "rectype"
        ],
        "wh_db.DimCompany": [
            "sk_companyid",
            "companyid",
            "name",
            "effectivedate",
            "enddate"
        ]
    },
    "lineage": {
        "sk_companyid": {
            "path": [
                "dc"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "dc.sk_companyid",
            "source_columns": [
                {
                    "table": "wh_db.DimCompany",
                    "column": "sk_companyid"
                }
            ]
        },
        "fi_year": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 1 FOR 4) AS INTEGER)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_qtr": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 5 FOR 1) AS INTEGER)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_qtr_start_date": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "strptime(SUBSTRING(value FROM 6 FOR 8), '%Y%m%d')::DATE",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_revenue": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 22 FOR 17) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_net_earn": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 39 FOR 17) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_basic_eps": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 56 FOR 12) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_dilut_eps": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 68 FOR 12) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_margin": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 80 FOR 12) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_inventory": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 92 FOR 17) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_assets": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 109 FOR 17) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_liability": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 126 FOR 17) AS DOUBLE)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_out_basic": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 143 FOR 13) AS BIGINT)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        },
        "fi_out_dilut": {
            "path": [
                "finwire_parsed"
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(SUBSTRING(value FROM 156 FOR 13) AS BIGINT)",
            "source_columns": [
                {
                    "table": "wh_db_stage.FinWire",
                    "column": "value"
                }
            ]
        }
    }
}