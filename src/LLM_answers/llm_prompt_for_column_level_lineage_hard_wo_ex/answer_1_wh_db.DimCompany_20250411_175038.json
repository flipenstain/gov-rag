{
    "target_table": "wh_db.DimProduct",
    "sources_summary": {
        "wh_db_stage.FinWire": "Used as the primary source for product information.",
        "wh_db.DimProduct": "Used to determine the maximum ProductKey for SCD2 implementation."
    },
    "lineage": {
        "ProductKey": [
            {
                "source_table": "wh_db.DimProduct",
                "source_column": "ProductKey",
                "path": [],
                "transformation_logic": "MAX(ProductKey) + 1",
                "transformation_type": "SCD2_LOGIC",
                "role": "MAX_VALUE"
            }
        ],
        "ProductName": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.value",
                "transformation_type": "RENAME",
                "role": "SOURCE"
            }
        ],
        "ProductAlternateKey": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "id",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.id",
                "transformation_type": "RENAME",
                "role": "SOURCE"
            }
        ],
        "ProductSubcategoryKey": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "type",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE WHEN cmp.type = 'Electronics' THEN 1 WHEN cmp.type = 'Clothing' THEN 2 ELSE -1 END",
                "transformation_type": "CASE_MAPPING",
                "role": "CONDITION_INPUT"
            }
        ],
        "ProductModelName": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "SUBSTR(cmp.value, 1, 20)",
                "transformation_type": "SUBSTRING",
                "role": "SOURCE"
            }
        ],
        "ProductDescription": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.value || ' - Description'",
                "transformation_type": "EXPRESSION_CONCAT",
                "role": "SOURCE"
            }
        ],
        "ProductColor": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CASE WHEN cmp.value LIKE '%Red%' THEN 'Red' WHEN cmp.value LIKE '%Blue%' THEN 'Blue' ELSE 'Unknown' END",
                "transformation_type": "CASE_MAPPING",
                "role": "CONDITION_INPUT"
            }
        ],
        "ListPrice": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "price",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "CAST(cmp.price AS DECIMAL(10,2))",
                "transformation_type": "CAST",
                "role": "SOURCE"
            }
        ],
        "Size": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "size",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.size",
                "transformation_type": "RENAME",
                "role": "SOURCE"
            }
        ],
        "Weight": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "weight",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.weight",
                "transformation_type": "RENAME",
                "role": "SOURCE"
            }
        ],
        "ValidFrom": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "created_at",
                "path": [
                    "cmp"
                ],
                "transformation_logic": "cmp.created_at",
                "transformation_type": "RENAME",
                "role": "SOURCE"
            }
        ],
        "ValidTo": [
            {
                "source_table": null,
                "source_column": null,
                "path": [],
                "transformation_logic": "'9999-12-31'",
                "transformation_type": "CONSTANT",
                "role": "DEFAULT_VALUE"
            }
        ]
    }
}