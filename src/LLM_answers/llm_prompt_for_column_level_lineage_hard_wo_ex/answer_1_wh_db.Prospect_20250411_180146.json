{
    "target_table": "wh_db.Prospect",
    "sources_summary": {
        "wh_db_stage.ProspectIncremental": [
            "agencyid",
            "recordbatchid",
            "batchid",
            "lastname",
            "firstname",
            "middleinitial",
            "gender",
            "addressline1",
            "addressline2",
            "postalcode",
            "city",
            "state",
            "country",
            "phone",
            "income",
            "numbercars",
            "numberchildren",
            "maritalstatus",
            "age",
            "creditrating",
            "ownorrentflag",
            "employer",
            "numbercreditcards",
            "networth",
            "marketingnameplate"
        ],
        "wh_db.BatchDate": [
            "batchdate",
            "batchid"
        ],
        "wh_db.DimCustomer": [
            "lastname",
            "firstname",
            "addressline1",
            "addressline2",
            "postalcode",
            "iscurrent"
        ]
    },
    "lineage": {
        "agencyid": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "agencyid",
                    "path": [],
                    "transformation_logic": "p.agencyid",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "sk_recorddateid": {
            "sources": [
                {
                    "table": "wh_db.BatchDate",
                    "column": "batchdate",
                    "path": [],
                    "transformation_logic": "CAST(STRFTIME(recdate.batchdate, '%Y%m%d') AS BIGINT)",
                    "transformation_type": "CAST",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "sk_updatedateid": {
            "sources": [
                {
                    "table": "wh_db.BatchDate",
                    "column": "batchdate",
                    "path": [],
                    "transformation_logic": "CAST(STRFTIME(origdate.batchdate, '%Y%m%d') AS BIGINT)",
                    "transformation_type": "CAST",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "batchid": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "batchid",
                    "path": [],
                    "transformation_logic": "p.batchid",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "iscustomer": {
            "sources": [
                {
                    "table": "wh_db.DimCustomer",
                    "column": "lastname",
                    "path": [
                        "cust"
                    ],
                    "transformation_logic": "CASE WHEN c.LastName IS NOT NULL THEN TRUE ELSE FALSE END",
                    "transformation_type": "CASE_MAPPING",
                    "column_role": "CONDITION_INPUT"
                }
            ]
        },
        "lastname": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "lastname",
                    "path": [],
                    "transformation_logic": "p.lastname",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "firstname": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "firstname",
                    "path": [],
                    "transformation_logic": "p.firstname",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "middleinitial": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "middleinitial",
                    "path": [],
                    "transformation_logic": "p.middleinitial",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "gender": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "gender",
                    "path": [],
                    "transformation_logic": "p.gender",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "addressline1": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "addressline1",
                    "path": [],
                    "transformation_logic": "p.addressline1",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "addressline2": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "addressline2",
                    "path": [],
                    "transformation_logic": "p.addressline2",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "postalcode": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "postalcode",
                    "path": [],
                    "transformation_logic": "p.postalcode",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "city": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "city",
                    "path": [],
                    "transformation_logic": "p.city",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "state": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "state",
                    "path": [],
                    "transformation_logic": "p.state",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "country": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "country",
                    "path": [],
                    "transformation_logic": "p.country",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "phone": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "phone",
                    "path": [],
                    "transformation_logic": "p.phone",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "income": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "income",
                    "path": [],
                    "transformation_logic": "p.income",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "numbercars": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "numbercars",
                    "path": [],
                    "transformation_logic": "p.numbercars",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "numberchildren": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "numberchildren",
                    "path": [],
                    "transformation_logic": "p.numberchildren",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "maritalstatus": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "maritalstatus",
                    "path": [],
                    "transformation_logic": "p.maritalstatus",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "age": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "age",
                    "path": [],
                    "transformation_logic": "p.age",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "creditrating": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "creditrating",
                    "path": [],
                    "transformation_logic": "p.creditrating",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "ownorrentflag": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "ownorrentflag",
                    "path": [],
                    "transformation_logic": "p.ownorrentflag",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "employer": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "employer",
                    "path": [],
                    "transformation_logic": "p.employer",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "numbercreditcards": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "numbercreditcards",
                    "path": [],
                    "transformation_logic": "p.numbercreditcards",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "networth": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "networth",
                    "path": [],
                    "transformation_logic": "p.networth",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        },
        "marketingnameplate": {
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "marketingnameplate",
                    "path": [],
                    "transformation_logic": "p.marketingnameplate",
                    "transformation_type": "RENAME",
                    "column_role": "OUTPUT"
                }
            ]
        }
    }
}