{
    "target_table": "wh_db.DimProduct",
    "sources_summary": {
        "tables": [
            "wh_db_stage.FinWire"
        ],
        "ctes": [
            "cmp",
            "cmp2",
            "cmp3"
        ]
    },
    "lineage": {
        "ProductKey": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "id",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "CAST(cmp.id AS INTEGER)",
                "transformation_type": "CAST"
            }
        ],
        "ProductAltKey": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "id",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "cmp.id",
                "transformation_type": "RENAME"
            }
        ],
        "ProductName": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "cmp.value",
                "transformation_type": "RENAME"
            }
        ],
        "ProductCategoryName": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "CASE WHEN cmp.value = 'abc' THEN 'Category A' ELSE 'Category B' END",
                "transformation_type": "CASE_MAPPING"
            }
        ],
        "ProductStartDate": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "ts",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "CAST(strftime('%Y-%m-%d %H:%M:%S', cmp.ts) AS DATETIME)",
                "transformation_type": "CAST"
            }
        ],
        "ProductEndDate": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "ts",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "LEAD(CAST(strftime('%Y-%m-%d %H:%M:%S', cmp.ts) AS DATETIME), 1, '9999-12-31') OVER (PARTITION BY cmp.id ORDER BY cmp.ts)",
                "transformation_type": "WINDOW_FUNCTION"
            }
        ],
        "ProductCurrentFlag": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "ts",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "CASE WHEN cmp3.next_ts IS NULL THEN 1 ELSE 0 END",
                "transformation_type": "SCD2_LOGIC"
            }
        ],
        "ProductPrice": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "TRY_CAST(SUBSTR(cmp.value, 1, 5) AS DECIMAL(10,2))",
                "transformation_type": "CAST"
            }
        ],
        "ProductDescription": [
            {
                "source_table": "wh_db_stage.FinWire",
                "source_column": "value",
                "path": [
                    "cmp",
                    "cmp2",
                    "cmp3"
                ],
                "transformation_logic": "TRIM(cmp.value) || ' - ' || CAST(cmp.id AS VARCHAR)",
                "transformation_type": "EXPRESSION_CONCAT"
            }
        ]
    }
}