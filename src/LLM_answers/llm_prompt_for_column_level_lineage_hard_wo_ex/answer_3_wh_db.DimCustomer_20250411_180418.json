{
    "target_table": "wh_db.DimCustomer",
    "sources_summary": {
        "customers_final": [
            "customerid",
            "taxid",
            "status",
            "lastname",
            "firstname",
            "middleinitial",
            "gender",
            "tier",
            "dob",
            "addressline1",
            "addressline2",
            "postalcode",
            "city",
            "stateprov",
            "country",
            "phone1",
            "phone2",
            "phone3",
            "email1",
            "email2",
            "lcl_tx_id",
            "nat_tx_id",
            "iscurrent",
            "batchid",
            "effectivedate",
            "enddate"
        ],
        "wh_db.TaxRate": [
            "TX_ID",
            "TX_NAME",
            "TX_RATE"
        ],
        "wh_db_stage.ProspectIncremental": [
            "agencyid",
            "creditrating",
            "networth",
            "marketingnameplate",
            "lastname",
            "firstname",
            "addressline1",
            "addressline2",
            "postalcode"
        ],
        "wh_db.DimCustomer": [
            "sk_customerid"
        ]
    },
    "lineage": {
        "sk_customerid": {
            "path": [
                "MaxSK"
            ],
            "transformation_type": "ROW_NUMBER",
            "transformation_logic": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1",
            "sources": [
                {
                    "table": "wh_db.DimCustomer",
                    "column": "sk_customerid",
                    "role": "MAX_VALUE",
                    "transformation_type": "AGGREGATION",
                    "transformation_logic": "COALESCE(MAX(sk_customerid), 0)"
                }
            ]
        },
        "customerid": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.customerid",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "customerid",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.customerid"
                }
            ]
        },
        "taxid": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.taxid",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "taxid",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.taxid"
                }
            ]
        },
        "status": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.status",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "status",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.status"
                }
            ]
        },
        "lastname": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.lastname",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "lastname",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.lastname"
                }
            ]
        },
        "firstname": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.firstname",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "firstname",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.firstname"
                }
            ]
        },
        "middleinitial": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.middleinitial",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "middleinitial",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.middleinitial"
                }
            ]
        },
        "gender": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "CASE_MAPPING",
            "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "gender",
                    "role": "CONDITION_INPUT",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.gender"
                }
            ]
        },
        "tier": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.tier",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "tier",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.tier"
                }
            ]
        },
        "dob": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.dob",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "dob",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.dob"
                }
            ]
        },
        "addressline1": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline1",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "addressline1",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.addressline1"
                }
            ]
        },
        "addressline2": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline2",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "addressline2",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.addressline2"
                }
            ]
        },
        "postalcode": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.postalcode",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "postalcode",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.postalcode"
                }
            ]
        },
        "city": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.city",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "city",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.city"
                }
            ]
        },
        "stateprov": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.stateprov",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "stateprov",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.stateprov"
                }
            ]
        },
        "country": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.country",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "country",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.country"
                }
            ]
        },
        "phone1": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone1",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone1",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone1"
                }
            ]
        },
        "phone2": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone2",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone2",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone2"
                }
            ]
        },
        "phone3": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone3",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "phone3",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.phone3"
                }
            ]
        },
        "email1": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email1",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "email1",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.email1"
                }
            ]
        },
        "email2": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email2",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "email2",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.email2"
                }
            ]
        },
        "nationaltaxratedesc": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "r_nat.TX_NAME",
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_NAME",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_nat.TX_NAME"
                }
            ]
        },
        "nationaltaxrate": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "r_nat.TX_RATE",
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_RATE",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_nat.TX_RATE"
                }
            ]
        },
        "localtaxratedesc": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "r_lcl.TX_NAME",
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_NAME",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_lcl.TX_NAME"
                }
            ]
        },
        "localtaxrate": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "r_lcl.TX_RATE",
            "sources": [
                {
                    "table": "wh_db.TaxRate",
                    "column": "TX_RATE",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "r_lcl.TX_RATE"
                }
            ]
        },
        "agencyid": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "p.agencyid",
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "agencyid",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.agencyid"
                }
            ]
        },
        "creditrating": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "p.creditrating",
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "creditrating",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.creditrating"
                }
            ]
        },
        "networth": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "p.networth",
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "networth",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.networth"
                }
            ]
        },
        "marketingnameplate": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "p.marketingnameplate",
            "sources": [
                {
                    "table": "wh_db_stage.ProspectIncremental",
                    "column": "marketingnameplate",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "p.marketingnameplate"
                }
            ]
        },
        "iscurrent": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.iscurrent",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "iscurrent",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.iscurrent"
                }
            ]
        },
        "batchid": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.batchid",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "batchid",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.batchid"
                }
            ]
        },
        "effectivedate": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.effectivedate",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "effectivedate",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.effectivedate"
                }
            ]
        },
        "enddate": {
            "path": [
                "CustomerData"
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.enddate",
            "sources": [
                {
                    "table": "customers_final",
                    "column": "enddate",
                    "role": "SOURCE",
                    "transformation_type": "RENAME",
                    "transformation_logic": "c.enddate"
                }
            ]
        }
    }
}