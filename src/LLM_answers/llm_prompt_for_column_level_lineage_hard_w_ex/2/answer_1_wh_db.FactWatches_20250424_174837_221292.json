{
    "target_table": "wh_db.FactWatches",
    "sources_summary": [
        {
            "type": "TABLE",
            "name": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'})",
            "alias_or_cte": "watchhistory"
        },
        {
            "type": "TABLE",
            "name": "wh_db.DimSecurity",
            "alias_or_cte": "s"
        },
        {
            "type": "TABLE",
            "name": "wh_db.DimCustomer",
            "alias_or_cte": "c"
        }
    ],
    "lineage": {
        "sk_customerid": {
            "sources": [
                {
                    "source_identifier": "wh_db.DimCustomer.sk_customerid",
                    "path": [],
                    "role": "direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.sk_customerid"
        },
        "sk_securityid": {
            "sources": [
                {
                    "source_identifier": "wh_db.DimSecurity.sk_securityid",
                    "path": [],
                    "role": "direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "s.sk_securityid"
        },
        "sk_dateid_dateplaced": {
            "sources": [
                {
                    "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_dts",
                    "path": [
                        "watches.dateplaced"
                    ],
                    "role": "date part source"
                }
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(strftime(dateplaced, '%Y%m%d') AS BIGINT)"
        },
        "sk_dateid_dateremoved": {
            "sources": [
                {
                    "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_dts",
                    "path": [
                        "watches.dateremoved"
                    ],
                    "role": "date part source"
                }
            ],
            "transformation_type": "CAST",
            "transformation_logic": "CAST(strftime(dateremoved, '%Y%m%d') AS BIGINT)"
        },
        "batchid": {
            "sources": [
                {
                    "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_c_id",
                    "path": [
                        "watchhistory.batchid",
                        "watches.batchid"
                    ],
                    "role": "direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "wh.batchid"
        }
    }
}