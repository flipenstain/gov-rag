{
    "target_table": "wh_db.DimCustomer",
    "sources_summary": [
        {
            "type": "TABLE",
            "name": "customers_final",
            "alias_or_cte": "c"
        },
        {
            "type": "TABLE",
            "name": "wh_db.TaxRate",
            "alias_or_cte": "r_lcl"
        },
        {
            "type": "TABLE",
            "name": "wh_db.TaxRate",
            "alias_or_cte": "r_nat"
        },
        {
            "type": "TABLE",
            "name": "wh_db_stage.ProspectIncremental",
            "alias_or_cte": "p"
        },
        {
            "type": "TABLE",
            "name": "wh_db.DimCustomer",
            "alias_or_cte": "MaxSK"
        }
    ],
    "lineage": {
        "sk_customerid": {
            "sources": [
                {
                    "source_identifier": "wh_db.DimCustomer.sk_customerid",
                    "path": [
                        "MaxSK.max_sk_customerid"
                    ],
                    "role": "Source for max SK"
                }
            ],
            "transformation_type": "WINDOW_FUNCTION",
            "transformation_logic": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1"
        },
        "customerid": {
            "sources": [
                {
                    "source_identifier": "customers_final.customerid",
                    "path": [
                        "c.customerid"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.customerid"
        },
        "taxid": {
            "sources": [
                {
                    "source_identifier": "customers_final.taxid",
                    "path": [
                        "c.taxid"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.taxid"
        },
        "status": {
            "sources": [
                {
                    "source_identifier": "customers_final.status",
                    "path": [
                        "c.status"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.status"
        },
        "lastname": {
            "sources": [
                {
                    "source_identifier": "customers_final.lastname",
                    "path": [
                        "c.lastname"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.lastname"
        },
        "firstname": {
            "sources": [
                {
                    "source_identifier": "customers_final.firstname",
                    "path": [
                        "c.firstname"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.firstname"
        },
        "middleinitial": {
            "sources": [
                {
                    "source_identifier": "customers_final.middleinitial",
                    "path": [
                        "c.middleinitial"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.middleinitial"
        },
        "gender": {
            "sources": [
                {
                    "source_identifier": "customers_final.gender",
                    "path": [
                        "c.gender"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "CASE_MAPPING",
            "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')"
        },
        "tier": {
            "sources": [
                {
                    "source_identifier": "customers_final.tier",
                    "path": [
                        "c.tier"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.tier"
        },
        "dob": {
            "sources": [
                {
                    "source_identifier": "customers_final.dob",
                    "path": [
                        "c.dob"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.dob"
        },
        "addressline1": {
            "sources": [
                {
                    "source_identifier": "customers_final.addressline1",
                    "path": [
                        "c.addressline1"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline1"
        },
        "addressline2": {
            "sources": [
                {
                    "source_identifier": "customers_final.addressline2",
                    "path": [
                        "c.addressline2"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.addressline2"
        },
        "postalcode": {
            "sources": [
                {
                    "source_identifier": "customers_final.postalcode",
                    "path": [
                        "c.postalcode"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.postalcode"
        },
        "city": {
            "sources": [
                {
                    "source_identifier": "customers_final.city",
                    "path": [
                        "c.city"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.city"
        },
        "stateprov": {
            "sources": [
                {
                    "source_identifier": "customers_final.stateprov",
                    "path": [
                        "c.stateprov"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.stateprov"
        },
        "country": {
            "sources": [
                {
                    "source_identifier": "customers_final.country",
                    "path": [
                        "c.country"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.country"
        },
        "phone1": {
            "sources": [
                {
                    "source_identifier": "customers_final.phone1",
                    "path": [
                        "c.phone1"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone1"
        },
        "phone2": {
            "sources": [
                {
                    "source_identifier": "customers_final.phone2",
                    "path": [
                        "c.phone2"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone2"
        },
        "phone3": {
            "sources": [
                {
                    "source_identifier": "customers_final.phone3",
                    "path": [
                        "c.phone3"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.phone3"
        },
        "email1": {
            "sources": [
                {
                    "source_identifier": "customers_final.email1",
                    "path": [
                        "c.email1"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email1"
        },
        "email2": {
            "sources": [
                {
                    "source_identifier": "customers_final.email2",
                    "path": [
                        "c.email2"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.email2"
        },
        "nationaltaxratedesc": {
            "sources": [
                {
                    "source_identifier": "wh_db.TaxRate.TX_NAME",
                    "join_info": {
                        "type": "INNER JOIN",
                        "left_source": {
                            "identifier": "customers_final.nat_tx_id",
                            "path": [
                                "c.nat_tx_id"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db.TaxRate.TX_ID"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "r_nat.TX_NAME via JOIN ON c.nat_tx_id = r_nat.TX_ID"
        },
        "nationaltaxrate": {
            "sources": [
                {
                    "source_identifier": "wh_db.TaxRate.TX_RATE",
                    "join_info": {
                        "type": "INNER JOIN",
                        "left_source": {
                            "identifier": "customers_final.nat_tx_id",
                            "path": [
                                "c.nat_tx_id"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db.TaxRate.TX_ID"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "r_nat.TX_RATE via JOIN ON c.nat_tx_id = r_nat.TX_ID"
        },
        "localtaxratedesc": {
            "sources": [
                {
                    "source_identifier": "wh_db.TaxRate.TX_NAME",
                    "join_info": {
                        "type": "INNER JOIN",
                        "left_source": {
                            "identifier": "customers_final.lcl_tx_id",
                            "path": [
                                "c.lcl_tx_id"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db.TaxRate.TX_ID"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "r_lcl.TX_NAME via JOIN ON c.lcl_tx_id = r_lcl.TX_ID"
        },
        "localtaxrate": {
            "sources": [
                {
                    "source_identifier": "wh_db.TaxRate.TX_RATE",
                    "join_info": {
                        "type": "INNER JOIN",
                        "left_source": {
                            "identifier": "customers_final.lcl_tx_id",
                            "path": [
                                "c.lcl_tx_id"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db.TaxRate.TX_ID"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "r_lcl.TX_RATE via JOIN ON c.lcl_tx_id = r_lcl.TX_ID"
        },
        "agencyid": {
            "sources": [
                {
                    "source_identifier": "wh_db_stage.ProspectIncremental.agencyid",
                    "join_info": {
                        "type": "LEFT JOIN",
                        "left_source": {
                            "identifier": "customers_final.lastname, customers_final.firstname, customers_final.addressline1, customers_final.addressline2, customers_final.postalcode",
                            "path": [
                                "c.lastname",
                                "c.firstname",
                                "c.addressline1",
                                "c.addressline2",
                                "c.postalcode"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db_stage.ProspectIncremental.lastname, wh_db_stage.ProspectIncremental.firstname, wh_db_stage.ProspectIncremental.addressline1, wh_db_stage.ProspectIncremental.addressline2, wh_db_stage.ProspectIncremental.postalcode"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "p.agencyid via LEFT JOIN on multiple columns"
        },
        "creditrating": {
            "sources": [
                {
                    "source_identifier": "wh_db_stage.ProspectIncremental.creditrating",
                    "join_info": {
                        "type": "LEFT JOIN",
                        "left_source": {
                            "identifier": "customers_final.lastname, customers_final.firstname, customers_final.addressline1, customers_final.addressline2, customers_final.postalcode",
                            "path": [
                                "c.lastname",
                                "c.firstname",
                                "c.addressline1",
                                "c.addressline2",
                                "c.postalcode"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db_stage.ProspectIncremental.lastname, wh_db_stage.ProspectIncremental.firstname, wh_db_stage.ProspectIncremental.addressline1, wh_db_stage.ProspectIncremental.addressline2, wh_db_stage.ProspectIncremental.postalcode"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "p.creditrating via LEFT JOIN on multiple columns"
        },
        "networth": {
            "sources": [
                {
                    "source_identifier": "wh_db_stage.ProspectIncremental.networth",
                    "join_info": {
                        "type": "LEFT JOIN",
                        "left_source": {
                            "identifier": "customers_final.lastname, customers_final.firstname, customers_final.addressline1, customers_final.addressline2, customers_final.postalcode",
                            "path": [
                                "c.lastname",
                                "c.firstname",
                                "c.addressline1",
                                "c.addressline2",
                                "c.postalcode"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db_stage.ProspectIncremental.lastname, wh_db_stage.ProspectIncremental.firstname, wh_db_stage.ProspectIncremental.addressline1, wh_db_stage.ProspectIncremental.addressline2, wh_db_stage.ProspectIncremental.postalcode"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "p.networth via LEFT JOIN on multiple columns"
        },
        "marketingnameplate": {
            "sources": [
                {
                    "source_identifier": "wh_db_stage.ProspectIncremental.marketingnameplate",
                    "join_info": {
                        "type": "LEFT JOIN",
                        "left_source": {
                            "identifier": "customers_final.lastname, customers_final.firstname, customers_final.addressline1, customers_final.addressline2, customers_final.postalcode",
                            "path": [
                                "c.lastname",
                                "c.firstname",
                                "c.addressline1",
                                "c.addressline2",
                                "c.postalcode"
                            ]
                        },
                        "right_source": {
                            "identifier": "wh_db_stage.ProspectIncremental.lastname, wh_db_stage.ProspectIncremental.firstname, wh_db_stage.ProspectIncremental.addressline1, wh_db_stage.ProspectIncremental.addressline2, wh_db_stage.ProspectIncremental.postalcode"
                        }
                    }
                }
            ],
            "transformation_type": "JOIN_LOOKUP",
            "transformation_logic": "p.marketingnameplate via LEFT JOIN on multiple columns"
        },
        "iscurrent": {
            "sources": [
                {
                    "source_identifier": "customers_final.iscurrent",
                    "path": [
                        "c.iscurrent"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.iscurrent"
        },
        "batchid": {
            "sources": [
                {
                    "source_identifier": "customers_final.batchid",
                    "path": [
                        "c.batchid"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.batchid"
        },
        "effectivedate": {
            "sources": [
                {
                    "source_identifier": "customers_final.effectivedate",
                    "path": [
                        "c.effectivedate"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.effectivedate"
        },
        "enddate": {
            "sources": [
                {
                    "source_identifier": "customers_final.enddate",
                    "path": [
                        "c.enddate"
                    ],
                    "role": "Direct input"
                }
            ],
            "transformation_type": "RENAME",
            "transformation_logic": "c.enddate"
        }
    }
}