2025-04-09 00:39:21,052 - INFO - AFC is enabled with max remote calls: 10.
2025-04-09 00:39:21,633 - INFO - AFC remote call 1 is done.
2025-04-09 00:39:21,640 - ERROR - Failed to decode JSON from response: ```json
{
  "DimDate": {
    "input": "src/data/Batch1/Date.txt"
  }
}
```
2025-04-09 00:42:45,231 - INFO - AFC is enabled with max remote calls: 10.
2025-04-09 00:42:52,071 - INFO - AFC remote call 1 is done.
2025-04-09 00:42:52,079 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      },
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(effectivedate, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)"
  },
  "companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      }
    ],
    "transformation": "CAST(cik AS BIGINT)"
  },
  "status": {
    "inputs": [
      {
        "column": "cmp.status",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
        "masking": false
      }
    ],
    "transformation": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END"
  },
  "name": {
    "input": "cmp.CompanyName"
  },
  "industry": {
    "inputs": [
      {
        "column": "wh_db.industry.in_name",
        "type": "DIRECT",
        "subtype": "Join",
        "description": "industry name from wh_db.industry table",
        "masking": false
      }
    ]
  },
  "sprating": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END"
  },
  "islowgrade": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END"
  },
  "ceo": {
    "input": "cmp.CEOname"
  },
  "addressline1": {
    "input": "cmp.AddrLine1"
  },
  "addressline2": {
    "input": "cmp.AddrLine2"
  },
  "postalcode": {
    "input": "cmp.PostalCode"
  },
  "city": {
    "input": "cmp.City"
  },
  "stateprov": {
    "input": "cmp.StateProvince"
  },
  "country": {
    "input": "cmp.Country"
  },
  "description": {
    "input": "cmp.Description"
  },
  "foundingdate": {
    "input": "cmp.FoundingDate"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
  },
  "batchid": {
    "input": "1"
  },
  "effectivedate": {
    "input": "cmp.recdate"
  },
  "enddate": {
    "inputs": [
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Window",
        "description": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
        "masking": false
      },
      {
        "column": "cmp.cik",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "PARTITION BY cik",
        "masking": false
      }
    ],
    "transformation": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))"
  }
}
```
2025-04-09 00:54:37,753 - INFO - AFC is enabled with max remote calls: 10.
2025-04-09 00:54:40,979 - INFO - AFC remote call 1 is done.
2025-04-09 00:54:40,987 - ERROR - Error during model call: process_llm_response() takes 2 positional arguments but 3 were given
2025-04-09 00:57:06,328 - INFO - AFC is enabled with max remote calls: 10.
2025-04-09 00:57:09,141 - INFO - AFC remote call 1 is done.
2025-04-09 00:57:09,141 - ERROR - Failed to decode JSON from response: ```json
{
  "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)": {
    "inputs": [
      {
        "column": "account_cust_updates.effectivedate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(a.effectivedate, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "account_cust_updates.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "a.accountid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)"
  },
  "a.accountid": {
    "input": "account_cust_updates.accountid"
  },
  "b.sk_brokerid": {
    "input": "wh_db.DimBroker.sk_brokerid"
  },
  "a.sk_customerid": {
    "input": "account_cust_updates.sk_customerid"
  },
  "a.accountdesc": {
    "input": "account_cust_updates.accountdesc"
  },
  "a.TaxStatus": {
    "input": "account_cust_updates.TaxStatus"
  },
  "a.status": {
    "input": "account_cust_updates.status"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "account_cust_updates.enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END"
  },
  "a.batchid": {
    "input": "account_cust_updates.batchid"
  },
  "a.effectivedate": {
    "input": "account_cust_updates.effectivedate"
  },
  "a.enddate": {
    "input": "account_cust_updates.enddate"
  }
}
```
2025-04-11 16:57:02,521 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:06,233 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:06,252 - ERROR - Failed to decode JSON from response: ```json
{
  "employeeid": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeeid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeeid",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "managerid": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.managerid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "managerid",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeefirstname": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeefirstname",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeefirstname",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeelastname": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeelastname",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeelastname",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeemi": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeemi",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeemi",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeejobcode": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeejobcode",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeejobcode",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeebranch": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeebranch",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeebranch",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeeoffice": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeeoffice",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeeoffice",
        "masking": false
      }
    ],
    "transformation": "Identity"
  },
  "employeephone": {
    "inputs": [
      {
        "column": "src/data/Batch1\\HR.csv.employeephone",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "employeephone",
        "masking": false
      }
    ],
    "transformation": "Identity"
  }
}
```
2025-04-11 16:57:11,275 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:13,964 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:13,964 - ERROR - Failed to decode JSON from response: ```json
{
  "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)": {
    "inputs": [
      {
        "column": "account_cust_updates.effectivedate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(a.effectivedate, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "account_cust_updates.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "a.accountid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)"
  },
  "a.accountid": {
    "input": "account_cust_updates.accountid"
  },
  "b.sk_brokerid": {
    "input": "wh_db.DimBroker.sk_brokerid"
  },
  "a.sk_customerid": {
    "input": "account_cust_updates.sk_customerid"
  },
  "a.accountdesc": {
    "input": "account_cust_updates.accountdesc"
  },
  "a.TaxStatus": {
    "input": "account_cust_updates.TaxStatus"
  },
  "a.status": {
    "input": "account_cust_updates.status"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "account_cust_updates.enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END"
  },
  "a.batchid": {
    "input": "account_cust_updates.batchid"
  },
  "a.effectivedate": {
    "input": "account_cust_updates.effectivedate"
  },
  "a.enddate": {
    "input": "account_cust_updates.enddate"
  }
}
```
2025-04-11 16:57:18,984 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:21,954 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:21,954 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_brokerid": {
    "input": "temp_broker.employeeid"
  },
  "brokerid": {
    "input": "temp_broker.employeeid"
  },
  "managerid": {
    "input": "temp_broker.managerid"
  },
  "firstname": {
    "input": "temp_broker.employeefirstname"
  },
  "lastname": {
    "input": "temp_broker.employeelastname"
  },
  "middleinitial": {
    "input": "temp_broker.employeemi"
  },
  "branch": {
    "input": "temp_broker.employeebranch"
  },
  "office": {
    "input": "temp_broker.employeeoffice"
  },
  "phone": {
    "input": "temp_broker.employeephone"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value 'true'",
        "masking": false
      }
    ],
    "transformation": "true"
  },
  "batchid": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value '1'",
        "masking": false
      }
    ],
    "transformation": "1"
  },
  "effectivedate": {
    "inputs": [
      {
        "column": "wh_db.DimDate.datevalue",
        "type": "DIRECT",
        "subtype": "Aggregation",
        "description": "MIN(datevalue::DATE)",
        "masking": false
      }
    ],
    "transformation": "MIN(datevalue::DATE)"
  },
  "enddate": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value '9999-12-31'::DATE",
        "masking": false
      }
    ],
    "transformation": "'9999-12-31'::DATE"
  }
}
```
2025-04-11 16:57:26,977 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:33,652 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:33,652 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      },
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(effectivedate, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)"
  },
  "companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      }
    ],
    "transformation": "CAST(cik AS BIGINT)"
  },
  "status": {
    "inputs": [
      {
        "column": "cmp.status",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
        "masking": false
      }
    ],
    "transformation": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END"
  },
  "name": {
    "input": "cmp.CompanyName"
  },
  "industry": {
    "inputs": [
      {
        "column": "wh_db.industry.in_name",
        "type": "DIRECT",
        "subtype": "Join",
        "description": "industry name from wh_db.industry table",
        "masking": false
      }
    ]
  },
  "sprating": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END"
  },
  "islowgrade": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END"
  },
  "ceo": {
    "input": "cmp.CEOname"
  },
  "addressline1": {
    "input": "cmp.AddrLine1"
  },
  "addressline2": {
    "input": "cmp.AddrLine2"
  },
  "postalcode": {
    "input": "cmp.PostalCode"
  },
  "city": {
    "input": "cmp.City"
  },
  "stateprov": {
    "input": "cmp.StateProvince"
  },
  "country": {
    "input": "cmp.Country"
  },
  "description": {
    "input": "cmp.Description"
  },
  "foundingdate": {
    "input": "cmp.FoundingDate"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
  },
  "batchid": {
    "input": "1"
  },
  "effectivedate": {
    "input": "cmp.recdate"
  },
  "enddate": {
    "inputs": [
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Window",
        "description": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
        "masking": false
      },
      {
        "column": "cmp.cik",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "PARTITION BY cik",
        "masking": false
      }
    ],
    "transformation": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))"
  }
}
```
2025-04-11 16:57:38,664 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:41,813 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:41,813 - ERROR - Failed to decode JSON from response: ```json
{
  "customerid": {"input": "wh_db_stage.CustomerMgmt.customerid"},
  "taxid": {"input": "wh_db_stage.CustomerMgmt.taxid"},
  "status": {"input": "wh_db_stage.CustomerMgmt.status"},
  "lastname": {"input": "wh_db_stage.CustomerMgmt.lastname"},
  "firstname": {"input": "wh_db_stage.CustomerMgmt.firstname"},
  "middleinitial": {"input": "wh_db_stage.CustomerMgmt.middleinitial"},
  "gender": {"input": "wh_db_stage.CustomerMgmt.gender"},
  "tier": {"input": "wh_db_stage.CustomerMgmt.tier"},
  "dob": {"input": "wh_db_stage.CustomerMgmt.dob"},
  "addressline1": {"input": "wh_db_stage.CustomerMgmt.addressline1"},
  "addressline2": {"input": "wh_db_stage.CustomerMgmt.addressline2"},
  "postalcode": {"input": "wh_db_stage.CustomerMgmt.postalcode"},
  "city": {"input": "wh_db_stage.CustomerMgmt.city"},
  "stateprov": {"input": "wh_db_stage.CustomerMgmt.stateprov"},
  "country": {"input": "wh_db_stage.CustomerMgmt.country"},
  "phone1": {"input": "wh_db_stage.CustomerMgmt.phone1"},
  "phone2": {"input": "wh_db_stage.CustomerMgmt.phone2"},
  "phone3": {"input": "wh_db_stage.CustomerMgmt.phone3"},
  "email1": {"input": "wh_db_stage.CustomerMgmt.email1"},
  "email2": {"input": "wh_db_stage.CustomerMgmt.email2"},
  "lcl_tx_id": {"input": "wh_db_stage.CustomerMgmt.lcl_tx_id"},
  "nat_tx_id": {"input": "wh_db_stage.CustomerMgmt.nat_tx_id"},
  "batchid": {
    "inputs": [
      {
        "column": "wh_db_stage.CustomerMgmt.ActionType",
        "type": "INDIRECT",
        "subtype": "Filter",
        "description": "ActionType used in WHERE clause",
        "masking": false
      }
    ],
    "transformation": "Constant value 1"
  },
  "update_ts": {
    "inputs": [
      {
        "column": "wh_db_stage.CustomerMgmt.ActionType",
        "type": "INDIRECT",
        "subtype": "Filter",
        "description": "ActionType used in WHERE clause",
        "masking": false
      }
    ],
    "input": "wh_db_stage.CustomerMgmt.update_ts"
  }
}
```
2025-04-11 16:57:46,854 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:47,528 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:47,528 - ERROR - Failed to decode JSON from response: ```json
{
  "DimDate": {
    "input": "src/data/Batch1/Date.txt"
  }
}
```
2025-04-11 16:57:52,565 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:57:55,017 - INFO - AFC remote call 1 is done.
2025-04-11 16:57:55,017 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_securityid": {
    "inputs": [],
    "transformation": "ROW_NUMBER() OVER ()"
  },
  "Symbol": {
    "input": "SEC_final.Symbol"
  },
  "issue": {
    "input": "SEC_final.issue"
  },
  "status": {
    "input": "SEC_final.status"
  },
  "Name": {
    "input": "SEC_final.Name"
  },
  "exchangeid": {
    "input": "SEC_final.exchangeid"
  },
  "sk_companyid": {
    "input": "SEC_final.sk_companyid"
  },
  "sharesoutstanding": {
    "input": "SEC_final.sharesoutstanding"
  },
  "firsttrade": {
    "input": "SEC_final.firsttrade"
  },
  "firsttradeonexchange": {
    "input": "SEC_final.firsttradeonexchange"
  },
  "Dividend": {
    "input": "SEC_final.Dividend"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "SEC_final.enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
  },
  "batchid": {
    "inputs": [],
    "transformation": "1"
  },
  "effectivedate": {
    "input": "SEC_final.effectivedate"
  },
  "enddate": {
    "input": "SEC_final.enddate"
  }
}
```
2025-04-11 16:58:00,058 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 16:58:00,912 - INFO - AFC remote call 1 is done.
2025-04-11 16:58:00,912 - ERROR - Failed to decode JSON from response: ```json
{
  "DimTime": {
    "inputs": [
      {
        "column": "src/data/Batch1\\Time.txt",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Data loaded from file",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:44:21,554 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:44:36,126 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:44:39,319 - INFO - AFC remote call 1 is done.
2025-04-11 17:44:39,334 - ERROR - Failed to decode JSON from response: ```json
{
  "employeeid": {
    "inputs": [
      {
        "column": "read_csv.employeeid",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "managerid": {
    "inputs": [
      {
        "column": "read_csv.managerid",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeefirstname": {
    "inputs": [
      {
        "column": "read_csv.employeefirstname",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeelastname": {
    "inputs": [
      {
        "column": "read_csv.employeelastname",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeemi": {
    "inputs": [
      {
        "column": "read_csv.employeemi",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeejobcode": {
    "inputs": [
      {
        "column": "read_csv.employeejobcode",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeebranch": {
    "inputs": [
      {
        "column": "read_csv.employeebranch",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeeoffice": {
    "inputs": [
      {
        "column": "read_csv.employeeoffice",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  },
  "employeephone": {
    "inputs": [
      {
        "column": "read_csv.employeephone",
        "type": "DIRECT",
        "subtype": "Filter",
        "description": "WHERE employeejobcode = '314'",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:46:15,755 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:16,921 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:16,921 - ERROR - Failed to decode JSON from response: The provided SQL query is a `CREATE OR REPLACE TEMP TABLE` statement, not an `INSERT INTO` statement. Therefore, it doesn't fit the format requested for lineage extraction. The requested format is designed for `INSERT INTO` statements where we can map target columns to source columns and transformations.  `CREATE TABLE AS SELECT` (CTAS) statements require a slightly different approach.

Since I cannot provide a valid JSON output in the requested format, I will return an empty JSON object.

```json
{}
```

2025-04-11 17:46:21,944 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:24,821 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:24,821 - ERROR - Failed to decode JSON from response: ```json
{
  "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)": {
    "inputs": [
      {
        "column": "account_cust_updates.effectivedate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(a.effectivedate, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "account_cust_updates.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "a.accountid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)"
  },
  "a.accountid": {
    "input": "account_cust_updates.accountid"
  },
  "b.sk_brokerid": {
    "input": "wh_db.DimBroker.sk_brokerid"
  },
  "a.sk_customerid": {
    "input": "account_cust_updates.sk_customerid"
  },
  "a.accountdesc": {
    "input": "account_cust_updates.accountdesc"
  },
  "a.TaxStatus": {
    "input": "account_cust_updates.TaxStatus"
  },
  "a.status": {
    "input": "account_cust_updates.status"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "account_cust_updates.enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END"
  },
  "a.batchid": {
    "input": "account_cust_updates.batchid"
  },
  "a.effectivedate": {
    "input": "account_cust_updates.effectivedate"
  },
  "a.enddate": {
    "input": "account_cust_updates.enddate"
  }
}
```
2025-04-11 17:46:29,831 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:32,616 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:32,621 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_brokerid": {
    "input": "temp_broker.employeeid"
  },
  "brokerid": {
    "input": "temp_broker.employeeid"
  },
  "managerid": {
    "input": "temp_broker.managerid"
  },
  "firstname": {
    "input": "temp_broker.employeefirstname"
  },
  "lastname": {
    "input": "temp_broker.employeelastname"
  },
  "middleinitial": {
    "input": "temp_broker.employeemi"
  },
  "branch": {
    "input": "temp_broker.employeebranch"
  },
  "office": {
    "input": "temp_broker.employeeoffice"
  },
  "phone": {
    "input": "temp_broker.employeephone"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value 'true'",
        "masking": false
      }
    ],
    "transformation": "true"
  },
  "batchid": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value '1'",
        "masking": false
      }
    ],
    "transformation": "1"
  },
  "effectivedate": {
    "inputs": [
      {
        "column": "wh_db.DimDate.datevalue",
        "type": "DIRECT",
        "subtype": "Aggregation",
        "description": "MIN(datevalue::DATE)",
        "masking": false
      }
    ],
    "transformation": "MIN(datevalue::DATE)"
  },
  "enddate": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value '9999-12-31'::DATE",
        "masking": false
      }
    ],
    "transformation": "'9999-12-31'::DATE"
  }
}
```
2025-04-11 17:46:37,631 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:44,586 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:44,589 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      },
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(effectivedate, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)"
  },
  "companyid": {
    "inputs": [
      {
        "column": "cmp.cik",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(cik AS BIGINT)",
        "masking": false
      }
    ],
    "transformation": "CAST(cik AS BIGINT)"
  },
  "status": {
    "inputs": [
      {
        "column": "cmp.status",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
        "masking": false
      }
    ],
    "transformation": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END"
  },
  "name": {
    "input": "cmp.CompanyName"
  },
  "industry": {
    "inputs": [
      {
        "column": "wh_db.industry.in_name",
        "type": "DIRECT",
        "subtype": "Join",
        "description": "industry name from wh_db.industry table",
        "masking": false
      }
    ]
  },
  "sprating": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END"
  },
  "islowgrade": {
    "inputs": [
      {
        "column": "cmp.SPrating",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END"
  },
  "ceo": {
    "input": "cmp.CEOname"
  },
  "addressline1": {
    "input": "cmp.AddrLine1"
  },
  "addressline2": {
    "input": "cmp.AddrLine2"
  },
  "postalcode": {
    "input": "cmp.PostalCode"
  },
  "city": {
    "input": "cmp.City"
  },
  "stateprov": {
    "input": "cmp.StateProvince"
  },
  "country": {
    "input": "cmp.Country"
  },
  "description": {
    "input": "cmp.Description"
  },
  "foundingdate": {
    "input": "cmp.FoundingDate"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
  },
  "batchid": {
    "input": "1"
  },
  "effectivedate": {
    "input": "cmp.recdate"
  },
  "enddate": {
    "inputs": [
      {
        "column": "cmp.recdate",
        "type": "DIRECT",
        "subtype": "Window",
        "description": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
        "masking": false
      },
      {
        "column": "cmp.cik",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "PARTITION BY cik",
        "masking": false
      }
    ],
    "transformation": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))"
  }
}
```
2025-04-11 17:46:49,598 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:52,873 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:52,873 - ERROR - Failed to decode JSON from response: ```json
{
  "customerid": {"input": "wh_db_stage.CustomerMgmt.customerid"},
  "taxid": {"input": "wh_db_stage.CustomerMgmt.taxid"},
  "status": {"input": "wh_db_stage.CustomerMgmt.status"},
  "lastname": {"input": "wh_db_stage.CustomerMgmt.lastname"},
  "firstname": {"input": "wh_db_stage.CustomerMgmt.firstname"},
  "middleinitial": {"input": "wh_db_stage.CustomerMgmt.middleinitial"},
  "gender": {"input": "wh_db_stage.CustomerMgmt.gender"},
  "tier": {"input": "wh_db_stage.CustomerMgmt.tier"},
  "dob": {"input": "wh_db_stage.CustomerMgmt.dob"},
  "addressline1": {"input": "wh_db_stage.CustomerMgmt.addressline1"},
  "addressline2": {"input": "wh_db_stage.CustomerMgmt.addressline2"},
  "postalcode": {"input": "wh_db_stage.CustomerMgmt.postalcode"},
  "city": {"input": "wh_db_stage.CustomerMgmt.city"},
  "stateprov": {"input": "wh_db_stage.CustomerMgmt.stateprov"},
  "country": {"input": "wh_db_stage.CustomerMgmt.country"},
  "phone1": {"input": "wh_db_stage.CustomerMgmt.phone1"},
  "phone2": {"input": "wh_db_stage.CustomerMgmt.phone2"},
  "phone3": {"input": "wh_db_stage.CustomerMgmt.phone3"},
  "email1": {"input": "wh_db_stage.CustomerMgmt.email1"},
  "email2": {"input": "wh_db_stage.CustomerMgmt.email2"},
  "lcl_tx_id": {"input": "wh_db_stage.CustomerMgmt.lcl_tx_id"},
  "nat_tx_id": {"input": "wh_db_stage.CustomerMgmt.nat_tx_id"},
  "batchid": {
    "inputs": [
      {
        "column": "wh_db_stage.CustomerMgmt.ActionType",
        "type": "INDIRECT",
        "subtype": "Filter",
        "description": "WHERE ActionType in ('NEW', 'INACT', 'UPDCUST')",
        "masking": false
      }
    ],
    "transformation": "1"
  },
  "update_ts": {
    "inputs": [
      {
        "column": "wh_db_stage.CustomerMgmt.ActionType",
        "type": "INDIRECT",
        "subtype": "Filter",
        "description": "WHERE ActionType in ('NEW', 'INACT', 'UPDCUST')",
        "masking": false
      }
    ],
    "input": "wh_db_stage.CustomerMgmt.update_ts"
  }
}
```
2025-04-11 17:46:57,882 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:46:58,660 - INFO - AFC remote call 1 is done.
2025-04-11 17:46:58,675 - ERROR - Failed to decode JSON from response: ```json
{
  "DimDate": {
    "input": "src/data/Batch1/Date.txt"
  }
}
```
2025-04-11 17:47:03,677 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:06,155 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:06,161 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_securityid": {
    "inputs": [
      {
        "column": "SEC_final.effectivedate",
        "type": "INDIRECT",
        "subtype": "Order",
        "description": "Used for row numbering",
        "masking": false
      }
    ],
    "transformation": "ROW_NUMBER() OVER ()"
  },
  "Symbol": {
    "input": "SEC_final.Symbol"
  },
  "issue": {
    "input": "SEC_final.issue"
  },
  "status": {
    "input": "SEC_final.status"
  },
  "Name": {
    "input": "SEC_final.Name"
  },
  "exchangeid": {
    "input": "SEC_final.exchangeid"
  },
  "sk_companyid": {
    "input": "SEC_final.sk_companyid"
  },
  "sharesoutstanding": {
    "input": "SEC_final.sharesoutstanding"
  },
  "firsttrade": {
    "input": "SEC_final.firsttrade"
  },
  "firsttradeonexchange": {
    "input": "SEC_final.firsttradeonexchange"
  },
  "Dividend": {
    "input": "SEC_final.Dividend"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "SEC_final.enddate",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "enddate = '9999-12-31'::DATE",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
  },
  "batchid": {
    "transformation": "1"
  },
  "effectivedate": {
    "input": "SEC_final.effectivedate"
  },
  "enddate": {
    "input": "SEC_final.enddate"
  }
}
```
2025-04-11 17:47:11,161 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:11,944 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:11,944 - ERROR - Failed to decode JSON from response: ```json
{
  "DimTime": {
    "inputs": [
      {
        "column": "src/data/Batch1\\Time.txt",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Data loaded from file",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:47:16,957 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:23,079 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:23,079 - ERROR - Failed to decode JSON from response: ```json
{
  "tradeid": {
    "input": "tradehistorical.tradeid"
  },
  "sk_brokerid": {
    "input": "wh_db.DimAccount.sk_brokerid"
  },
  "column2": {
    "inputs": [
      {
        "column": "tradehistorical.SK_CreateDateID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(trade.SK_CreateDateID, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.accountid",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.sk_brokerid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.sk_brokerid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(trade.SK_CreateDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
  },
  "column3": {
    "inputs": [
      {
        "column": "tradehistorical.SK_CreateTimeID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(trade.SK_CreateTimeID, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.accountid",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.sk_brokerid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.sk_brokerid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(trade.SK_CreateTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
  },
  "column4": {
    "inputs": [
      {
        "column": "tradehistorical.SK_CloseDateID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(trade.SK_CloseDateID, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.accountid",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.sk_brokerid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.sk_brokerid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(trade.SK_CloseDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
  },
  "column5": {
    "inputs": [
      {
        "column": "tradehistorical.SK_CloseTimeID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(trade.SK_CloseTimeID, '%Y%m%d')",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.accountid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.accountid",
        "masking": false
      },
      {
        "column": "wh_db.DimAccount.sk_brokerid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "da.sk_brokerid",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(trade.SK_CloseTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
  },
  "st_name": {
    "input": "tradehistorical.st_name"
  },
  "type": {
    "input": "tradehistorical.type"
  },
  "cashflag": {
    "input": "tradehistorical.cashflag"
  },
  "sk_securityid": {
    "input": "wh_db.DimSecurity.sk_securityid"
  },
  "sk_companyid": {
    "input": "wh_db.DimSecurity.sk_companyid"
  },
  "quantity": {
    "input": "tradehistorical.quantity"
  },
  "bidprice": {
    "input": "tradehistorical.bidprice"
  },
  "sk_customerid": {
    "input": "wh_db.DimAccount.sk_customerid"
  },
  "sk_accountid": {
    "input": "wh_db.DimAccount.sk_accountid"
  },
  "executedby": {
    "input": "tradehistorical.executedby"
  },
  "tradeprice": {
    "input": "tradehistorical.tradeprice"
  },
  "fee": {
    "input": "tradehistorical.fee"
  },
  "commission": {
    "input": "tradehistorical.commission"
  },
  "tax": {
    "input": "tradehistorical.tax"
  },
  "batchid": {
    "input": "1"
  }
}
```
2025-04-11 17:47:28,086 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:30,670 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:30,670 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_customerid": {
    "inputs": [
      {
        "column": "wh_db.DimAccount.sk_customerid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy",
        "masking": false
      }
    ]
  },
  "sk_accountid": {
    "inputs": [
      {
        "column": "wh_db.DimAccount.sk_accountid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy",
        "masking": false
      }
    ]
  },
  "sk_dateid": {
    "inputs": [
      {
        "column": "historical.datevalue",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "datevalue used in STRFTIME",
        "masking": false
      }
    ],
    "transformation": "CAST(STRFTIME(datevalue, '%Y%m%d') AS BIGINT)"
  },
  "cash": {
    "inputs": [
      {
        "column": "historical.account_daily_total",
        "type": "DIRECT",
        "subtype": "Aggregation",
        "description": "account_daily_total used in SUM OVER",
        "masking": false
      },
      {
        "column": "historical.accountid",
        "type": "INDIRECT",
        "subtype": "GroupBy",
        "description": "accountid used in PARTITION BY",
        "masking": false
      },
      {
        "column": "historical.datevalue",
        "type": "INDIRECT",
        "subtype": "Order",
        "description": "datevalue used in ORDER BY",
        "masking": false
      }
    ],
    "transformation": "SUM(account_daily_total) OVER (PARTITION BY c.accountid ORDER BY datevalue)"
  },
  "batchid": {
    "inputs": [
      {
        "column": "historical.batchid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:47:35,686 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:37,132 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:37,132 - ERROR - Failed to decode JSON from response: ```json
{
  "tradeid": {
    "input": "h.hh_h_t_id"
  },
  "currenttradeid": {
    "input": "h.hh_t_id"
  },
  "sk_customerid": {
    "input": "dt.sk_customerid"
  },
  "sk_accountid": {
    "input": "dt.sk_accountid"
  },
  "sk_securityid": {
    "input": "dt.sk_securityid"
  },
  "sk_companyid": {
    "input": "dt.sk_companyid"
  },
  "sk_dateid": {
    "input": "dt.sk_closedateid"
  },
  "sk_timeid": {
    "input": "dt.sk_closetimeid"
  },
  "currentprice": {
    "input": "dt.tradeprice"
  },
  "currentholding": {
    "input": "h.hh_after_qty"
  },
  "batchid": {
    "input": "h.batchid"
  }
}
```
2025-04-11 17:47:42,142 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:44,247 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:44,262 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_customerid": {
    "inputs": [
      {
        "column": "c.sk_customerid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy from c.sk_customerid",
        "masking": false
      }
    ]
  },
  "sk_securityid": {
    "inputs": [
      {
        "column": "s.sk_securityid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy from s.sk_securityid",
        "masking": false
      }
    ]
  },
  "sk_dateid_dateplaced": {
    "inputs": [
      {
        "column": "wh.dateplaced",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(dateplaced, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(dateplaced, '%Y%m%d') AS BIGINT)"
  },
  "sk_dateid_dateremoved": {
    "inputs": [
      {
        "column": "wh.dateremoved",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strftime(dateremoved, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(strftime(dateremoved, '%Y%m%d') AS BIGINT)"
  },
  "batchid": {
    "inputs": [
      {
        "column": "wh.batchid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Direct copy from wh.batchid",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:47:49,267 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:47:56,088 - INFO - AFC remote call 1 is done.
2025-04-11 17:47:56,088 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_companyid": {
    "inputs": [
      {
        "column": "wh_db.DimCompany.sk_companyid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "sk_companyid from DimCompany",
        "masking": false
      }
    ]
  },
  "fi_year": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 1 FOR 4) AS INTEGER)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 1 FOR 4) AS INTEGER)"
  },
  "fi_qtr": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 5 FOR 1) AS INTEGER)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 5 FOR 1) AS INTEGER)"
  },
  "fi_qtr_start_date": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "strptime(SUBSTRING(value FROM 6 FOR 8), '%Y%m%d')::DATE",
        "masking": false
      }
    ],
    "transformation": "strptime(SUBSTRING(value FROM 6 FOR 8), '%Y%m%d')::DATE"
  },
  "fi_revenue": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 22 FOR 17) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 22 FOR 17) AS DOUBLE)"
  },
  "fi_net_earn": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 39 FOR 17) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 39 FOR 17) AS DOUBLE)"
  },
  "fi_basic_eps": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 56 FOR 12) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 56 FOR 12) AS DOUBLE)"
  },
  "fi_dilut_eps": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 68 FOR 12) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 68 FOR 12) AS DOUBLE)"
  },
  "fi_margin": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 80 FOR 12) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 80 FOR 12) AS DOUBLE)"
  },
  "fi_inventory": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 92 FOR 17) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 92 FOR 17) AS DOUBLE)"
  },
  "fi_assets": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 109 FOR 17) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 109 FOR 17) AS DOUBLE)"
  },
  "fi_liability": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 126 FOR 17) AS DOUBLE)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 126 FOR 17) AS DOUBLE)"
  },
  "fi_out_basic": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 143 FOR 13) AS BIGINT)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 143 FOR 13) AS BIGINT)"
  },
  "fi_out_dilut": {
    "inputs": [
      {
        "column": "wh_db_stage.FinWire.value",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "CAST(SUBSTRING(value FROM 156 FOR 13) AS BIGINT)",
        "masking": false
      }
    ],
    "transformation": "CAST(SUBSTRING(value FROM 156 FOR 13) AS BIGINT)"
  }
}
```
2025-04-11 17:48:01,097 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:05,578 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:05,578 - ERROR - Failed to decode JSON from response: ```json
{
  "agencyid": {
    "input": "wh_db_stage.ProspectIncremental.agencyid"
  },
  "sk_recorddateid": {
    "inputs": [
      {
        "column": "wh_db.BatchDate.batchdate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "STRFTIME(recdate.batchdate, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(STRFTIME(recdate.batchdate, '%Y%m%d') AS BIGINT)"
  },
  "sk_updatedateid": {
    "inputs": [
      {
        "column": "wh_db.BatchDate.batchdate",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "STRFTIME(origdate.batchdate, '%Y%m%d')",
        "masking": false
      }
    ],
    "transformation": "CAST(STRFTIME(origdate.batchdate, '%Y%m%d') AS BIGINT)"
  },
  "batchid": {
    "input": "wh_db_stage.ProspectIncremental.batchid"
  },
  "iscustomer": {
    "inputs": [
      {
        "column": "wh_db.DimCustomer.LastName",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "CASE WHEN c.LastName IS NOT NULL THEN TRUE ELSE FALSE END",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN c.LastName IS NOT NULL THEN TRUE ELSE FALSE END"
  },
  "lastname": {
    "input": "wh_db_stage.ProspectIncremental.lastname"
  },
  "firstname": {
    "input": "wh_db_stage.ProspectIncremental.firstname"
  },
  "middleinitial": {
    "input": "wh_db_stage.ProspectIncremental.middleinitial"
  },
  "gender": {
    "input": "wh_db_stage.ProspectIncremental.gender"
  },
  "addressline1": {
    "input": "wh_db_stage.ProspectIncremental.addressline1"
  },
  "addressline2": {
    "input": "wh_db_stage.ProspectIncremental.addressline2"
  },
  "postalcode": {
    "input": "wh_db_stage.ProspectIncremental.postalcode"
  },
  "city": {
    "input": "wh_db_stage.ProspectIncremental.city"
  },
  "state": {
    "input": "wh_db_stage.ProspectIncremental.state"
  },
  "country": {
    "input": "wh_db_stage.ProspectIncremental.country"
  },
  "phone": {
    "input": "wh_db_stage.ProspectIncremental.phone"
  },
  "income": {
    "input": "wh_db_stage.ProspectIncremental.income"
  },
  "numbercars": {
    "input": "wh_db_stage.ProspectIncremental.numbercars"
  },
  "numberchildren": {
    "input": "wh_db_stage.ProspectIncremental.numberchildren"
  },
  "maritalstatus": {
    "input": "wh_db_stage.ProspectIncremental.maritalstatus"
  },
  "age": {
    "input": "wh_db_stage.ProspectIncremental.age"
  },
  "creditrating": {
    "input": "wh_db_stage.ProspectIncremental.creditrating"
  },
  "ownorrentflag": {
    "input": "wh_db_stage.ProspectIncremental.ownorrentflag"
  },
  "employer": {
    "input": "wh_db_stage.ProspectIncremental.employer"
  },
  "numbercreditcards": {
    "input": "wh_db_stage.ProspectIncremental.numbercreditcards"
  },
  "networth": {
    "input": "wh_db_stage.ProspectIncremental.networth"
  },
  "marketingnameplate": {
    "input": "wh_db_stage.ProspectIncremental.marketingnameplate"
  }
}
```
2025-04-11 17:48:10,593 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:11,302 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:11,302 - ERROR - Failed to decode JSON from response: ```json
{
  "StatusType": {
    "inputs": [
      {
        "column": "src/data/Batch1\\StatusType.txt.StatusType",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Data loaded from file",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:48:16,312 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:18,642 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:18,642 - ERROR - Failed to decode JSON from response: ```json
{
  "TaxRate": {
    "inputs": [
      {
        "column": "src/data/Batch1\\TaxRate.txt.TaxRate",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Copied from file",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:48:23,658 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:24,486 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:24,502 - ERROR - Failed to decode JSON from response: ```json
{
  "TradeType": {
    "inputs": [
      {
        "column": "src/data/Batch1\\TradeType.txt.TradeType",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "Copied from file",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:48:29,507 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:32,321 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:32,336 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_brokerid": {
    "input": "temp_broker.employeeid"
  },
  "brokerid": {
    "input": "temp_broker.employeeid"
  },
  "managerid": {
    "input": "temp_broker.managerid"
  },
  "firstname": {
    "input": "temp_broker.employeefirstname"
  },
  "lastname": {
    "input": "temp_broker.employeelastname"
  },
  "middleinitial": {
    "input": "temp_broker.employeemi"
  },
  "branch": {
    "input": "temp_broker.employeebranch"
  },
  "office": {
    "input": "temp_broker.employeeoffice"
  },
  "phone": {
    "input": "temp_broker.employeephone"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value: true",
        "masking": false
      }
    ],
    "transformation": "true"
  },
  "batchid": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value: 1",
        "masking": false
      }
    ],
    "transformation": "1"
  },
  "effectivedate": {
    "inputs": [
      {
        "column": "wh_db.DimDate.datevalue",
        "type": "DIRECT",
        "subtype": "Aggregation",
        "description": "MIN(datevalue::DATE)",
        "masking": false
      }
    ],
    "transformation": "(SELECT min(datevalue::DATE) as effectivedate FROM wh_db.DimDate)"
  },
  "enddate": {
    "inputs": [
      {
        "column": "temp_broker.employeeid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Hardcoded value: '9999-12-31'::DATE",
        "masking": false
      }
    ],
    "transformation": "'9999-12-31'::DATE"
  }
}
```
2025-04-11 17:48:37,340 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:39,850 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:39,850 - ERROR - Failed to decode JSON from response: ```json
{
  "rectype": {
    "inputs": [
      {
        "column": "read_csv_auto.column0",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "SUBSTR(column0, 16, 3) used in CASE WHEN",
        "masking": false
      },
      {
        "column": "read_csv_auto.column0",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "SUBSTR(column0, 187, 60) used in TRY_CAST",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN SUBSTR(column0, 16, 3) = 'FIN' THEN CASE WHEN TRY_CAST(TRIM(SUBSTR(column0, 187, 60)) AS BIGINT) IS NOT NULL THEN 'FIN_COMPANYID' ELSE 'FIN_NAME' END ELSE SUBSTR(column0, 16, 3) END"
  },
  "recdate": {
    "inputs": [
      {
        "column": "read_csv_auto.column0",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "SUBSTR(column0, 1, 8) used in STRPTIME",
        "masking": false
      }
    ],
    "transformation": "STRPTIME(SUBSTR(column0, 1, 8), '%Y%m%d')"
  },
  "value": {
    "inputs": [
      {
        "column": "read_csv_auto.column0",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "SUBSTR(column0, 19)",
        "masking": false
      }
    ],
    "transformation": "SUBSTR(column0, 19)"
  }
}
```
2025-04-11 17:48:44,864 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:51,208 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:51,208 - ERROR - Failed to decode JSON from response: ```json
{
  "agencyid": {
    "input": "read_csv_auto.agencyid"
  },
  "lastname": {
    "input": "read_csv_auto.lastname"
  },
  "firstname": {
    "input": "read_csv_auto.firstname"
  },
  "middleinitial": {
    "input": "read_csv_auto.middleinitial"
  },
  "gender": {
    "input": "read_csv_auto.gender"
  },
  "addressline1": {
    "input": "read_csv_auto.addressline1"
  },
  "addressline2": {
    "input": "read_csv_auto.addressline2"
  },
  "postalcode": {
    "input": "read_csv_auto.postalcode"
  },
  "city": {
    "input": "read_csv_auto.city"
  },
  "state": {
    "input": "read_csv_auto.state"
  },
  "country": {
    "input": "read_csv_auto.country"
  },
  "phone": {
    "input": "read_csv_auto.phone"
  },
  "income": {
    "input": "read_csv_auto.income"
  },
  "numbercars": {
    "input": "read_csv_auto.numbercars"
  },
  "numberchildren": {
    "input": "read_csv_auto.numberchildren"
  },
  "maritalstatus": {
    "input": "read_csv_auto.maritalstatus"
  },
  "age": {
    "input": "read_csv_auto.age"
  },
  "creditrating": {
    "input": "read_csv_auto.creditrating"
  },
  "ownorrentflag": {
    "input": "read_csv_auto.ownorrentflag"
  },
  "employer": {
    "input": "read_csv_auto.employer"
  },
  "numbercreditcards": {
    "input": "read_csv_auto.numbercreditcards"
  },
  "networth": {
    "input": "read_csv_auto.networth"
  },
  "batchid": {
    "inputs": [
      {
        "column": "read_csv_auto.*",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "Constant value assignment",
        "masking": false
      }
    ],
    "transformation": "1"
  }
}
```
2025-04-11 17:48:56,223 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:48:58,109 - INFO - AFC remote call 1 is done.
2025-04-11 17:48:58,109 - ERROR - Failed to decode JSON from response: ```json
{
  "tradeid": {
    "input": "read_csv.tradeid"
  },
  "t_dts": {
    "input": "read_csv.t_dts"
  },
  "status": {
    "input": "read_csv.status"
  },
  "t_tt_id": {
    "input": "read_csv.t_tt_id"
  },
  "cashflag": {
    "input": "read_csv.cashflag"
  },
  "t_s_symb": {
    "input": "read_csv.t_s_symb"
  },
  "quantity": {
    "input": "read_csv.quantity"
  },
  "bidprice": {
    "input": "read_csv.bidprice"
  },
  "t_ca_id": {
    "input": "read_csv.t_ca_id"
  },
  "executedby": {
    "input": "read_csv.executedby"
  },
  "tradeprice": {
    "input": "read_csv.tradeprice"
  },
  "fee": {
    "input": "read_csv.fee"
  },
  "commission": {
    "input": "read_csv.commission"
  },
  "tax": {
    "input": "read_csv.tax"
  }
}
```
2025-04-11 17:49:03,118 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:49:19,884 - INFO - AFC remote call 1 is done.
2025-04-11 17:49:19,900 - ERROR - Failed to decode JSON from response: ```json
{
  "customerid": {
    "input": "customers.customerid"
  },
  "taxid": {
    "inputs": [
      {
        "column": "customers.taxid",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(taxid ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)"
  },
  "status": {
    "input": "customers.status"
  },
  "lastname": {
    "inputs": [
      {
        "column": "customers.lastname",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(lastname ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)"
  },
  "firstname": {
    "inputs": [
      {
        "column": "customers.firstname",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(firstname ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)"
  },
  "middleinitial": {
    "inputs": [
      {
        "column": "customers.middleinitial",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(middleinitial ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)"
  },
  "gender": {
    "inputs": [
      {
        "column": "customers.gender",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(gender ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)"
  },
  "tier": {
    "inputs": [
      {
        "column": "customers.tier",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(tier ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)"
  },
  "dob": {
    "inputs": [
      {
        "column": "customers.dob",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(dob ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)"
  },
  "addressline1": {
    "inputs": [
      {
        "column": "customers.addressline1",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(addressline1 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)"
  },
  "addressline2": {
    "inputs": [
      {
        "column": "customers.addressline2",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(addressline2 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)"
  },
  "postalcode": {
    "inputs": [
      {
        "column": "customers.postalcode",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(postalcode ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)"
  },
  "CITY": {
    "inputs": [
      {
        "column": "customers.CITY",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(CITY ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)"
  },
  "stateprov": {
    "inputs": [
      {
        "column": "customers.stateprov",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(stateprov ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)"
  },
  "country": {
    "inputs": [
      {
        "column": "customers.country",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(country ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)"
  },
  "phone1": {
    "inputs": [
      {
        "column": "customers.phone1",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(phone1 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)"
  },
  "phone2": {
    "inputs": [
      {
        "column": "customers.phone2",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(phone2 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)"
  },
  "phone3": {
    "inputs": [
      {
        "column": "customers.phone3",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(phone3 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)"
  },
  "email1": {
    "inputs": [
      {
        "column": "customers.email1",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(email1 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)"
  },
  "email2": {
    "inputs": [
      {
        "column": "customers.email2",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(email2 ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)"
  },
  "LCL_TX_ID": {
    "inputs": [
      {
        "column": "customers.LCL_TX_ID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)"
  },
  "NAT_TX_ID": {
    "inputs": [
      {
        "column": "customers.NAT_TX_ID",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)",
        "masking": false
      },
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)"
  },
  "batchid": {
    "input": "customers.batchid"
  },
  "iscurrent": {
    "inputs": [
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "lead(update_ts) OVER w",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN NULLIF(lead(update_ts) OVER w, NULL) IS NULL THEN 'Y' ELSE 'N' END"
  },
  "effectivedate": {
    "inputs": [
      {
        "column": "customers.update_ts",
        "type": "DIRECT",
        "subtype": "Transformation",
        "description": "update_ts::DATE",
        "masking": false
      }
    ],
    "transformation": "update_ts::DATE"
  },
  "enddate": {
    "inputs": [
      {
        "column": "customers.update_ts",
        "type": "INDIRECT",
        "subtype": "Window",
        "description": "lead(update_ts::DATE) OVER w",
        "masking": false
      }
    ],
    "transformation": "COALESCE(lead(update_ts::DATE) OVER w, '9999-12-31'::DATE)"
  }
}
```
2025-04-11 17:49:24,907 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:49:27,265 - INFO - AFC remote call 1 is done.
2025-04-11 17:49:27,265 - ERROR - Failed to decode JSON from response: ```json
{
  "*": {
    "input": "temp_propect.*"
  },
  "marketingnameplate": {
    "inputs": [
      {
        "column": "temp_propect.networth",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "networth used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.income",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "income used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.numberchildren",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "numberchildren used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.numbercreditcards",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "numbercreditcards used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.age",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "age used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.creditrating",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "creditrating used in CASE WHEN logic",
        "masking": false
      },
      {
        "column": "temp_propect.numbercars",
        "type": "INDIRECT",
        "subtype": "Conditional",
        "description": "numbercars used in CASE WHEN logic",
        "masking": false
      }
    ],
    "transformation": "CASE WHEN ... THEN ... ELSE ... END"
  }
}
```
2025-04-11 17:49:32,280 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:49:33,544 - INFO - AFC remote call 1 is done.
2025-04-11 17:49:33,560 - ERROR - Failed to decode JSON from response: ```json
{
  "tradeid": {
    "inputs": [
      {
        "column": "read_csv_auto.tradeid",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "tradeid",
        "masking": false
      }
    ]
  },
  "th_dts": {
    "inputs": [
      {
        "column": "read_csv_auto.th_dts",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "th_dts",
        "masking": false
      }
    ]
  },
  "status": {
    "inputs": [
      {
        "column": "read_csv_auto.status",
        "type": "DIRECT",
        "subtype": "Identity",
        "description": "status",
        "masking": false
      }
    ]
  }
}
```
2025-04-11 17:49:38,562 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:49:42,560 - INFO - AFC remote call 1 is done.
2025-04-11 17:49:42,560 - ERROR - Failed to decode JSON from response: ```json
{
  "sk_customerid": {
    "inputs": [
      {
        "column": "wh_db.DimCustomer.sk_customerid",
        "type": "DIRECT",
        "subtype": "Aggregation",
        "description": "MAX(sk_customerid) from wh_db.DimCustomer",
        "masking": false
      }
    ],
    "transformation": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1"
  },
  "customerid": {
    "input": "CustomerData.customerid"
  },
  "taxid": {
    "input": "CustomerData.taxid"
  },
  "status": {
    "input": "CustomerData.status"
  },
  "lastname": {
    "input": "CustomerData.lastname"
  },
  "firstname": {
    "input": "CustomerData.firstname"
  },
  "middleinitial": {
    "input": "CustomerData.middleinitial"
  },
  "gender": {
    "inputs": [
      {
        "column": "CustomerData.gender",
        "type": "DIRECT",
        "subtype": "Conditional",
        "description": "IF(c.gender IN ('M', 'F'), c.gender, 'U')",
        "masking": false
      }
    ],
    "transformation": "IF(c.gender IN ('M', 'F'), c.gender, 'U')"
  },
  "tier": {
    "input": "CustomerData.tier"
  },
  "dob": {
    "input": "CustomerData.dob"
  },
  "addressline1": {
    "input": "CustomerData.addressline1"
  },
  "addressline2": {
    "input": "CustomerData.addressline2"
  },
  "postalcode": {
    "input": "CustomerData.postalcode"
  },
  "city": {
    "input": "CustomerData.city"
  },
  "stateprov": {
    "input": "CustomerData.stateprov"
  },
  "country": {
    "input": "CustomerData.country"
  },
  "phone1": {
    "input": "CustomerData.phone1"
  },
  "phone2": {
    "input": "CustomerData.phone2"
  },
  "phone3": {
    "input": "CustomerData.phone3"
  },
  "email1": {
    "input": "CustomerData.email1"
  },
  "email2": {
    "input": "CustomerData.email2"
  },
  "nationaltaxratedesc": {
    "input": "CustomerData.nationaltaxratedesc"
  },
  "nationaltaxrate": {
    "input": "CustomerData.nationaltaxrate"
  },
  "localtaxratedesc": {
    "input": "CustomerData.localtaxratedesc"
  },
  "localtaxrate": {
    "input": "CustomerData.localtaxrate"
  },
  "agencyid": {
    "input": "CustomerData.agencyid"
  },
  "creditrating": {
    "input": "CustomerData.creditrating"
  },
  "networth": {
    "input": "CustomerData.networth"
  },
  "marketingnameplate": {
    "input": "CustomerData.marketingnameplate"
  },
  "iscurrent": {
    "input": "CustomerData.iscurrent"
  },
  "batchid": {
    "input": "CustomerData.batchid"
  },
  "effectivedate": {
    "input": "CustomerData.effectivedate"
  },
  "enddate": {
    "input": "CustomerData.enddate"
  }
}
```
2025-04-11 17:49:47,573 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:49:50,661 - INFO - AFC remote call 1 is done.
2025-04-11 17:49:50,661 - ERROR - Failed to decode JSON from response: ```json
{
  "agencyid": {
    "input": "temp_propect_marketingnameplate.agencyid"
  },
  "lastname": {
    "input": "temp_propect_marketingnameplate.lastname"
  },
  "firstname": {
    "input": "temp_propect_marketingnameplate.firstname"
  },
  "middleinitial": {
    "input": "temp_propect_marketingnameplate.middleinitial"
  },
  "gender": {
    "input": "temp_propect_marketingnameplate.gender"
  },
  "addressline1": {
    "input": "temp_propect_marketingnameplate.addressline1"
  },
  "addressline2": {
    "input": "temp_propect_marketingnameplate.addressline2"
  },
  "postalcode": {
    "input": "temp_propect_marketingnameplate.postalcode"
  },
  "city": {
    "input": "temp_propect_marketingnameplate.city"
  },
  "state": {
    "input": "temp_propect_marketingnameplate.state"
  },
  "country": {
    "input": "temp_propect_marketingnameplate.country"
  },
  "phone": {
    "input": "temp_propect_marketingnameplate.phone"
  },
  "income": {
    "input": "temp_propect_marketingnameplate.income"
  },
  "numbercars": {
    "input": "temp_propect_marketingnameplate.numbercars"
  },
  "numberchildren": {
    "input": "temp_propect_marketingnameplate.numberchildren"
  },
  "maritalstatus": {
    "input": "temp_propect_marketingnameplate.maritalstatus"
  },
  "age": {
    "input": "temp_propect_marketingnameplate.age"
  },
  "creditrating": {
    "input": "temp_propect_marketingnameplate.creditrating"
  },
  "ownorrentflag": {
    "input": "temp_propect_marketingnameplate.ownorrentflag"
  },
  "employer": {
    "input": "temp_propect_marketingnameplate.employer"
  },
  "numbercreditcards": {
    "input": "temp_propect_marketingnameplate.numbercreditcards"
  },
  "networth": {
    "input": "temp_propect_marketingnameplate.networth"
  },
  "marketingnameplate": {
    "input": "temp_propect_marketingnameplate.marketingnameplate"
  },
  "recordbatchid": {
    "input": "temp_propect_marketingnameplate.batchid"
  },
  "batchid": {
    "input": "temp_propect_marketingnameplate.batchid"
  }
}
```
2025-04-11 17:49:55,676 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:50:00,724 - INFO - AFC remote call 1 is done.
2025-04-11 17:50:00,740 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimProduct",
  "sources_summary": {
    "tables": [
      "wh_db_stage.FinWire"
    ],
    "ctes": [
      "cmp",
      "cmp2",
      "cmp3"
    ]
  },
  "lineage": {
    "ProductKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "id",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "CAST(cmp.id AS INTEGER)",
        "transformation_type": "CAST"
      }
    ],
    "ProductAltKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "id",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "cmp.id",
        "transformation_type": "RENAME"
      }
    ],
    "ProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductCategoryName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "CASE WHEN cmp.value = 'abc' THEN 'Category A' ELSE 'Category B' END",
        "transformation_type": "CASE_MAPPING"
      }
    ],
    "ProductStartDate": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "CAST(strftime('%Y-%m-%d %H:%M:%S', cmp.ts) AS DATETIME)",
        "transformation_type": "CAST"
      }
    ],
    "ProductEndDate": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "LEAD(CAST(strftime('%Y-%m-%d %H:%M:%S', cmp.ts) AS DATETIME), 1, '9999-12-31') OVER (PARTITION BY cmp.id ORDER BY cmp.ts)",
        "transformation_type": "WINDOW_FUNCTION"
      }
    ],
    "ProductCurrentFlag": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "CASE WHEN cmp3.next_ts IS NULL THEN 1 ELSE 0 END",
        "transformation_type": "SCD2_LOGIC"
      }
    ],
    "ProductPrice": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "TRY_CAST(SUBSTR(cmp.value, 1, 5) AS DECIMAL(10,2))",
        "transformation_type": "CAST"
      }
    ],
    "ProductDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2",
          "cmp3"
        ],
        "transformation_logic": "TRIM(cmp.value) || ' - ' || CAST(cmp.id AS VARCHAR)",
        "transformation_type": "EXPRESSION_CONCAT"
      }
    ]
  }
}
```
2025-04-11 17:50:05,740 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:50:09,670 - INFO - AFC remote call 1 is done.
2025-04-11 17:50:09,670 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimProduct",
  "sources_summary": {
    "tables": [
      "wh_db_stage.FinWire"
    ],
    "ctes": [
      "cmp",
      "cmp2"
    ]
  },
  "lineage": {
    "ProductKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "CAST(cmp.value AS INTEGER)",
        "transformation_type": "CAST"
      }
    ],
    "ProductAlternateKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductStyle": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductColor": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductSize": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductLine": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductClass": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ],
    "ProductSubClass": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp",
          "cmp2"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME"
      }
    ]
  }
}
```
2025-04-11 17:50:14,681 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:50:27,823 - INFO - AFC remote call 1 is done.
2025-04-11 17:50:27,832 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimProduct",
  "sources_summary": {
    "wh_db_stage.FinWire": [
      "value",
      "ts"
    ],
    "wh_db.DimProduct": [
      "ProductID",
      "ProductName",
      "ProductAlternateKey",
      "ProductSubcategoryKey",
      "WeightUnitMeasureCode",
      "SizeUnitMeasureCode",
      "EnglishProductName",
      "SpanishProductName",
      "FrenchProductName",
      "StandardCost",
      "ListPrice",
      "FinishedGoodsFlag",
      "Color",
      "SafetyStockLevel",
      "ReorderPoint",
      "ListPrice",
      "DaysToManufacture",
      "ProductLine",
      "Class",
      "Style",
      "ModelName",
      "LargePhoto",
      "EnglishDescription",
      "FrenchDescription",
      "ChineseDescription",
      "ArabicDescription",
      "HebrewDescription",
      "ThaiDescription",
      "GermanDescription",
      "JapaneseDescription",
      "TurkishDescription",
      "StartDate",
      "EndDate",
      "Status",
      "CurrentFlag",
      "ETL_InsertTime",
      "ETL_UpdateTime"
    ]
  },
  "lineage": {
    "ProductID": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductID",
        "path": [],
        "transformation_logic": "d.ProductID",
        "transformation_type": "RENAME"
      }
    ],
    "ProductKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CAST(cmp.value AS INTEGER)",
        "transformation_type": "CAST"
      }
    ],
    "ProductName": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductName",
        "path": [],
        "transformation_logic": "d.ProductName",
        "transformation_type": "RENAME"
      }
    ],
    "ProductAlternateKey": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductAlternateKey",
        "path": [],
        "transformation_logic": "d.ProductAlternateKey",
        "transformation_type": "RENAME"
      }
    ],
    "ProductSubcategoryKey": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductSubcategoryKey",
        "path": [],
        "transformation_logic": "d.ProductSubcategoryKey",
        "transformation_type": "RENAME"
      }
    ],
    "WeightUnitMeasureCode": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "WeightUnitMeasureCode",
        "path": [],
        "transformation_logic": "d.WeightUnitMeasureCode",
        "transformation_type": "RENAME"
      }
    ],
    "SizeUnitMeasureCode": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "SizeUnitMeasureCode",
        "path": [],
        "transformation_logic": "d.SizeUnitMeasureCode",
        "transformation_type": "RENAME"
      }
    ],
    "EnglishProductName": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "EnglishProductName",
        "path": [],
        "transformation_logic": "d.EnglishProductName",
        "transformation_type": "RENAME"
      }
    ],
    "SpanishProductName": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "SpanishProductName",
        "path": [],
        "transformation_logic": "d.SpanishProductName",
        "transformation_type": "RENAME"
      }
    ],
    "FrenchProductName": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "FrenchProductName",
        "path": [],
        "transformation_logic": "d.FrenchProductName",
        "transformation_type": "RENAME"
      }
    ],
    "StandardCost": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "StandardCost",
        "path": [],
        "transformation_logic": "d.StandardCost",
        "transformation_type": "RENAME"
      }
    ],
    "ListPrice": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ListPrice",
        "path": [],
        "transformation_logic": "d.ListPrice",
        "transformation_type": "RENAME"
      }
    ],
    "FinishedGoodsFlag": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "FinishedGoodsFlag",
        "path": [],
        "transformation_logic": "d.FinishedGoodsFlag",
        "transformation_type": "RENAME"
      }
    ],
    "Color": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "Color",
        "path": [],
        "transformation_logic": "d.Color",
        "transformation_type": "RENAME"
      }
    ],
    "SafetyStockLevel": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "SafetyStockLevel",
        "path": [],
        "transformation_logic": "d.SafetyStockLevel",
        "transformation_type": "RENAME"
      }
    ],
    "ReorderPoint": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ReorderPoint",
        "path": [],
        "transformation_logic": "d.ReorderPoint",
        "transformation_type": "RENAME"
      }
    ],
    "DaysToManufacture": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "DaysToManufacture",
        "path": [],
        "transformation_logic": "d.DaysToManufacture",
        "transformation_type": "RENAME"
      }
    ],
    "ProductLine": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductLine",
        "path": [],
        "transformation_logic": "d.ProductLine",
        "transformation_type": "RENAME"
      }
    ],
    "Class": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "Class",
        "path": [],
        "transformation_logic": "d.Class",
        "transformation_type": "RENAME"
      }
    ],
    "Style": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "Style",
        "path": [],
        "transformation_logic": "d.Style",
        "transformation_type": "RENAME"
      }
    ],
    "ModelName": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ModelName",
        "path": [],
        "transformation_logic": "d.ModelName",
        "transformation_type": "RENAME"
      }
    ],
    "LargePhoto": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "LargePhoto",
        "path": [],
        "transformation_logic": "d.LargePhoto",
        "transformation_type": "RENAME"
      }
    ],
    "EnglishDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "EnglishDescription",
        "path": [],
        "transformation_logic": "d.EnglishDescription",
        "transformation_type": "RENAME"
      }
    ],
    "FrenchDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "FrenchDescription",
        "path": [],
        "transformation_logic": "d.FrenchDescription",
        "transformation_type": "RENAME"
      }
    ],
    "ChineseDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ChineseDescription",
        "path": [],
        "transformation_logic": "d.ChineseDescription",
        "transformation_type": "RENAME"
      }
    ],
    "ArabicDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ArabicDescription",
        "path": [],
        "transformation_logic": "d.ArabicDescription",
        "transformation_type": "RENAME"
      }
    ],
    "HebrewDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "HebrewDescription",
        "path": [],
        "transformation_logic": "d.HebrewDescription",
        "transformation_type": "RENAME"
      }
    ],
    "ThaiDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ThaiDescription",
        "path": [],
        "transformation_logic": "d.ThaiDescription",
        "transformation_type": "RENAME"
      }
    ],
    "GermanDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "GermanDescription",
        "path": [],
        "transformation_logic": "d.GermanDescription",
        "transformation_type": "RENAME"
      }
    ],
    "JapaneseDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "JapaneseDescription",
        "path": [],
        "transformation_logic": "d.JapaneseDescription",
        "transformation_type": "RENAME"
      }
    ],
    "TurkishDescription": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "TurkishDescription",
        "path": [],
        "transformation_logic": "d.TurkishDescription",
        "transformation_type": "RENAME"
      }
    ],
    "StartDate": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "StartDate",
        "path": [],
        "transformation_logic": "d.StartDate",
        "transformation_type": "RENAME"
      }
    ],
    "EndDate": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "EndDate",
        "path": [],
        "transformation_logic": "d.EndDate",
        "transformation_type": "RENAME"
      }
    ],
    "Status": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "Status",
        "path": [],
        "transformation_logic": "d.Status",
        "transformation_type": "RENAME"
      }
    ],
    "CurrentFlag": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "CurrentFlag",
        "path": [],
        "transformation_logic": "d.CurrentFlag",
        "transformation_type": "RENAME"
      }
    ],
    "ETL_InsertTime": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [],
        "transformation_logic": "CURRENT_TIMESTAMP",
        "transformation_type": "CONSTANT"
      }
    ],
    "ETL_UpdateTime": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [],
        "transformation_logic": "CURRENT_TIMESTAMP",
        "transformation_type": "CONSTANT"
      }
    ]
  }
}
```
2025-04-11 17:50:32,840 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:50:38,657 - INFO - AFC remote call 1 is done.
2025-04-11 17:50:38,657 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimProduct",
  "sources_summary": {
    "wh_db_stage.FinWire": "Used as the primary source for product information.",
    "wh_db.DimProduct": "Used to determine the maximum ProductKey for SCD2 implementation."
  },
  "lineage": {
    "ProductKey": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductKey",
        "path": [],
        "transformation_logic": "MAX(ProductKey) + 1",
        "transformation_type": "SCD2_LOGIC",
        "role": "MAX_VALUE"
      }
    ],
    "ProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.value",
        "transformation_type": "RENAME",
        "role": "SOURCE"
      }
    ],
    "ProductAlternateKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "id",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.id",
        "transformation_type": "RENAME",
        "role": "SOURCE"
      }
    ],
    "ProductSubcategoryKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "type",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CASE WHEN cmp.type = 'Electronics' THEN 1 WHEN cmp.type = 'Clothing' THEN 2 ELSE -1 END",
        "transformation_type": "CASE_MAPPING",
        "role": "CONDITION_INPUT"
      }
    ],
    "ProductModelName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "SUBSTR(cmp.value, 1, 20)",
        "transformation_type": "SUBSTRING",
        "role": "SOURCE"
      }
    ],
    "ProductDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.value || ' - Description'",
        "transformation_type": "EXPRESSION_CONCAT",
        "role": "SOURCE"
      }
    ],
    "ProductColor": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CASE WHEN cmp.value LIKE '%Red%' THEN 'Red' WHEN cmp.value LIKE '%Blue%' THEN 'Blue' ELSE 'Unknown' END",
        "transformation_type": "CASE_MAPPING",
        "role": "CONDITION_INPUT"
      }
    ],
    "ListPrice": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "price",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CAST(cmp.price AS DECIMAL(10,2))",
        "transformation_type": "CAST",
        "role": "SOURCE"
      }
    ],
    "Size": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "size",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.size",
        "transformation_type": "RENAME",
        "role": "SOURCE"
      }
    ],
    "Weight": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "weight",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.weight",
        "transformation_type": "RENAME",
        "role": "SOURCE"
      }
    ],
    "ValidFrom": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "created_at",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.created_at",
        "transformation_type": "RENAME",
        "role": "SOURCE"
      }
    ],
    "ValidTo": [
      {
        "source_table": null,
        "source_column": null,
        "path": [],
        "transformation_logic": "'9999-12-31'",
        "transformation_type": "CONSTANT",
        "role": "DEFAULT_VALUE"
      }
    ]
  }
}
```
2025-04-11 17:50:43,671 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:50:58,781 - INFO - AFC remote call 1 is done.
2025-04-11 17:50:58,781 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimProduct",
  "sources_summary": {
    "wh_db_stage.FinWire": [
      "value",
      "ts"
    ],
    "wh_db.DimProduct": [
      "ProductID",
      "ProductName",
      "ProductAlternateKey",
      "ProductSubcategoryKey",
      "WeightUnitMeasureCode",
      "SizeUnitMeasureCode",
      "EnglishProductName",
      "SpanishProductName",
      "FrenchProductName",
      "StandardCost",
      "FinishedGoodsFlag",
      "Color",
      "SafetyStockLevel",
      "ReorderPoint",
      "ListPrice",
      "Size",
      "Weight",
      "DaysToManufacture",
      "ProductLine",
      "Class",
      "Style",
      "ModelName",
      "LargePhoto",
      "EnglishDescription",
      "FrenchDescription",
      "ChineseDescription",
      "ArabicDescription",
      "HebrewDescription",
      "ThaiDescription",
      "GermanDescription",
      "JapaneseDescription",
      "TurkishDescription",
      "StartDate",
      "EndDate",
      "Status"
    ]
  },
  "lineage": {
    "ProductID": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "ProductID",
        "path": [],
        "transformation_logic": "COALESCE(d.ProductID, -1)",
        "transformation_type": "COALESCE",
        "role": "default"
      }
    ],
    "ProductKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CAST(cmp.ProductKey AS INTEGER)",
        "transformation_type": "CAST",
        "role": "default"
      }
    ],
    "ProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ProductName",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ProductAlternateKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ProductAlternateKey",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ProductSubcategoryKey": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ProductSubcategoryKey",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "WeightUnitMeasureCode": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.WeightUnitMeasureCode",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "SizeUnitMeasureCode": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.SizeUnitMeasureCode",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "EnglishProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.EnglishProductName",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "SpanishProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.SpanishProductName",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "FrenchProductName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.FrenchProductName",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "StandardCost": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.StandardCost",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "FinishedGoodsFlag": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.FinishedGoodsFlag",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Color": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.Color",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "SafetyStockLevel": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.SafetyStockLevel",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ReorderPoint": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ReorderPoint",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ListPrice": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ListPrice",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Size": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.Size",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Weight": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.Weight",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "DaysToManufacture": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.DaysToManufacture",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ProductLine": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ProductLine",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Class": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.Class",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Style": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.Style",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ModelName": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ModelName",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "LargePhoto": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.LargePhoto",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "EnglishDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.EnglishDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "FrenchDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.FrenchDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ChineseDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ChineseDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ArabicDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ArabicDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "HebrewDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.HebrewDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "ThaiDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.ThaiDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "GermanDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.GermanDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "JapaneseDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.JapaneseDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "TurkishDescription": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "value",
        "path": [
          "cmp"
        ],
        "transformation_logic": "cmp.TurkishDescription",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "StartDate": [
      {
        "source_table": "wh_db_stage.FinWire",
        "source_column": "ts",
        "path": [
          "cmp"
        ],
        "transformation_logic": "CAST(strftime('%Y-%m-%d %H:%M:%S', cmp.ts) AS DATETIME)",
        "transformation_type": "CAST",
        "role": "default"
      }
    ],
    "EndDate": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "EndDate",
        "path": [],
        "transformation_logic": "d.EndDate",
        "transformation_type": "RENAME",
        "role": "default"
      }
    ],
    "Status": [
      {
        "source_table": "wh_db.DimProduct",
        "source_column": "Status",
        "path": [],
        "transformation_logic": "'Active'",
        "transformation_type": "CONSTANT",
        "role": "default"
      }
    ]
  }
}
```
2025-04-11 17:51:03,798 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:59:07,434 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:59:15,185 - INFO - AFC remote call 1 is done.
2025-04-11 17:59:15,200 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_broker",
  "sources_summary": {
    "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)": [
      "employeeid",
      "managerid",
      "employeefirstname",
      "employeelastname",
      "employeemi",
      "employeejobcode",
      "employeebranch",
      "employeeoffice",
      "employeephone"
    ]
  },
  "lineage": {
    "employeeid": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeeid",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid"
    },
    "managerid": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "managerid",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "managerid"
    },
    "employeefirstname": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeefirstname",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeefirstname"
    },
    "employeelastname": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeelastname",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeelastname"
    },
    "employeemi": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeemi",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeemi"
    },
    "employeejobcode": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeejobcode",
          "role": "select, filter"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeejobcode"
    },
    "employeebranch": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeebranch",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeebranch"
    },
    "employeeoffice": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeeoffice",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeoffice"
    },
    "employeephone": {
      "path": [],
      "source_columns": [
        {
          "table": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
          "column": "employeephone",
          "role": "select"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeephone"
    }
  }
}
```
2025-04-11 17:59:20,206 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:59:30,129 - INFO - AFC remote call 1 is done.
2025-04-11 17:59:30,144 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimAccount",
  "sources_summary": {
    "wh_db_stage.CustomerMgmt": [
      "accountid",
      "customerid",
      "accountdesc",
      "taxstatus",
      "brokerid",
      "status",
      "update_ts"
    ],
    "wh_db.DimCustomer": [
      "sk_customerid",
      "customerid",
      "effectivedate",
      "enddate"
    ],
    "wh_db.DimBroker": [
      "sk_brokerid",
      "brokerid"
    ]
  },
  "lineage": {
    "sk_accountid": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "strftime(a.effectivedate, '%Y%m%d') || a.accountid",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "accountid",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "accountid"
        },
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "update_ts",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "effectivedate",
          "role": "date_part"
        }
      ]
    },
    "accountid": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "accountid",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "accountid",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "accountid"
        }
      ]
    },
    "sk_brokerid": {
      "path": [
        "b"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "sk_brokerid",
      "sources": [
        {
          "table": "wh_db.DimBroker",
          "column": "sk_brokerid",
          "path": [
            "b"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "sk_brokerid"
        }
      ]
    },
    "sk_customerid": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "sk_customerid",
      "sources": [
        {
          "table": "wh_db.DimCustomer",
          "column": "sk_customerid",
          "path": [
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "sk_customerid"
        }
      ]
    },
    "accountdesc": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "accountdesc",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "accountdesc",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "WINDOW_FUNCTION",
          "transformation_logic": "COALESCE(accountdesc, last_value(accountdesc) OVER w)",
          "role": "value"
        }
      ]
    },
    "taxstatus": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "TaxStatus",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "taxstatus",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "WINDOW_FUNCTION",
          "transformation_logic": "COALESCE(taxstatus, last_value(taxstatus) OVER w)",
          "role": "value"
        }
      ]
    },
    "status": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "status",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "status",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "WINDOW_FUNCTION",
          "transformation_logic": "COALESCE(status, last_value(status) OVER w)",
          "role": "value"
        }
      ]
    },
    "iscurrent": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "SCD2_LOGIC",
      "transformation_logic": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "update_ts",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "WINDOW_FUNCTION",
          "transformation_logic": "CASE WHEN lead(update_ts) OVER w IS NULL THEN 'Y' ELSE 'N' END",
          "role": "condition_input"
        }
      ]
    },
    "batchid": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "batchid",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "update_ts",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "CONSTANT",
          "transformation_logic": "1"
        }
      ]
    },
    "effectivedate": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "effectivedate",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "update_ts",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "effectivedate"
        },
        {
          "table": "wh_db.DimCustomer",
          "column": "effectivedate",
          "path": [
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "effectivedate"
        }
      ]
    },
    "enddate": {
      "path": [
        "account_cust_updates",
        "a"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "enddate",
      "sources": [
        {
          "table": "wh_db_stage.CustomerMgmt",
          "column": "update_ts",
          "path": [
            "account",
            "a",
            "account_final",
            "a",
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "WINDOW_FUNCTION",
          "transformation_logic": "COALESCE(lead(update_ts::DATE) OVER w, '9999-12-31'::DATE)",
          "role": "value"
        },
        {
          "table": "wh_db.DimCustomer",
          "column": "enddate",
          "path": [
            "account_cust_updates",
            "a"
          ],
          "transformation_type": "RENAME",
          "transformation_logic": "enddate"
        }
      ]
    }
  }
}
```
2025-04-11 17:59:35,152 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:59:40,294 - INFO - AFC remote call 1 is done.
2025-04-11 17:59:40,296 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimBroker",
  "sources_summary": {
    "temp_broker": [
      "employeeid",
      "managerid",
      "employeefirstname",
      "employeelastname",
      "employeemi",
      "employeebranch",
      "employeeoffice",
      "employeephone"
    ],
    "wh_db.DimDate": [
      "datevalue"
    ]
  },
  "lineage": {
    "sk_brokerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeid",
          "path": [],
          "transformation_logic": "employeeid",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "brokerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeid",
          "path": [],
          "transformation_logic": "employeeid",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "managerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "managerid",
          "path": [],
          "transformation_logic": "managerid",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "firstname": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeefirstname",
          "path": [],
          "transformation_logic": "employeefirstname",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "lastname": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeelastname",
          "path": [],
          "transformation_logic": "employeelastname",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "middleinitial": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeemi",
          "path": [],
          "transformation_logic": "employeemi",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "branch": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeebranch",
          "path": [],
          "transformation_logic": "employeebranch",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "office": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeoffice",
          "path": [],
          "transformation_logic": "employeeoffice",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "phone": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeephone",
          "path": [],
          "transformation_logic": "employeephone",
          "transformation_type": "RENAME",
          "column_role": "SOURCE"
        }
      ]
    },
    "iscurrent": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "true",
          "transformation_type": "CONSTANT",
          "column_role": "SOURCE"
        }
      ]
    },
    "batchid": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "1",
          "transformation_type": "CONSTANT",
          "column_role": "SOURCE"
        }
      ]
    },
    "effectivedate": {
      "sources": [
        {
          "table": "wh_db.DimDate",
          "column": "datevalue",
          "path": [],
          "transformation_logic": "min(datevalue::DATE)",
          "transformation_type": "WINDOW_FUNCTION",
          "column_role": "SOURCE"
        }
      ]
    },
    "enddate": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "'9999-12-31'::DATE",
          "transformation_type": "CONSTANT",
          "column_role": "SOURCE"
        }
      ]
    }
  }
}
```
2025-04-11 17:59:45,299 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 17:59:58,108 - INFO - AFC remote call 1 is done.
2025-04-11 17:59:58,117 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimCompany",
  "sources_summary": {
    "tables": [
      "wh_db_stage.FinWire",
      "wh_db.industry"
    ],
    "ctes": [
      "cmp"
    ]
  },
  "lineage": {
    "sk_companyid": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 61, 10))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        },
        {
          "table": "wh_db_stage.FinWire",
          "column": "recdate",
          "path": [
            "cmp"
          ],
          "transformation": "recdate",
          "transformation_type": "RENAME",
          "role": "data"
        }
      ],
      "transformation": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)",
      "transformation_type": "EXPRESSION_CONCAT"
    },
    "companyid": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 61, 10))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CAST(cik AS BIGINT)",
      "transformation_type": "CAST"
    },
    "status": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 71, 4))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
      "transformation_type": "CASE_MAPPING"
    },
    "name": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 1, 60))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CompanyName",
      "transformation_type": "RENAME"
    },
    "industry": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 75, 2))",
          "transformation_type": "SUBSTRING",
          "role": "join_key"
        },
        {
          "table": "wh_db.industry",
          "column": "in_name",
          "path": [],
          "transformation": "in_name",
          "transformation_type": "RENAME",
          "role": "data"
        }
      ],
      "transformation": "ind.in_name",
      "transformation_type": "JOIN_LOOKUP"
    },
    "sprating": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 77, 4))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
      "transformation_type": "CASE_MAPPING"
    },
    "islowgrade": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 77, 4))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
      "transformation_type": "CASE_MAPPING"
    },
    "ceo": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 330, 46))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "CEOname",
      "transformation_type": "RENAME"
    },
    "addressline1": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 89, 80))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "AddrLine1",
      "transformation_type": "RENAME"
    },
    "addressline2": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 169, 80))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "AddrLine2",
      "transformation_type": "RENAME"
    },
    "postalcode": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 249, 12))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "PostalCode",
      "transformation_type": "RENAME"
    },
    "city": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 261, 25))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "City",
      "transformation_type": "RENAME"
    },
    "stateprov": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 286, 20))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "StateProvince",
      "transformation_type": "RENAME"
    },
    "country": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 306, 24))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "Country",
      "transformation_type": "RENAME"
    },
    "description": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 376, 150))",
          "transformation_type": "SUBSTRING",
          "role": "data"
        }
      ],
      "transformation": "Description",
      "transformation_type": "RENAME"
    },
    "foundingdate": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRY_CAST(TRY_CAST(SUBSTRING(value, 81, 8) AS TIMESTAMP) AS DATE)",
          "transformation_type": "CAST",
          "role": "data"
        }
      ],
      "transformation": "FoundingDate",
      "transformation_type": "RENAME"
    },
    "iscurrent": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "recdate",
          "path": [
            "cmp"
          ],
          "transformation": "recdate",
          "transformation_type": "RENAME",
          "role": "data"
        }
      ],
      "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
      "transformation_type": "SCD2_LOGIC"
    },
    "batchid": {
      "sources": [],
      "transformation": "1",
      "transformation_type": "CONSTANT"
    },
    "effectivedate": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "recdate",
          "path": [
            "cmp"
          ],
          "transformation": "recdate",
          "transformation_type": "RENAME",
          "role": "data"
        }
      ],
      "transformation": "recdate",
      "transformation_type": "RENAME"
    },
    "enddate": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "recdate",
          "path": [
            "cmp"
          ],
          "transformation": "recdate",
          "transformation_type": "RENAME",
          "role": "partition_key"
        },
        {
          "table": "wh_db_stage.FinWire",
          "column": "value",
          "path": [
            "cmp"
          ],
          "transformation": "TRIM(SUBSTR(value, 61, 10))",
          "transformation_type": "SUBSTRING",
          "role": "partition_key"
        },
        {
          "table": "wh_db_stage.FinWire",
          "column": "recdate",
          "path": [
            "cmp"
          ],
          "transformation": "recdate",
          "transformation_type": "RENAME",
          "role": "data"
        }
      ],
      "transformation": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
      "transformation_type": "WINDOW_FUNCTION"
    }
  }
}
```
2025-04-11 18:00:03,126 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:00:11,402 - INFO - AFC remote call 1 is done.
2025-04-11 18:00:11,402 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "customers",
  "sources_summary": {
    "wh_db_stage.CustomerMgmt": [
      "customerid",
      "taxid",
      "status",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "tier",
      "dob",
      "addressline1",
      "addressline2",
      "postalcode",
      "city",
      "stateprov",
      "country",
      "phone1",
      "phone2",
      "phone3",
      "email1",
      "email2",
      "lcl_tx_id",
      "nat_tx_id",
      "update_ts"
    ]
  },
  "lineage": {
    "customerid": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.customerid"
      ],
      "transformation_logic": "c.customerid",
      "transformation_type": "RENAME"
    },
    "taxid": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.taxid"
      ],
      "transformation_logic": "c.taxid",
      "transformation_type": "RENAME"
    },
    "status": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.status"
      ],
      "transformation_logic": "c.status",
      "transformation_type": "RENAME"
    },
    "lastname": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.lastname"
      ],
      "transformation_logic": "c.lastname",
      "transformation_type": "RENAME"
    },
    "firstname": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.firstname"
      ],
      "transformation_logic": "c.firstname",
      "transformation_type": "RENAME"
    },
    "middleinitial": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.middleinitial"
      ],
      "transformation_logic": "c.middleinitial",
      "transformation_type": "RENAME"
    },
    "gender": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.gender"
      ],
      "transformation_logic": "c.gender",
      "transformation_type": "RENAME"
    },
    "tier": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.tier"
      ],
      "transformation_logic": "c.tier",
      "transformation_type": "RENAME"
    },
    "dob": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.dob"
      ],
      "transformation_logic": "c.dob",
      "transformation_type": "RENAME"
    },
    "addressline1": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.addressline1"
      ],
      "transformation_logic": "c.addressline1",
      "transformation_type": "RENAME"
    },
    "addressline2": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.addressline2"
      ],
      "transformation_logic": "c.addressline2",
      "transformation_type": "RENAME"
    },
    "postalcode": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.postalcode"
      ],
      "transformation_logic": "c.postalcode",
      "transformation_type": "RENAME"
    },
    "city": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.city"
      ],
      "transformation_logic": "c.city",
      "transformation_type": "RENAME"
    },
    "stateprov": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.stateprov"
      ],
      "transformation_logic": "c.stateprov",
      "transformation_type": "RENAME"
    },
    "country": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.country"
      ],
      "transformation_logic": "c.country",
      "transformation_type": "RENAME"
    },
    "phone1": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.phone1"
      ],
      "transformation_logic": "c.phone1",
      "transformation_type": "RENAME"
    },
    "phone2": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.phone2"
      ],
      "transformation_logic": "c.phone2",
      "transformation_type": "RENAME"
    },
    "phone3": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.phone3"
      ],
      "transformation_logic": "c.phone3",
      "transformation_type": "RENAME"
    },
    "email1": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.email1"
      ],
      "transformation_logic": "c.email1",
      "transformation_type": "RENAME"
    },
    "email2": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.email2"
      ],
      "transformation_logic": "c.email2",
      "transformation_type": "RENAME"
    },
    "lcl_tx_id": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.lcl_tx_id"
      ],
      "transformation_logic": "c.lcl_tx_id",
      "transformation_type": "RENAME"
    },
    "nat_tx_id": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.nat_tx_id"
      ],
      "transformation_logic": "c.nat_tx_id",
      "transformation_type": "RENAME"
    },
    "batchid": {
      "path": [],
      "source_columns": [],
      "transformation_logic": "1",
      "transformation_type": "CONSTANT"
    },
    "update_ts": {
      "path": [
        "c"
      ],
      "source_columns": [
        "wh_db_stage.CustomerMgmt.update_ts"
      ],
      "transformation_logic": "c.update_ts",
      "transformation_type": "RENAME"
    }
  }
}
```
2025-04-11 18:00:16,411 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:00:16,890 - INFO - AFC remote call 1 is done.
2025-04-11 18:00:16,890 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimDate",
  "sources_summary": [],
  "lineage": {}
}
```
2025-04-11 18:00:21,895 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:00:29,130 - INFO - AFC remote call 1 is done.
2025-04-11 18:00:29,140 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimSecurity",
  "lineage": {
    "sk_securityid": {
      "sources": [],
      "path": [],
      "transformation_logic": "ROW_NUMBER() OVER ()",
      "transformation_type": "WINDOW_FUNCTION"
    },
    "Symbol": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRIM(SUBSTR(value, 1, 15))",
      "transformation_type": "SUBSTRING"
    },
    "issue": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRIM(SUBSTR(value, 16, 6))",
      "transformation_type": "SUBSTRING"
    },
    "status": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "CASE WHEN status = 'ACTV' THEN 'Active' WHEN status = 'CMPT' THEN 'Completed' WHEN status = 'CNCL' THEN 'Canceled' WHEN status = 'PNDG' THEN 'Pending' WHEN status = 'SBMT' THEN 'Submitted' WHEN status = 'INAC' THEN 'Inactive' ELSE NULL END",
      "transformation_type": "CASE_MAPPING"
    },
    "Name": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRIM(SUBSTR(value, 26, 70))",
      "transformation_type": "SUBSTRING"
    },
    "exchangeid": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRIM(SUBSTR(value, 96, 6))",
      "transformation_type": "SUBSTRING"
    },
    "sk_companyid": {
      "sources": [
        {
          "table": "wh_db.DimCompany",
          "column": "sk_companyid"
        }
      ],
      "path": [
        "dc",
        "SEC_final"
      ],
      "transformation_logic": "dc.sk_companyid",
      "transformation_type": "JOIN_LOOKUP",
      "role": "output"
    },
    "sharesoutstanding": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRY_CAST(SUBSTR(value, 102, 13) AS BIGINT)",
      "transformation_type": "CAST"
    },
    "firsttrade": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRY_CAST(STRPTIME(SUBSTR(value, 115, 8), '%Y%m%d') AS DATE)",
      "transformation_type": "CAST"
    },
    "firsttradeonexchange": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRY_CAST(STRPTIME(SUBSTR(value, 123, 8), '%Y%m%d') AS DATE)",
      "transformation_type": "CAST"
    },
    "Dividend": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "TRY_CAST(SUBSTR(value, 131, 12) AS DOUBLE)",
      "transformation_type": "CAST"
    },
    "iscurrent": {
      "sources": [],
      "path": [
        "SEC_final"
      ],
      "transformation_logic": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
      "transformation_type": "CASE_MAPPING"
    },
    "batchid": {
      "sources": [],
      "path": [],
      "transformation_logic": "1",
      "transformation_type": "CONSTANT"
    },
    "effectivedate": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        },
        {
          "table": "wh_db.DimCompany",
          "column": "EffectiveDate"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "CASE WHEN SEC.effectivedate < dc.EffectiveDate THEN dc.EffectiveDate ELSE SEC.effectivedate END",
      "transformation_type": "SCD2_LOGIC"
    },
    "enddate": {
      "sources": [
        {
          "table": "wh_db_stage.FinWire",
          "column": "value"
        },
        {
          "table": "wh_db.DimCompany",
          "column": "EndDate"
        }
      ],
      "path": [
        "SEC",
        "SEC_prep",
        "SEC_final"
      ],
      "transformation_logic": "CASE WHEN SEC.enddate > dc.EndDate THEN dc.EndDate ELSE SEC.enddate END",
      "transformation_type": "SCD2_LOGIC"
    }
  }
}
```
2025-04-11 18:00:34,144 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:00:34,566 - INFO - AFC remote call 1 is done.
2025-04-11 18:00:34,573 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimTime",
  "sources_summary": {},
  "lineage": {}
}
```
2025-04-11 18:00:39,574 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:00:52,327 - INFO - AFC remote call 1 is done.
2025-04-11 18:00:52,343 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimTrade",
  "sources_summary": {
    "wh_db_stage.tradetxt": [
      "tradeid",
      "t_tt_id",
      "cashflag",
      "quantity",
      "bidprice",
      "executedby",
      "tradeprice",
      "fee",
      "commission",
      "tax",
      "t_s_symb",
      "t_ca_id",
      "status"
    ],
    "wh_db_stage.tradehistory": [
      "tradeid",
      "status",
      "TH_DTS"
    ],
    "wh_db.StatusType": [
      "st_name",
      "st_id"
    ],
    "wh_db.DimSecurity": [
      "sk_securityid",
      "sk_companyid",
      "symbol",
      "effectivedate",
      "enddate"
    ],
    "wh_db.DimAccount": [
      "sk_brokerid",
      "accountid",
      "sk_customerid",
      "sk_accountid",
      "effectivedate",
      "enddate"
    ]
  },
  "lineage": {
    "tradeid": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tradeid",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "tradeid"
        }
      ]
    },
    "sk_brokerid": {
      "path": [],
      "transformation_type": "RENAME",
      "transformation_logic": "da.sk_brokerid",
      "source_columns": [
        {
          "table": "wh_db.DimAccount",
          "column": "sk_brokerid"
        }
      ]
    },
    "sk_createdateid": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CreateDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)",
      "source_columns": [
        {
          "table": "wh_db_stage.tradehistory",
          "column": "TH_DTS",
          "role": "input"
        },
        {
          "table": "wh_db_stage.tradetxt",
          "column": "t_tt_id",
          "role": "condition"
        },
        {
          "table": "wh_db_stage.tradehistory",
          "column": "status",
          "role": "condition"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "accountid",
          "role": "input"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "sk_brokerid",
          "role": "input"
        }
      ]
    },
    "sk_createtimeid": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CreateTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)",
      "source_columns": [
        {
          "table": "wh_db_stage.tradehistory",
          "column": "TH_DTS",
          "role": "input"
        },
        {
          "table": "wh_db_stage.tradetxt",
          "column": "t_tt_id",
          "role": "condition"
        },
        {
          "table": "wh_db_stage.tradehistory",
          "column": "status",
          "role": "condition"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "accountid",
          "role": "input"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "sk_brokerid",
          "role": "input"
        }
      ]
    },
    "sk_closedateid": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CloseDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)",
      "source_columns": [
        {
          "table": "wh_db_stage.tradehistory",
          "column": "TH_DTS",
          "role": "input"
        },
        {
          "table": "wh_db_stage.tradetxt",
          "column": "t_tt_id",
          "role": "condition"
        },
        {
          "table": "wh_db_stage.tradehistory",
          "column": "status",
          "role": "condition"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "accountid",
          "role": "input"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "sk_brokerid",
          "role": "input"
        }
      ]
    },
    "sk_closetimeid": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CloseTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)",
      "source_columns": [
        {
          "table": "wh_db_stage.tradehistory",
          "column": "TH_DTS",
          "role": "input"
        },
        {
          "table": "wh_db_stage.tradetxt",
          "column": "t_tt_id",
          "role": "condition"
        },
        {
          "table": "wh_db_stage.tradehistory",
          "column": "status",
          "role": "condition"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "accountid",
          "role": "input"
        },
        {
          "table": "wh_db.DimAccount",
          "column": "sk_brokerid",
          "role": "input"
        }
      ]
    },
    "st_name": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "st_name",
      "source_columns": [
        {
          "table": "wh_db.StatusType",
          "column": "st_name"
        }
      ]
    },
    "type": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE t_tt_id WHEN 'TMB' THEN 'Market Buy' WHEN 'TMS' THEN 'Market Sell' WHEN 'TSL' THEN 'Stop Loss' WHEN 'TLS' THEN 'Limit Sell' WHEN 'TLB' THEN 'Limit Buy' ELSE NULL END",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "t_tt_id",
          "role": "condition"
        }
      ]
    },
    "cashflag": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cashflag",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "cashflag"
        }
      ]
    },
    "sk_securityid": {
      "path": [],
      "transformation_type": "RENAME",
      "transformation_logic": "ds.sk_securityid",
      "source_columns": [
        {
          "table": "wh_db.DimSecurity",
          "column": "sk_securityid"
        }
      ]
    },
    "sk_companyid": {
      "path": [],
      "transformation_type": "RENAME",
      "transformation_logic": "ds.sk_companyid",
      "source_columns": [
        {
          "table": "wh_db.DimSecurity",
          "column": "sk_companyid"
        }
      ]
    },
    "quantity": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "quantity",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "quantity"
        }
      ]
    },
    "bidprice": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "bidprice",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "bidprice"
        }
      ]
    },
    "sk_customerid": {
      "path": [],
      "transformation_type": "RENAME",
      "transformation_logic": "da.sk_customerid",
      "source_columns": [
        {
          "table": "wh_db.DimAccount",
          "column": "sk_customerid"
        }
      ]
    },
    "sk_accountid": {
      "path": [],
      "transformation_type": "RENAME",
      "transformation_logic": "da.sk_accountid",
      "source_columns": [
        {
          "table": "wh_db.DimAccount",
          "column": "sk_accountid"
        }
      ]
    },
    "executedby": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "executedby",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "executedby"
        }
      ]
    },
    "tradeprice": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tradeprice",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "tradeprice"
        }
      ]
    },
    "fee": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "fee",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "fee"
        }
      ]
    },
    "commission": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "commission",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "commission"
        }
      ]
    },
    "tax": {
      "path": [
        "tradehistorical",
        "trade"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tax",
      "source_columns": [
        {
          "table": "wh_db_stage.tradetxt",
          "column": "tax"
        }
      ]
    },
    "batchid": {
      "path": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1",
      "source_columns": []
    }
  }
}
```
2025-04-11 18:00:57,346 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:01,026 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:01,026 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactCashBalances",
  "sources_summary": {
    "read_csv": [
      "src/data/Batch1\\CashTransaction.txt"
    ],
    "wh_db.DimAccount": [
      "wh_db.DimAccount"
    ]
  },
  "lineage": {
    "sk_customerid": [
      {
        "source_table": "wh_db.DimAccount",
        "source_column": "sk_customerid",
        "path": [
          "a"
        ],
        "transformation_logic": "a.sk_customerid",
        "transformation_type": "RENAME"
      }
    ],
    "sk_accountid": [
      {
        "source_table": "wh_db.DimAccount",
        "source_column": "sk_accountid",
        "path": [
          "a"
        ],
        "transformation_logic": "a.sk_accountid",
        "transformation_type": "RENAME"
      }
    ],
    "sk_dateid": [
      {
        "source_table": "src/data/Batch1\\CashTransaction.txt",
        "source_column": "ct_dts",
        "path": [
          "historical",
          "c"
        ],
        "transformation_logic": "CAST(STRFTIME(datevalue, '%Y%m%d') AS BIGINT)",
        "transformation_type": "CAST"
      }
    ],
    "cash": [
      {
        "source_table": "src/data/Batch1\\CashTransaction.txt",
        "source_column": "ct_amt",
        "path": [
          "historical",
          "c"
        ],
        "transformation_logic": "SUM(account_daily_total) OVER (PARTITION BY c.accountid ORDER BY datevalue)",
        "transformation_type": "WINDOW_FUNCTION",
        "role": "SUM_INPUT"
      },
      {
        "source_table": "src/data/Batch1\\CashTransaction.txt",
        "source_column": "accountid",
        "path": [
          "historical",
          "c"
        ],
        "transformation_logic": "SUM(account_daily_total) OVER (PARTITION BY c.accountid ORDER BY datevalue)",
        "transformation_type": "WINDOW_FUNCTION",
        "role": "PARTITION_KEY"
      },
      {
        "source_table": "src/data/Batch1\\CashTransaction.txt",
        "source_column": "ct_dts",
        "path": [
          "historical",
          "c"
        ],
        "transformation_logic": "SUM(account_daily_total) OVER (PARTITION BY c.accountid ORDER BY datevalue)",
        "transformation_type": "WINDOW_FUNCTION",
        "role": "ORDER_BY"
      }
    ],
    "batchid": [
      {
        "source_table": "src/data/Batch1\\CashTransaction.txt",
        "source_column": "ct_dts",
        "path": [
          "historical",
          "c"
        ],
        "transformation_logic": "c.batchid",
        "transformation_type": "RENAME"
      }
    ]
  }
}
```
2025-04-11 18:01:06,032 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:10,530 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:10,546 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactHoldings",
  "sources_summary": {
    "read_csv": [
      "src/data/Batch1\\HoldingHistory.txt"
    ],
    "wh_db.DimTrade": []
  },
  "lineage": {
    "tradeid": [
      {
        "source_table": "read_csv",
        "source_column": "hh_h_t_id",
        "path": [
          "Holdings"
        ],
        "transformation_logic": "hh_h_t_id",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "currenttradeid": [
      {
        "source_table": "read_csv",
        "source_column": "hh_t_id",
        "path": [
          "Holdings"
        ],
        "transformation_logic": "hh_t_id",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_customerid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_customerid",
        "path": [],
        "transformation_logic": "sk_customerid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_accountid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_accountid",
        "path": [],
        "transformation_logic": "sk_accountid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_securityid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_securityid",
        "path": [],
        "transformation_logic": "sk_securityid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_companyid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_companyid",
        "path": [],
        "transformation_logic": "sk_companyid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_dateid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_closedateid",
        "path": [],
        "transformation_logic": "sk_closedateid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "sk_timeid": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "sk_closetimeid",
        "path": [],
        "transformation_logic": "sk_closetimeid",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "currentprice": [
      {
        "source_table": "wh_db.DimTrade",
        "source_column": "tradeprice",
        "path": [],
        "transformation_logic": "tradeprice",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "currentholding": [
      {
        "source_table": "read_csv",
        "source_column": "hh_after_qty",
        "path": [
          "Holdings"
        ],
        "transformation_logic": "hh_after_qty",
        "transformation_type": "RENAME",
        "column_role": null
      }
    ],
    "batchid": [
      {
        "source_table": "read_csv",
        "source_column": "hh_h_t_id",
        "path": [
          "Holdings"
        ],
        "transformation_logic": "1",
        "transformation_type": "CONSTANT",
        "column_role": null
      }
    ]
  }
}
```
2025-04-11 18:01:15,552 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:18,473 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:18,473 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactWatches",
  "lineage": {
    "sk_customerid": [
      {
        "source_table": "wh_db.DimCustomer",
        "source_column": "sk_customerid",
        "path": [],
        "transformation_logic": "c.sk_customerid",
        "transformation_type": "RENAME",
        "column_role": "select"
      }
    ],
    "sk_securityid": [
      {
        "source_table": "wh_db.DimSecurity",
        "source_column": "sk_securityid",
        "path": [],
        "transformation_logic": "s.sk_securityid",
        "transformation_type": "RENAME",
        "column_role": "select"
      }
    ],
    "sk_dateid_dateplaced": [
      {
        "source_table": "watches",
        "source_column": "dateplaced",
        "path": [],
        "transformation_logic": "CAST(strftime(dateplaced, '%Y%m%d') AS BIGINT)",
        "transformation_type": "CAST",
        "column_role": "select"
      }
    ],
    "sk_dateid_dateremoved": [
      {
        "source_table": "watches",
        "source_column": "dateremoved",
        "path": [],
        "transformation_logic": "CAST(strftime(dateremoved, '%Y%m%d') AS BIGINT)",
        "transformation_type": "CAST",
        "column_role": "select"
      }
    ],
    "batchid": [
      {
        "source_table": "watches",
        "source_column": "batchid",
        "path": [],
        "transformation_logic": "wh.batchid",
        "transformation_type": "RENAME",
        "column_role": "select"
      }
    ]
  },
  "sources_summary": {
    "target_table": "wh_db.FactWatches",
    "source_tables": [
      "wh_db.DimCustomer",
      "wh_db.DimSecurity",
      "watches",
      "watchhistory"
    ],
    "ctes": [
      "watchhistory",
      "watches"
    ]
  }
}
```
2025-04-11 18:01:23,477 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:30,370 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:30,372 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.Financial",
  "sources_summary": {
    "wh_db_stage.FinWire": [
      "value",
      "recdate"
    ],
    "wh_db.DimCompany": [
      "sk_companyid",
      "companyid",
      "name",
      "effectivedate",
      "enddate"
    ]
  },
  "lineage": {
    "sk_companyid": {
      "path": [
        "dc"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "dc.sk_companyid",
      "source_columns": [
        {
          "name": "sk_companyid",
          "table": "wh_db.DimCompany"
        }
      ]
    },
    "fi_year": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 1 FOR 4) AS INTEGER)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_qtr": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 5 FOR 1) AS INTEGER)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_qtr_start_date": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "strptime(SUBSTRING(value FROM 6 FOR 8), '%Y%m%d')::DATE",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_revenue": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 22 FOR 17) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_net_earn": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 39 FOR 17) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_basic_eps": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 56 FOR 12) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_dilut_eps": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 68 FOR 12) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_margin": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 80 FOR 12) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_inventory": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 92 FOR 17) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_assets": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 109 FOR 17) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_liability": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 126 FOR 17) AS DOUBLE)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_out_basic": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 143 FOR 13) AS BIGINT)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    },
    "fi_out_dilut": {
      "path": [
        "finwire_parsed"
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 156 FOR 13) AS BIGINT)",
      "source_columns": [
        {
          "name": "value",
          "table": "wh_db_stage.FinWire"
        }
      ]
    }
  }
}
```
2025-04-11 18:01:35,375 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:46,827 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:46,837 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.Prospect",
  "sources_summary": {
    "wh_db_stage.ProspectIncremental": [
      "agencyid",
      "recordbatchid",
      "batchid",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "addressline1",
      "addressline2",
      "postalcode",
      "city",
      "state",
      "country",
      "phone",
      "income",
      "numbercars",
      "numberchildren",
      "maritalstatus",
      "age",
      "creditrating",
      "ownorrentflag",
      "employer",
      "numbercreditcards",
      "networth",
      "marketingnameplate"
    ],
    "wh_db.BatchDate": [
      "batchdate",
      "batchid"
    ],
    "wh_db.DimCustomer": [
      "lastname",
      "firstname",
      "addressline1",
      "addressline2",
      "postalcode",
      "iscurrent"
    ]
  },
  "lineage": {
    "agencyid": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "agencyid",
          "path": [],
          "transformation_logic": "p.agencyid",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "sk_recorddateid": {
      "sources": [
        {
          "table": "wh_db.BatchDate",
          "column": "batchdate",
          "path": [],
          "transformation_logic": "CAST(STRFTIME(recdate.batchdate, '%Y%m%d') AS BIGINT)",
          "transformation_type": "CAST",
          "column_role": "OUTPUT"
        }
      ]
    },
    "sk_updatedateid": {
      "sources": [
        {
          "table": "wh_db.BatchDate",
          "column": "batchdate",
          "path": [],
          "transformation_logic": "CAST(STRFTIME(origdate.batchdate, '%Y%m%d') AS BIGINT)",
          "transformation_type": "CAST",
          "column_role": "OUTPUT"
        }
      ]
    },
    "batchid": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "batchid",
          "path": [],
          "transformation_logic": "p.batchid",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "iscustomer": {
      "sources": [
        {
          "table": "wh_db.DimCustomer",
          "column": "lastname",
          "path": [
            "cust"
          ],
          "transformation_logic": "CASE WHEN c.LastName IS NOT NULL THEN TRUE ELSE FALSE END",
          "transformation_type": "CASE_MAPPING",
          "column_role": "CONDITION_INPUT"
        }
      ]
    },
    "lastname": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "lastname",
          "path": [],
          "transformation_logic": "p.lastname",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "firstname": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "firstname",
          "path": [],
          "transformation_logic": "p.firstname",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "middleinitial": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "middleinitial",
          "path": [],
          "transformation_logic": "p.middleinitial",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "gender": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "gender",
          "path": [],
          "transformation_logic": "p.gender",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "addressline1": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "addressline1",
          "path": [],
          "transformation_logic": "p.addressline1",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "addressline2": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "addressline2",
          "path": [],
          "transformation_logic": "p.addressline2",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "postalcode": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "postalcode",
          "path": [],
          "transformation_logic": "p.postalcode",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "city": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "city",
          "path": [],
          "transformation_logic": "p.city",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "state": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "state",
          "path": [],
          "transformation_logic": "p.state",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "country": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "country",
          "path": [],
          "transformation_logic": "p.country",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "phone": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "phone",
          "path": [],
          "transformation_logic": "p.phone",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "income": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "income",
          "path": [],
          "transformation_logic": "p.income",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "numbercars": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "numbercars",
          "path": [],
          "transformation_logic": "p.numbercars",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "numberchildren": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "numberchildren",
          "path": [],
          "transformation_logic": "p.numberchildren",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "maritalstatus": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "maritalstatus",
          "path": [],
          "transformation_logic": "p.maritalstatus",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "age": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "age",
          "path": [],
          "transformation_logic": "p.age",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "creditrating": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "creditrating",
          "path": [],
          "transformation_logic": "p.creditrating",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "ownorrentflag": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "ownorrentflag",
          "path": [],
          "transformation_logic": "p.ownorrentflag",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "employer": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "employer",
          "path": [],
          "transformation_logic": "p.employer",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "numbercreditcards": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "numbercreditcards",
          "path": [],
          "transformation_logic": "p.numbercreditcards",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "networth": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "networth",
          "path": [],
          "transformation_logic": "p.networth",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    },
    "marketingnameplate": {
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "marketingnameplate",
          "path": [],
          "transformation_logic": "p.marketingnameplate",
          "transformation_type": "RENAME",
          "column_role": "OUTPUT"
        }
      ]
    }
  }
}
```
2025-04-11 18:01:51,839 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:01:53,587 - INFO - AFC remote call 1 is done.
2025-04-11 18:01:53,587 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.StatusType",
  "lineage": {
    "StatusTypeID": [
      {
        "source_table": "src/data/Batch1\\StatusType.txt",
        "source_column": "StatusTypeID",
        "path": [],
        "transformation_logic": "StatusTypeID",
        "transformation_type": "RENAME",
        "column_role": "target"
      }
    ],
    "StatusTypeCode": [
      {
        "source_table": "src/data/Batch1\\StatusType.txt",
        "source_column": "StatusTypeCode",
        "path": [],
        "transformation_logic": "StatusTypeCode",
        "transformation_type": "RENAME",
        "column_role": "target"
      }
    ],
    "StatusTypeDescription": [
      {
        "source_table": "src/data/Batch1\\StatusType.txt",
        "source_column": "StatusTypeDescription",
        "path": [],
        "transformation_logic": "StatusTypeDescription",
        "transformation_type": "RENAME",
        "column_role": "target"
      }
    ]
  }
}
```
2025-04-11 18:01:58,595 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:02:01,115 - INFO - AFC remote call 1 is done.
2025-04-11 18:02:01,115 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.TaxRate",
  "sources_summary": {
    "file": "src/data/Batch1\\TaxRate.txt"
  },
  "lineage": {
    "TaxRateID": {
      "sources": [
        {
          "table": "src/data/Batch1\\TaxRate.txt",
          "column": "TaxRateID",
          "path": [],
          "transformation_logic": "TaxRateID",
          "transformation_type": "RENAME",
          "role": "SOURCE"
        }
      ]
    },
    "State": {
      "sources": [
        {
          "table": "src/data/Batch1\\TaxRate.txt",
          "column": "State",
          "path": [],
          "transformation_logic": "State",
          "transformation_type": "RENAME",
          "role": "SOURCE"
        }
      ]
    },
    "Rate": {
      "sources": [
        {
          "table": "src/data/Batch1\\TaxRate.txt",
          "column": "Rate",
          "path": [],
          "transformation_logic": "Rate",
          "transformation_type": "RENAME",
          "role": "SOURCE"
        }
      ]
    },
    "EffectiveDate": {
      "sources": [
        {
          "table": "src/data/Batch1\\TaxRate.txt",
          "column": "EffectiveDate",
          "path": [],
          "transformation_logic": "EffectiveDate",
          "transformation_type": "RENAME",
          "role": "SOURCE"
        }
      ]
    },
    "ExpirationDate": {
      "sources": [
        {
          "table": "src/data/Batch1\\TaxRate.txt",
          "column": "ExpirationDate",
          "path": [],
          "transformation_logic": "ExpirationDate",
          "transformation_type": "RENAME",
          "role": "SOURCE"
        }
      ]
    }
  }
}
```
2025-04-11 18:02:06,129 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:02:06,570 - INFO - AFC remote call 1 is done.
2025-04-11 18:02:06,570 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.TradeType",
  "sources_summary": [],
  "lineage": {}
}
```
2025-04-11 18:02:11,576 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:02:16,713 - INFO - AFC remote call 1 is done.
2025-04-11 18:02:16,729 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimBroker",
  "sources_summary": {
    "temp_broker": [
      "employeeid",
      "managerid",
      "employeefirstname",
      "employeelastname",
      "employeemi",
      "employeebranch",
      "employeeoffice",
      "employeephone"
    ],
    "wh_db.DimDate": [
      "datevalue"
    ]
  },
  "lineage": {
    "sk_brokerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeid",
          "path": [],
          "transformation_logic": "employeeid",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "brokerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeid",
          "path": [],
          "transformation_logic": "employeeid",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "managerid": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "managerid",
          "path": [],
          "transformation_logic": "managerid",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "firstname": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeefirstname",
          "path": [],
          "transformation_logic": "employeefirstname",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "lastname": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeelastname",
          "path": [],
          "transformation_logic": "employeelastname",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "middleinitial": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeemi",
          "path": [],
          "transformation_logic": "employeemi",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "branch": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeebranch",
          "path": [],
          "transformation_logic": "employeebranch",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "office": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeeoffice",
          "path": [],
          "transformation_logic": "employeeoffice",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "phone": {
      "sources": [
        {
          "table": "temp_broker",
          "column": "employeephone",
          "path": [],
          "transformation_logic": "employeephone",
          "transformation_type": "RENAME",
          "column_role": "DEFAULT"
        }
      ]
    },
    "iscurrent": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "true",
          "transformation_type": "CONSTANT",
          "column_role": "DEFAULT"
        }
      ]
    },
    "batchid": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "1",
          "transformation_type": "CONSTANT",
          "column_role": "DEFAULT"
        }
      ]
    },
    "effectivedate": {
      "sources": [
        {
          "table": "wh_db.DimDate",
          "column": "datevalue",
          "path": [],
          "transformation_logic": "min(datevalue::DATE)",
          "transformation_type": "CAST",
          "column_role": "DEFAULT"
        }
      ]
    },
    "enddate": {
      "sources": [
        {
          "table": null,
          "column": null,
          "path": [],
          "transformation_logic": "'9999-12-31'::DATE",
          "transformation_type": "CAST",
          "column_role": "DEFAULT"
        }
      ]
    }
  }
}
```
2025-04-11 18:02:21,731 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:02:26,061 - INFO - AFC remote call 1 is done.
2025-04-11 18:02:26,061 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.FinWire",
  "lineage": {
    "rectype": [
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "CASE WHEN SUBSTR(column0, 16, 3) = 'FIN' THEN CASE WHEN TRY_CAST(TRIM(SUBSTR(column0, 187, 60)) AS BIGINT) IS NOT NULL THEN 'FIN_COMPANYID' ELSE 'FIN_NAME' END ELSE SUBSTR(column0, 16, 3) END",
        "transformation_type": "CASE_MAPPING"
      },
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "SUBSTR(column0, 16, 3)",
        "transformation_type": "SUBSTRING"
      },
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "TRIM(SUBSTR(column0, 187, 60))",
        "transformation_type": "SUBSTRING"
      },
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "TRY_CAST(TRIM(SUBSTR(column0, 187, 60)) AS BIGINT)",
        "transformation_type": "CAST"
      }
    ],
    "recdate": [
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "STRPTIME(SUBSTR(column0, 1, 8), '%Y%m%d')",
        "transformation_type": "CAST"
      },
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "SUBSTR(column0, 1, 8)",
        "transformation_type": "SUBSTRING"
      }
    ],
    "value": [
      {
        "sources": [
          {
            "table": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
            "column": "column0"
          }
        ],
        "path": [],
        "transformation_logic": "SUBSTR(column0, 19)",
        "transformation_type": "SUBSTRING"
      }
    ]
  }
}
```
2025-04-11 18:02:31,066 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:02:53,829 - INFO - AFC remote call 1 is done.
2025-04-11 18:02:53,847 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_propect",
  "sources_summary": {
    "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)": [
      "agencyid",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "addressline1",
      "addressline2",
      "postalcode",
      "city",
      "state",
      "country",
      "phone",
      "income",
      "numbercars",
      "numberchildren",
      "maritalstatus",
      "age",
      "creditrating",
      "ownorrentflag",
      "employer",
      "numbercreditcards",
      "networth"
    ]
  },
  "lineage": {
    "agencyid": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "agencyid",
        "path": [],
        "transformation_logic": "agencyid",
        "transformation_type": "RENAME"
      }
    ],
    "lastname": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "lastname",
        "path": [],
        "transformation_logic": "lastname",
        "transformation_type": "RENAME"
      }
    ],
    "firstname": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "firstname",
        "path": [],
        "transformation_logic": "firstname",
        "transformation_type": "RENAME"
      }
    ],
    "middleinitial": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "middleinitial",
        "path": [],
        "transformation_logic": "middleinitial",
        "transformation_type": "RENAME"
      }
    ],
    "gender": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "gender",
        "path": [],
        "transformation_logic": "gender",
        "transformation_type": "RENAME"
      }
    ],
    "addressline1": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "addressline1",
        "path": [],
        "transformation_logic": "addressline1",
        "transformation_type": "RENAME"
      }
    ],
    "addressline2": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "addressline2",
        "path": [],
        "transformation_logic": "addressline2",
        "transformation_type": "RENAME"
      }
    ],
    "postalcode": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "postalcode",
        "path": [],
        "transformation_logic": "postalcode",
        "transformation_type": "RENAME"
      }
    ],
    "city": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "city",
        "path": [],
        "transformation_logic": "city",
        "transformation_type": "RENAME"
      }
    ],
    "state": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "state",
        "path": [],
        "transformation_logic": "state",
        "transformation_type": "RENAME"
      }
    ],
    "country": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "country",
        "path": [],
        "transformation_logic": "country",
        "transformation_type": "RENAME"
      }
    ],
    "phone": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "phone",
        "path": [],
        "transformation_logic": "phone",
        "transformation_type": "RENAME"
      }
    ],
    "income": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "income",
        "path": [],
        "transformation_logic": "income",
        "transformation_type": "RENAME"
      }
    ],
    "numbercars": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "numbercars",
        "path": [],
        "transformation_logic": "numbercars",
        "transformation_type": "RENAME"
      }
    ],
    "numberchildren": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "numberchildren",
        "path": [],
        "transformation_logic": "numberchildren",
        "transformation_type": "RENAME"
      }
    ],
    "maritalstatus": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "maritalstatus",
        "path": [],
        "transformation_logic": "maritalstatus",
        "transformation_type": "RENAME"
      }
    ],
    "age": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "age",
        "path": [],
        "transformation_logic": "age",
        "transformation_type": "RENAME"
      }
    ],
    "creditrating": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "creditrating",
        "path": [],
        "transformation_logic": "creditrating",
        "transformation_type": "RENAME"
      }
    ],
    "ownorrentflag": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "ownorrentflag",
        "path": [],
        "transformation_logic": "ownorrentflag",
        "transformation_type": "RENAME"
      }
    ],
    "employer": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "employer",
        "path": [],
        "transformation_logic": "employer",
        "transformation_type": "RENAME"
      }
    ],
    "numbercreditcards": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "numbercreditcards",
        "path": [],
        "transformation_logic": "numbercreditcards",
        "transformation_type": "RENAME"
      }
    ],
    "networth": [
      {
        "source_table": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
        "source_column": "networth",
        "path": [],
        "transformation_logic": "networth",
        "transformation_type": "RENAME"
      }
    ],
    "batchid": [
      {
        "source_table": null,
        "source_column": null,
        "path": [],
        "transformation_logic": "1",
        "transformation_type": "CONSTANT"
      }
    ]
  }
}
```
2025-04-11 18:02:58,856 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:03:12,109 - INFO - AFC remote call 1 is done.
2025-04-11 18:03:12,125 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.tradetxt",
  "sources_summary": {
    "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})": [
      "tradeid",
      "t_dts",
      "status",
      "t_tt_id",
      "cashflag",
      "t_s_symb",
      "quantity",
      "bidprice",
      "t_ca_id",
      "executedby",
      "tradeprice",
      "fee",
      "commission",
      "tax"
    ]
  },
  "lineage": {
    "tradeid": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "tradeid",
        "path": [],
        "transformation_logic": "tradeid",
        "transformation_type": "RENAME"
      }
    ],
    "t_dts": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "t_dts",
        "path": [],
        "transformation_logic": "t_dts",
        "transformation_type": "RENAME"
      }
    ],
    "status": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "status",
        "path": [],
        "transformation_logic": "status",
        "transformation_type": "RENAME"
      }
    ],
    "t_tt_id": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "t_tt_id",
        "path": [],
        "transformation_logic": "t_tt_id",
        "transformation_type": "RENAME"
      }
    ],
    "cashflag": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "cashflag",
        "path": [],
        "transformation_logic": "cashflag",
        "transformation_type": "RENAME"
      }
    ],
    "t_s_symb": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "t_s_symb",
        "path": [],
        "transformation_logic": "t_s_symb",
        "transformation_type": "RENAME"
      }
    ],
    "quantity": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "quantity",
        "path": [],
        "transformation_logic": "quantity",
        "transformation_type": "RENAME"
      }
    ],
    "bidprice": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "bidprice",
        "path": [],
        "transformation_logic": "bidprice",
        "transformation_type": "RENAME"
      }
    ],
    "t_ca_id": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "t_ca_id",
        "path": [],
        "transformation_logic": "t_ca_id",
        "transformation_type": "RENAME"
      }
    ],
    "executedby": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "executedby",
        "path": [],
        "transformation_logic": "executedby",
        "transformation_type": "RENAME"
      }
    ],
    "tradeprice": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "tradeprice",
        "path": [],
        "transformation_logic": "tradeprice",
        "transformation_type": "RENAME"
      }
    ],
    "fee": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "fee",
        "path": [],
        "transformation_logic": "fee",
        "transformation_type": "RENAME"
      }
    ],
    "commission": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "commission",
        "path": [],
        "transformation_logic": "commission",
        "transformation_type": "RENAME"
      }
    ],
    "tax": [
      {
        "source_table": "read_csv('src/data/Batch1\\Trade.txt', HEADER=FALSE, filename=false, all_varchar=true, delim='|',strict_mode=false , columns = {\"tradeid\": \"BIGINT\", \"t_dts\": \"TIMESTAMP\",\"status\": \"STRING\", \"t_tt_id\": \"STRING\",\"cashflag\": \"TINYINT\",\"t_s_symb\": \"STRING\",\"quantity\": \"INT\",\"bidprice\": \"DOUBLE\",\"t_ca_id\": \"BIGINT\",\"executedby\": \"STRING\",\"tradeprice\": \"DOUBLE\",\"fee\": \"DOUBLE\",\"commission\": \"DOUBLE\",\"tax\": \"DOUBLE\"})",
        "source_column": "tax",
        "path": [],
        "transformation_logic": "tax",
        "transformation_type": "RENAME"
      }
    ]
  }
}
```
2025-04-11 18:03:17,128 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:03:35,749 - INFO - AFC remote call 1 is done.
2025-04-11 18:03:35,761 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "customers_final",
  "sources_summary": {
    "customers": [
      "customerid",
      "taxid",
      "status",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "tier",
      "dob",
      "addressline1",
      "addressline2",
      "postalcode",
      "CITY",
      "stateprov",
      "country",
      "phone1",
      "phone2",
      "phone3",
      "email1",
      "email2",
      "LCL_TX_ID",
      "NAT_TX_ID",
      "batchid",
      "update_ts"
    ]
  },
  "lineage": {
    "customerid": {
      "sources": [
        {
          "table": "customers",
          "column": "customerid",
          "path": [],
          "transformation_logic": "customerid",
          "transformation_type": "RENAME",
          "column_role": "select"
        }
      ]
    },
    "taxid": {
      "sources": [
        {
          "table": "customers",
          "column": "taxid",
          "path": [],
          "transformation_logic": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "status": {
      "sources": [
        {
          "table": "customers",
          "column": "status",
          "path": [],
          "transformation_logic": "status",
          "transformation_type": "RENAME",
          "column_role": "select"
        }
      ]
    },
    "lastname": {
      "sources": [
        {
          "table": "customers",
          "column": "lastname",
          "path": [],
          "transformation_logic": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "firstname": {
      "sources": [
        {
          "table": "customers",
          "column": "firstname",
          "path": [],
          "transformation_logic": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "middleinitial": {
      "sources": [
        {
          "table": "customers",
          "column": "middleinitial",
          "path": [],
          "transformation_logic": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "gender": {
      "sources": [
        {
          "table": "customers",
          "column": "gender",
          "path": [],
          "transformation_logic": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "tier": {
      "sources": [
        {
          "table": "customers",
          "column": "tier",
          "path": [],
          "transformation_logic": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "dob": {
      "sources": [
        {
          "table": "customers",
          "column": "dob",
          "path": [],
          "transformation_logic": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "addressline1": {
      "sources": [
        {
          "table": "customers",
          "column": "addressline1",
          "path": [],
          "transformation_logic": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "addressline2": {
      "sources": [
        {
          "table": "customers",
          "column": "addressline2",
          "path": [],
          "transformation_logic": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "postalcode": {
      "sources": [
        {
          "table": "customers",
          "column": "postalcode",
          "path": [],
          "transformation_logic": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "CITY": {
      "sources": [
        {
          "table": "customers",
          "column": "CITY",
          "path": [],
          "transformation_logic": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "stateprov": {
      "sources": [
        {
          "table": "customers",
          "column": "stateprov",
          "path": [],
          "transformation_logic": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "country": {
      "sources": [
        {
          "table": "customers",
          "column": "country",
          "path": [],
          "transformation_logic": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "phone1": {
      "sources": [
        {
          "table": "customers",
          "column": "phone1",
          "path": [],
          "transformation_logic": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "phone2": {
      "sources": [
        {
          "table": "customers",
          "column": "phone2",
          "path": [],
          "transformation_logic": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "phone3": {
      "sources": [
        {
          "table": "customers",
          "column": "phone3",
          "path": [],
          "transformation_logic": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "email1": {
      "sources": [
        {
          "table": "customers",
          "column": "email1",
          "path": [],
          "transformation_logic": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "email2": {
      "sources": [
        {
          "table": "customers",
          "column": "email2",
          "path": [],
          "transformation_logic": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "LCL_TX_ID": {
      "sources": [
        {
          "table": "customers",
          "column": "LCL_TX_ID",
          "path": [],
          "transformation_logic": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "NAT_TX_ID": {
      "sources": [
        {
          "table": "customers",
          "column": "NAT_TX_ID",
          "path": [],
          "transformation_logic": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        },
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "order"
        }
      ]
    },
    "batchid": {
      "sources": [
        {
          "table": "customers",
          "column": "batchid",
          "path": [],
          "transformation_logic": "batchid",
          "transformation_type": "RENAME",
          "column_role": "select"
        }
      ]
    },
    "iscurrent": {
      "sources": [
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "CASE WHEN NULLIF(lead(update_ts) OVER w, NULL) IS NULL THEN 'Y' ELSE 'N' END",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        }
      ]
    },
    "effectivedate": {
      "sources": [
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "update_ts::DATE",
          "transformation_type": "CAST",
          "column_role": "value"
        }
      ]
    },
    "enddate": {
      "sources": [
        {
          "table": "customers",
          "column": "update_ts",
          "path": [],
          "transformation_logic": "COALESCE(lead(update_ts::DATE) OVER w, '9999-12-31'::DATE)",
          "transformation_type": "SCD2_LOGIC",
          "column_role": "value"
        }
      ]
    }
  }
}
```
2025-04-11 18:03:40,766 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:03:48,790 - INFO - AFC remote call 1 is done.
2025-04-11 18:03:48,800 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_propect_marketingnameplate",
  "sources_summary": {
    "temp_propect": [
      "networth",
      "income",
      "numberchildren",
      "numbercreditcards",
      "age",
      "creditrating",
      "numbercars"
    ]
  },
  "lineage": {
    "marketingnameplate": [
      {
        "source_table": "temp_propect",
        "source_column": "networth",
        "path": [],
        "transformation_logic": "CASE WHEN networth > 1000000 OR income > 200000 THEN 'HighValue+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "income",
        "path": [],
        "transformation_logic": "CASE WHEN networth > 1000000 OR income > 200000 THEN 'HighValue+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numberchildren",
        "path": [],
        "transformation_logic": "CASE WHEN numberchildren > 3 OR numbercreditcards > 5 THEN 'Expenses+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numbercreditcards",
        "path": [],
        "transformation_logic": "CASE WHEN numberchildren > 3 OR numbercreditcards > 5 THEN 'Expenses+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "age",
        "path": [],
        "transformation_logic": "CASE WHEN age > 45 THEN 'Boomer+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "income",
        "path": [],
        "transformation_logic": "CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "creditrating",
        "path": [],
        "transformation_logic": "CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "networth",
        "path": [],
        "transformation_logic": "CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numbercars",
        "path": [],
        "transformation_logic": "CASE WHEN numbercars > 3 OR numbercreditcards > 7 THEN 'Spender+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numbercreditcards",
        "path": [],
        "transformation_logic": "CASE WHEN numbercars > 3 OR numbercreditcards > 7 THEN 'Spender+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "age",
        "path": [],
        "transformation_logic": "CASE WHEN age < 25 AND networth > 1000000 THEN 'Inherited+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "networth",
        "path": [],
        "transformation_logic": "CASE WHEN age < 25 AND networth > 1000000 THEN 'Inherited+' ELSE '' END",
        "transformation_type": "CASE_MAPPING",
        "column_role": "condition_input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "networth",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "income",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numberchildren",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numbercreditcards",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "age",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "creditrating",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      },
      {
        "source_table": "temp_propect",
        "source_column": "numbercars",
        "path": [],
        "transformation_logic": "LEFT(CONCAT(...), LENGTH(CONCAT(...)) - 1)",
        "transformation_type": "SUBSTRING",
        "column_role": "input"
      }
    ],
    "*": [
      {
        "source_table": "temp_propect",
        "source_column": "*",
        "path": [],
        "transformation_logic": "direct copy",
        "transformation_type": "RENAME",
        "column_role": "select"
      }
    ]
  }
}
```
2025-04-11 18:03:53,805 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:03:56,293 - INFO - AFC remote call 1 is done.
2025-04-11 18:03:56,299 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.tradehistory",
  "lineage": {
    "tradeid": {
      "sources": [
        {
          "table": "read_csv_auto('src/data/Batch1\\TradeHistory.txt', HEADER=FALSE, filename=false, all_varchar=true, columns = {\n    \"tradeid\": \"BIGINT\", --TH_T_ID\n    \"th_dts\": \"TIMESTAMP\", --TH_DTS\n    \"status\": \"STRING\"})",
          "column": "tradeid",
          "path": [],
          "transformation_type": "RENAME",
          "transformation_logic": "tradeid",
          "role": null
        }
      ]
    },
    "th_dts": {
      "sources": [
        {
          "table": "read_csv_auto('src/data/Batch1\\TradeHistory.txt', HEADER=FALSE, filename=false, all_varchar=true, columns = {\n    \"tradeid\": \"BIGINT\", --TH_T_ID\n    \"th_dts\": \"TIMESTAMP\", --TH_DTS\n    \"status\": \"STRING\"})",
          "column": "th_dts",
          "path": [],
          "transformation_type": "RENAME",
          "transformation_logic": "th_dts",
          "role": null
        }
      ]
    },
    "status": {
      "sources": [
        {
          "table": "read_csv_auto('src/data/Batch1\\TradeHistory.txt', HEADER=FALSE, filename=false, all_varchar=true, columns = {\n    \"tradeid\": \"BIGINT\", --TH_T_ID\n    \"th_dts\": \"TIMESTAMP\", --TH_DTS\n    \"status\": \"STRING\"})",
          "column": "status",
          "path": [],
          "transformation_type": "RENAME",
          "transformation_logic": "status",
          "role": null
        }
      ]
    }
  }
}
```
2025-04-11 18:04:01,301 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:04:18,789 - INFO - AFC remote call 1 is done.
2025-04-11 18:04:18,809 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimCustomer",
  "sources_summary": {
    "customers_final": [
      "customerid",
      "taxid",
      "status",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "tier",
      "dob",
      "addressline1",
      "addressline2",
      "postalcode",
      "city",
      "stateprov",
      "country",
      "phone1",
      "phone2",
      "phone3",
      "email1",
      "email2",
      "lcl_tx_id",
      "nat_tx_id",
      "iscurrent",
      "batchid",
      "effectivedate",
      "enddate"
    ],
    "wh_db.TaxRate": [
      "TX_ID",
      "TX_NAME",
      "TX_RATE"
    ],
    "wh_db_stage.ProspectIncremental": [
      "agencyid",
      "creditrating",
      "networth",
      "marketingnameplate",
      "lastname",
      "firstname",
      "addressline1",
      "addressline2",
      "postalcode"
    ],
    "wh_db.DimCustomer": [
      "sk_customerid"
    ]
  },
  "lineage": {
    "sk_customerid": {
      "path": [
        "MaxSK"
      ],
      "transformation_type": "ROW_NUMBER",
      "transformation_logic": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1",
      "sources": [
        {
          "table": "wh_db.DimCustomer",
          "column": "sk_customerid",
          "role": "MAX_VALUE",
          "transformation_type": "AGGREGATION",
          "transformation_logic": "COALESCE(MAX(sk_customerid), 0)"
        }
      ]
    },
    "customerid": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.customerid",
      "sources": [
        {
          "table": "customers_final",
          "column": "customerid",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.customerid"
        }
      ]
    },
    "taxid": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.taxid",
      "sources": [
        {
          "table": "customers_final",
          "column": "taxid",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.taxid"
        }
      ]
    },
    "status": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.status",
      "sources": [
        {
          "table": "customers_final",
          "column": "status",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.status"
        }
      ]
    },
    "lastname": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.lastname",
      "sources": [
        {
          "table": "customers_final",
          "column": "lastname",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.lastname"
        }
      ]
    },
    "firstname": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.firstname",
      "sources": [
        {
          "table": "customers_final",
          "column": "firstname",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.firstname"
        }
      ]
    },
    "middleinitial": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.middleinitial",
      "sources": [
        {
          "table": "customers_final",
          "column": "middleinitial",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.middleinitial"
        }
      ]
    },
    "gender": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')",
      "sources": [
        {
          "table": "customers_final",
          "column": "gender",
          "role": "CONDITION_INPUT",
          "transformation_type": "RENAME",
          "transformation_logic": "c.gender"
        }
      ]
    },
    "tier": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.tier",
      "sources": [
        {
          "table": "customers_final",
          "column": "tier",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.tier"
        }
      ]
    },
    "dob": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.dob",
      "sources": [
        {
          "table": "customers_final",
          "column": "dob",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.dob"
        }
      ]
    },
    "addressline1": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.addressline1",
      "sources": [
        {
          "table": "customers_final",
          "column": "addressline1",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.addressline1"
        }
      ]
    },
    "addressline2": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.addressline2",
      "sources": [
        {
          "table": "customers_final",
          "column": "addressline2",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.addressline2"
        }
      ]
    },
    "postalcode": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.postalcode",
      "sources": [
        {
          "table": "customers_final",
          "column": "postalcode",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.postalcode"
        }
      ]
    },
    "city": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.city",
      "sources": [
        {
          "table": "customers_final",
          "column": "city",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.city"
        }
      ]
    },
    "stateprov": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.stateprov",
      "sources": [
        {
          "table": "customers_final",
          "column": "stateprov",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.stateprov"
        }
      ]
    },
    "country": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.country",
      "sources": [
        {
          "table": "customers_final",
          "column": "country",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.country"
        }
      ]
    },
    "phone1": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone1",
      "sources": [
        {
          "table": "customers_final",
          "column": "phone1",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.phone1"
        }
      ]
    },
    "phone2": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone2",
      "sources": [
        {
          "table": "customers_final",
          "column": "phone2",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.phone2"
        }
      ]
    },
    "phone3": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone3",
      "sources": [
        {
          "table": "customers_final",
          "column": "phone3",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.phone3"
        }
      ]
    },
    "email1": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.email1",
      "sources": [
        {
          "table": "customers_final",
          "column": "email1",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.email1"
        }
      ]
    },
    "email2": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.email2",
      "sources": [
        {
          "table": "customers_final",
          "column": "email2",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.email2"
        }
      ]
    },
    "nationaltaxratedesc": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "r_nat.TX_NAME",
      "sources": [
        {
          "table": "wh_db.TaxRate",
          "column": "TX_NAME",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "r_nat.TX_NAME"
        }
      ]
    },
    "nationaltaxrate": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "r_nat.TX_RATE",
      "sources": [
        {
          "table": "wh_db.TaxRate",
          "column": "TX_RATE",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "r_nat.TX_RATE"
        }
      ]
    },
    "localtaxratedesc": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "r_lcl.TX_NAME",
      "sources": [
        {
          "table": "wh_db.TaxRate",
          "column": "TX_NAME",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "r_lcl.TX_NAME"
        }
      ]
    },
    "localtaxrate": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "r_lcl.TX_RATE",
      "sources": [
        {
          "table": "wh_db.TaxRate",
          "column": "TX_RATE",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "r_lcl.TX_RATE"
        }
      ]
    },
    "agencyid": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.agencyid",
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "agencyid",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "p.agencyid"
        }
      ]
    },
    "creditrating": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.creditrating",
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "creditrating",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "p.creditrating"
        }
      ]
    },
    "networth": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.networth",
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "networth",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "p.networth"
        }
      ]
    },
    "marketingnameplate": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.marketingnameplate",
      "sources": [
        {
          "table": "wh_db_stage.ProspectIncremental",
          "column": "marketingnameplate",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "p.marketingnameplate"
        }
      ]
    },
    "iscurrent": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.iscurrent",
      "sources": [
        {
          "table": "customers_final",
          "column": "iscurrent",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.iscurrent"
        }
      ]
    },
    "batchid": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.batchid",
      "sources": [
        {
          "table": "customers_final",
          "column": "batchid",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.batchid"
        }
      ]
    },
    "effectivedate": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.effectivedate",
      "sources": [
        {
          "table": "customers_final",
          "column": "effectivedate",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.effectivedate"
        }
      ]
    },
    "enddate": {
      "path": [
        "CustomerData"
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.enddate",
      "sources": [
        {
          "table": "customers_final",
          "column": "enddate",
          "role": "SOURCE",
          "transformation_type": "RENAME",
          "transformation_logic": "c.enddate"
        }
      ]
    }
  }
}
```
2025-04-11 18:04:23,814 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:04:32,389 - INFO - AFC remote call 1 is done.
2025-04-11 18:04:32,406 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.ProspectIncremental",
  "sources_summary": {
    "temp_propect_marketingnameplate": [
      "agencyid",
      "lastname",
      "firstname",
      "middleinitial",
      "gender",
      "addressline1",
      "addressline2",
      "postalcode",
      "city",
      "state",
      "country",
      "phone",
      "income",
      "numbercars",
      "numberchildren",
      "maritalstatus",
      "age",
      "creditrating",
      "ownorrentflag",
      "employer",
      "numbercreditcards",
      "networth",
      "marketingnameplate",
      "batchid"
    ]
  },
  "lineage": {
    "agencyid": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.agencyid"
      ],
      "transformation_logic": "tp.agencyid",
      "transformation_type": "RENAME"
    },
    "lastname": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.lastname"
      ],
      "transformation_logic": "tp.lastname",
      "transformation_type": "RENAME"
    },
    "firstname": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.firstname"
      ],
      "transformation_logic": "tp.firstname",
      "transformation_type": "RENAME"
    },
    "middleinitial": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.middleinitial"
      ],
      "transformation_logic": "tp.middleinitial",
      "transformation_type": "RENAME"
    },
    "gender": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.gender"
      ],
      "transformation_logic": "tp.gender",
      "transformation_type": "RENAME"
    },
    "addressline1": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.addressline1"
      ],
      "transformation_logic": "tp.addressline1",
      "transformation_type": "RENAME"
    },
    "addressline2": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.addressline2"
      ],
      "transformation_logic": "tp.addressline2",
      "transformation_type": "RENAME"
    },
    "postalcode": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.postalcode"
      ],
      "transformation_logic": "tp.postalcode",
      "transformation_type": "RENAME"
    },
    "city": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.city"
      ],
      "transformation_logic": "tp.city",
      "transformation_type": "RENAME"
    },
    "state": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.state"
      ],
      "transformation_logic": "tp.state",
      "transformation_type": "RENAME"
    },
    "country": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.country"
      ],
      "transformation_logic": "tp.country",
      "transformation_type": "RENAME"
    },
    "phone": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.phone"
      ],
      "transformation_logic": "tp.phone",
      "transformation_type": "RENAME"
    },
    "income": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.income"
      ],
      "transformation_logic": "tp.income",
      "transformation_type": "RENAME"
    },
    "numbercars": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.numbercars"
      ],
      "transformation_logic": "tp.numbercars",
      "transformation_type": "RENAME"
    },
    "numberchildren": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.numberchildren"
      ],
      "transformation_logic": "tp.numberchildren",
      "transformation_type": "RENAME"
    },
    "maritalstatus": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.maritalstatus"
      ],
      "transformation_logic": "tp.maritalstatus",
      "transformation_type": "RENAME"
    },
    "age": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.age"
      ],
      "transformation_logic": "tp.age",
      "transformation_type": "RENAME"
    },
    "creditrating": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.creditrating"
      ],
      "transformation_logic": "tp.creditrating",
      "transformation_type": "RENAME"
    },
    "ownorrentflag": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.ownorrentflag"
      ],
      "transformation_logic": "tp.ownorrentflag",
      "transformation_type": "RENAME"
    },
    "employer": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.employer"
      ],
      "transformation_logic": "tp.employer",
      "transformation_type": "RENAME"
    },
    "numbercreditcards": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.numbercreditcards"
      ],
      "transformation_logic": "tp.numbercreditcards",
      "transformation_type": "RENAME"
    },
    "networth": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.networth"
      ],
      "transformation_logic": "tp.networth",
      "transformation_type": "RENAME"
    },
    "marketingnameplate": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.marketingnameplate"
      ],
      "transformation_logic": "tp.marketingnameplate",
      "transformation_type": "RENAME"
    },
    "recordbatchid": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.batchid"
      ],
      "transformation_logic": "tp.batchid",
      "transformation_type": "RENAME"
    },
    "batchid": {
      "path": [
        "tp"
      ],
      "source_columns": [
        "temp_propect_marketingnameplate.batchid"
      ],
      "transformation_logic": "tp.batchid",
      "transformation_type": "RENAME"
    }
  }
}
```
2025-04-11 18:04:37,409 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:04:45,254 - INFO - AFC remote call 1 is done.
2025-04-11 18:04:45,262 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_broker",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False)",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "employeeid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid"
    },
    "managerid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).managerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "managerid"
    },
    "employeefirstname": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeefirstname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeefirstname"
    },
    "employeelastname": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeelastname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeelastname"
    },
    "employeemi": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeemi",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeemi"
    },
    "employeejobcode": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeejobcode",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeejobcode"
    },
    "employeebranch": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeebranch",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeebranch"
    },
    "employeeoffice": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeeoffice",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeoffice"
    },
    "employeephone": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HR.csv', delim=',', columns={'employeeid': 'BIGINT', 'managerid': 'BIGINT', 'employeefirstname': 'STRING', 'employeelastname': 'STRING', 'employeemi': 'STRING', 'employeejobcode': 'STRING', 'employeebranch': 'STRING', 'employeeoffice': 'STRING', 'employeephone': 'STRING'}, header=False).employeephone",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeephone"
    }
  }
}
```
2025-04-11 18:04:50,265 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:04:58,194 - INFO - AFC remote call 1 is done.
2025-04-11 18:04:58,214 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimAccount",
  "sources_summary": [
    {"type": "TABLE", "name": "wh_db_stage.CustomerMgmt", "alias_or_cte": "account"},
    {"type": "TABLE", "name": "wh_db.DimCustomer", "alias_or_cte": "c"},
    {"type": "TABLE", "name": "wh_db.DimBroker", "alias_or_cte": "b"}
  ],
  "lineage": {
    "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)": {
      "sources": [
        {"source_identifier": "wh_db_stage.CustomerMgmt.update_ts", "path": ["account.update_ts", "account_final.update_ts", "account_cust_updates.effectivedate", "a.effectivedate"], "role": "Date part source"},
        {"source_identifier": "wh_db_stage.CustomerMgmt.accountid", "path": ["account.accountid", "account_final.accountid", "account_cust_updates.accountid", "a.accountid"], "role": "ID part source"}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(a.effectivedate, '%Y%m%d') || a.accountid AS BIGINT)"
    },
    "accountid": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.accountid", "path": ["account.accountid", "account_final.accountid", "account_cust_updates.accountid", "a.accountid"]}],
      "transformation_type": "RENAME",
      "transformation_logic": "a.accountid"
    },
    "sk_brokerid": {
      "sources": [
        {"source_identifier": "wh_db_stage.CustomerMgmt.brokerid", "path": ["account.brokerid", "account_final.brokerid", "account_cust_updates.brokerid", "a.brokerid"],
         "join_info": {
            "type": "INNER JOIN",
            "left_source": {"identifier": "wh_db_stage.CustomerMgmt.brokerid", "path": ["account.brokerid", "account_final.brokerid", "account_cust_updates.brokerid", "a.brokerid"]},
            "right_source": {"identifier": "wh_db.DimBroker.brokerid"}
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "b.sk_brokerid via JOIN ON a.brokerid = b.brokerid"
    },
    "sk_customerid": {
      "sources": [{"source_identifier": "wh_db.DimCustomer.sk_customerid", "path": ["account_cust_updates.sk_customerid", "a.sk_customerid"]}],
      "transformation_type": "RENAME",
      "transformation_logic": "a.sk_customerid"
    },
    "accountdesc": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.accountdesc", "path": ["account.accountdesc", "account_final.accountdesc", "account_cust_updates.accountdesc", "a.accountdesc"]}],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(accountdesc, last_value(accountdesc) OVER w)",
      "notes": "Imputes missing values using last_value window function"
    },
    "TaxStatus": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.taxstatus", "path": ["account.taxstatus", "account_final.taxstatus", "account_cust_updates.TaxStatus", "a.TaxStatus"]}],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(taxstatus, last_value(taxstatus) OVER w)",
      "notes": "Imputes missing values using last_value window function"
    },
    "status": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.status", "path": ["account.status", "account_final.status", "account_cust_updates.status", "a.status"]}],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(status, last_value(status) OVER w)",
      "notes": "Imputes missing values using last_value window function"
    },
    "iscurrent": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.update_ts", "path": ["account.update_ts", "account_final.update_ts", "account_cust_updates.enddate", "a.enddate"]}],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN a.enddate = '9999-12-31'::DATE THEN true ELSE false END"
    },
    "batchid": {
      "sources": [{"source_identifier": "wh_db_stage.CustomerMgmt.batchid", "path": ["account.batchid", "account_final.batchid", "account_cust_updates.batchid", "a.batchid"]}],
      "transformation_type": "RENAME",
      "transformation_logic": "a.batchid"
    },
    "effectivedate": {
      "sources": [
        {"source_identifier": "wh_db_stage.CustomerMgmt.update_ts", "path": ["account.update_ts", "account_final.effectivedate", "account_cust_updates.effectivedate", "a.effectivedate"]},
        {"source_identifier": "wh_db.DimCustomer.effectivedate", "path": ["c.effectivedate", "account_cust_updates.effectivedate", "a.effectivedate"]}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "if(a.effectivedate < c.effectivedate, c.effectivedate, a.effectivedate)"
    },
    "enddate": {
      "sources": [
        {"source_identifier": "wh_db_stage.CustomerMgmt.update_ts", "path": ["account.update_ts", "account_final.enddate", "account_cust_updates.enddate", "a.enddate"]},
        {"source_identifier": "wh_db.DimCustomer.enddate", "path": ["c.enddate", "account_cust_updates.enddate", "a.enddate"]}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "if(a.enddate > c.enddate, c.enddate, a.enddate)"
    }
  }
}
```
2025-04-11 18:05:03,217 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:05:08,378 - INFO - AFC remote call 1 is done.
2025-04-11 18:05:08,386 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimBroker",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "temp_broker",
      "alias_or_cte": null
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimDate",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "sk_brokerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid AS sk_brokerid"
    },
    "brokerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid AS brokerid"
    },
    "managerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.managerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "managerid"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeefirstname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeefirstname AS firstname"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeelastname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeelastname AS lastname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeemi",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeemi AS middleinitial"
    },
    "branch": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeebranch",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeebranch AS branch"
    },
    "office": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeoffice",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeoffice AS office"
    },
    "phone": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeephone",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeephone AS phone"
    },
    "iscurrent": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "true"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_db.DimDate.datevalue",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "AGGREGATION",
      "transformation_logic": "(SELECT min(datevalue::DATE) as effectivedate FROM wh_db.DimDate)"
    },
    "enddate": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "'9999-12-31'::DATE"
    }
  }
}
```
2025-04-11 18:05:13,395 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:05:24,154 - INFO - AFC remote call 1 is done.
2025-04-11 18:05:24,164 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimCompany",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_db_stage.FinWire",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh_db.industry",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_companyid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.recdate",
          "path": [
            "cmp.recdate",
            "effectivedate"
          ],
          "role": "Date part source"
        },
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.CIK",
            "companyid"
          ],
          "role": "ID part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)"
    },
    "companyid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.CIK"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cik AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.Status"
          ]
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.CompanyName"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "CompanyName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh_db.industry.in_name",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "cmp.IndustryID"
              ]
            },
            "right_source": {
              "identifier": "wh_db.industry.in_id"
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.industryid = ind.in_id"
    },
    "sprating": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.SPrating"
          ]
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END"
    },
    "islowgrade": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.SPrating"
          ]
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END"
    },
    "ceo": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.CEOname"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "CEOname AS ceo"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.AddrLine1"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "AddrLine1 AS addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.AddrLine2"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "AddrLine2 AS addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.PostalCode"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "PostalCode AS postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.City"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "City AS city"
    },
    "stateprov": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.StateProvince"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "StateProvince AS stateprov"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.Country"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "Country AS country"
    },
    "description": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.Description"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "Description AS description"
    },
    "foundingdate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.FoundingDate"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "FoundingDate AS foundingdate"
    },
    "iscurrent": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.recdate",
          "path": [
            "cmp.recdate",
            "enddate"
          ],
          "role": "Input for comparison"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.recdate",
          "path": [
            "cmp.recdate"
          ]
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "recdate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.recdate",
          "path": [
            "cmp.recdate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:05:29,166 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:05:38,585 - INFO - AFC remote call 1 is done.
2025-04-11 18:05:38,585 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "customers",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_db_stage.CustomerMgmt",
      "alias_or_cte": "c"
    }
  ],
  "lineage": {
    "customerid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.customerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "customerid"
    },
    "taxid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.taxid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "taxid"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.status",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "status"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.lastname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "lastname"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.firstname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "firstname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.middleinitial",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "middleinitial"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.gender",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "gender"
    },
    "tier": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.tier",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tier"
    },
    "dob": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.dob",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "dob"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.addressline1",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.addressline2",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.postalcode",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.city",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "city"
    },
    "stateprov": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.stateprov",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "stateprov"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.country",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "country"
    },
    "phone1": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.phone1",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "phone1"
    },
    "phone2": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.phone2",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "phone2"
    },
    "phone3": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.phone3",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "phone3"
    },
    "email1": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.email1",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "email1"
    },
    "email2": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.email2",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "email2"
    },
    "lcl_tx_id": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.lcl_tx_id",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "lcl_tx_id"
    },
    "nat_tx_id": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.nat_tx_id",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "nat_tx_id"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    },
    "update_ts": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.CustomerMgmt.update_ts",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "update_ts"
    }
  }
}
```
2025-04-11 18:05:43,602 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:05:48,795 - INFO - AFC remote call 1 is done.
2025-04-11 18:05:48,804 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh.DimComp",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_stg.FW",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh.Ind",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate",
            "T.effectivedate"
          ],
          "role": "Date part source"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK",
            "T.compid"
          ],
          "role": "ID part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT)"
    },
    "compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cmp.CIK AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.Status"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CompName"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.CompName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh.Ind.in_name",
          "path": [],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_stg.FW.value",
              "path": [
                "cmp.IndID"
              ]
            },
            "right_source": {
              "identifier": "wh.Ind.in_id"
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.IndID = ind.in_id"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.RecDate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate), '9999-12-31'::DATE)",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:05:53,809 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:06:08,338 - INFO - AFC remote call 1 is done.
2025-04-11 18:06:08,354 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimSecurity",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_db_stage.FinWire",
      "alias_or_cte": "SEC"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimCompany",
      "alias_or_cte": "dc"
    }
  ],
  "lineage": {
    "sk_securityid": {
      "sources": [],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "ROW_NUMBER() OVER ()",
      "notes": "Surrogate Key Generation"
    },
    "Symbol": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.Symbol",
            "SEC_prep.Symbol",
            "SEC_final.Symbol"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.Symbol"
    },
    "issue": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.issue",
            "SEC_prep.issue",
            "SEC_final.issue"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.issue"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.Status",
            "SEC_prep.status",
            "SEC_final.status"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "SEC_final.status"
    },
    "Name": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.Name",
            "SEC_prep.Name",
            "SEC_final.Name"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.Name"
    },
    "exchangeid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.exchangeid",
            "SEC_prep.exchangeid",
            "SEC_final.exchangeid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.exchangeid"
    },
    "sk_companyid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimCompany.sk_companyid",
          "path": [
            "dc.sk_companyid",
            "SEC_final.sk_companyid"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.name",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        },
        {
          "source_identifier": "wh_db.DimCompany.sk_companyid",
          "path": [
            "dc.sk_companyid",
            "SEC_final.sk_companyid"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.companyid",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dc.sk_companyid via JOIN ON SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
    },
    "sharesoutstanding": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.sharesoutstanding",
            "SEC_prep.sharesoutstanding",
            "SEC_final.sharesoutstanding"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.sharesoutstanding"
    },
    "firsttrade": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.firsttrade",
            "SEC_prep.firsttrade",
            "SEC_final.firsttrade"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.firsttrade"
    },
    "firsttradeonexchange": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.firsttradeonexchange",
            "SEC_prep.firsttradeonexchange",
            "SEC_final.firsttradeonexchange"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.firsttradeonexchange"
    },
    "Dividend": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.Dividend",
            "SEC_prep.Dividend",
            "SEC_final.Dividend"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "SEC_final.Dividend"
    },
    "iscurrent": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.effectivedate",
            "SEC_prep.effectivedate",
            "SEC_final.enddate"
          ],
          "role": "Input for CASE WHEN"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.effectivedate",
            "SEC_prep.effectivedate",
            "SEC_final.effectivedate"
          ],
          "role": "direct input"
        },
        {
          "source_identifier": "wh_db.DimCompany.EffectiveDate",
          "path": [
            "dc.EffectiveDate",
            "SEC_final.effectivedate"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.name",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        },
        {
          "source_identifier": "wh_db.DimCompany.EffectiveDate",
          "path": [
            "dc.EffectiveDate",
            "SEC_final.effectivedate"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.companyid",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN SEC.effectivedate < dc.EffectiveDate THEN dc.EffectiveDate ELSE SEC.effectivedate END"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.effectivedate",
            "SEC_prep.enddate",
            "SEC_final.enddate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "SEC.Symbol",
            "SEC_prep.Symbol"
          ],
          "role": "Partition key for LEAD"
        },
        {
          "source_identifier": "wh_db.DimCompany.EndDate",
          "path": [
            "dc.EndDate",
            "SEC_final.enddate"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.name",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        },
        {
          "source_identifier": "wh_db.DimCompany.EndDate",
          "path": [
            "dc.EndDate",
            "SEC_final.enddate"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.value",
              "path": [
                "SEC.conameorcik",
                "SEC_prep.conameorcik"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.companyid",
              "path": [
                "dc.conameorcik"
              ]
            },
            "join_condition": "SEC.conameorcik = dc.conameorcik AND SEC.effectivedate < dc.EndDate AND SEC.enddate > dc.EffectiveDate"
          }
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN SEC.enddate > dc.EndDate THEN dc.EndDate ELSE SEC.enddate END",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:06:13,361 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:06:18,707 - INFO - AFC remote call 1 is done.
2025-04-11 18:06:18,707 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh.DimComp",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_stg.FW",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh.Ind",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate",
            "T.effectivedate"
          ],
          "role": "Date part source"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK",
            "T.compid"
          ],
          "role": "ID part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT)"
    },
    "compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cmp.CIK AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.Status"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CompName"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.CompName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh.Ind.in_name",
          "path": [
            "ind.in_name"
          ],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_stg.FW.value",
              "path": [
                "cmp.IndID"
              ]
            },
            "right_source": {
              "identifier": "wh.Ind.in_id"
            },
            "join_condition": "cmp.IndID = ind.in_id"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.IndID = ind.in_id"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.RecDate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate), '9999-12-31'::DATE)",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:06:23,720 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:06:36,238 - INFO - AFC remote call 1 is done.
2025-04-11 18:06:36,260 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimTrade",
  "sources_summary": [
    {"type": "TABLE", "name": "wh_db_stage.tradetxt", "alias_or_cte": "a"},
    {"type": "TABLE", "name": "wh_db_stage.tradehistory", "alias_or_cte": "b"},
    {"type": "TABLE", "name": "wh_db.StatusType", "alias_or_cte": "c"},
    {"type": "TABLE", "name": "wh_db.DimSecurity", "alias_or_cte": "ds"},
    {"type": "TABLE", "name": "wh_db.DimAccount", "alias_or_cte": "da"},
    {"type": "CTE", "name": "tradehistorical", "alias_or_cte": "trade"}
  ],
  "lineage": {
    "tradeid": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.tradeid", "path": ["tradehistorical.tradeid"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.tradeid"
    },
    "sk_brokerid": {
      "sources": [
        {"source_identifier": "wh_db.DimAccount.sk_brokerid", "path": ["da.sk_brokerid"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "da.sk_brokerid"
    },
    "sk_createdateid": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradehistory.TH_DTS", "path": ["tradehistorical.SK_CreateDateID"], "role": "Date part source"},
        {"source_identifier": "wh_db.DimAccount.accountid", "path": ["da.accountid"], "role": "ID part source"},
        {"source_identifier": "wh_db.DimAccount.sk_brokerid", "path": ["da.sk_brokerid"], "role": "ID part source"}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CreateDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
    },
    "sk_createtimeid": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradehistory.TH_DTS", "path": ["tradehistorical.SK_CreateTimeID"], "role": "Date part source"},
        {"source_identifier": "wh_db.DimAccount.accountid", "path": ["da.accountid"], "role": "ID part source"},
        {"source_identifier": "wh_db.DimAccount.sk_brokerid", "path": ["da.sk_brokerid"], "role": "ID part source"}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CreateTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
    },
    "sk_closedateid": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradehistory.TH_DTS", "path": ["tradehistorical.SK_CloseDateID"], "role": "Date part source"},
        {"source_identifier": "wh_db.DimAccount.accountid", "path": ["da.accountid"], "role": "ID part source"},
        {"source_identifier": "wh_db.DimAccount.sk_brokerid", "path": ["da.sk_brokerid"], "role": "ID part source"}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CloseDateID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
    },
    "sk_closetimeid": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradehistory.TH_DTS", "path": ["tradehistorical.SK_CloseTimeID"], "role": "Date part source"},
        {"source_identifier": "wh_db.DimAccount.accountid", "path": ["da.accountid"], "role": "ID part source"},
        {"source_identifier": "wh_db.DimAccount.sk_brokerid", "path": ["da.sk_brokerid"], "role": "ID part source"}
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(trade.SK_CloseTimeID, '%Y%m%d') || da.accountid || da.sk_brokerid AS BIGINT)"
    },
    "st_name": {
      "sources": [
        {"source_identifier": "wh_db.StatusType.st_name", "path": ["tradehistorical.st_name"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.st_name"
    },
    "type": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.t_tt_id", "path": ["tradehistorical.type"]}
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE t_tt_id WHEN 'TMB' THEN 'Market Buy' WHEN 'TMS' THEN 'Market Sell' WHEN 'TSL' THEN 'Stop Loss' WHEN 'TLS' THEN 'Limit Sell' WHEN 'TLB' THEN 'Limit Buy' ELSE NULL END"
    },
    "cashflag": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.cashflag", "path": ["tradehistorical.cashflag"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.cashflag"
    },
    "sk_securityid": {
      "sources": [
        {"source_identifier": "wh_db.DimSecurity.sk_securityid", "path": ["ds.sk_securityid"],
         "join_info": {
            "type": "INNER JOIN",
            "left_source": {"identifier": "wh_db_stage.tradetxt.t_s_symb", "path": ["tradehistorical.t_s_symb"]},
            "right_source": {"identifier": "wh_db.DimSecurity.symbol"}
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ds.sk_securityid via JOIN ON ds.symbol = trade.t_s_symb"
    },
    "sk_companyid": {
      "sources": [
        {"source_identifier": "wh_db.DimSecurity.sk_companyid", "path": ["ds.sk_companyid"],
         "join_info": {
            "type": "INNER JOIN",
            "left_source": {"identifier": "wh_db_stage.tradetxt.t_s_symb", "path": ["tradehistorical.t_s_symb"]},
            "right_source": {"identifier": "wh_db.DimSecurity.symbol"}
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ds.sk_companyid via JOIN ON ds.symbol = trade.t_s_symb"
    },
    "quantity": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.quantity", "path": ["tradehistorical.quantity"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.quantity"
    },
    "bidprice": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.bidprice", "path": ["tradehistorical.bidprice"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.bidprice"
    },
    "sk_customerid": {
      "sources": [
        {"source_identifier": "wh_db.DimAccount.sk_customerid", "path": ["da.sk_customerid"],
         "join_info": {
            "type": "INNER JOIN",
            "left_source": {"identifier": "wh_db_stage.tradetxt.t_ca_id", "path": ["tradehistorical.t_ca_id"]},
            "right_source": {"identifier": "wh_db.DimAccount.accountid"}
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "da.sk_customerid via JOIN ON trade.t_ca_id = da.accountid"
    },
    "sk_accountid": {
      "sources": [
        {"source_identifier": "wh_db.DimAccount.sk_accountid", "path": ["da.sk_accountid"],
         "join_info": {
            "type": "INNER JOIN",
            "left_source": {"identifier": "wh_db_stage.tradetxt.t_ca_id", "path": ["tradehistorical.t_ca_id"]},
            "right_source": {"identifier": "wh_db.DimAccount.accountid"}
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "da.sk_accountid via JOIN ON trade.t_ca_id = da.accountid"
    },
    "executedby": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.executedby", "path": ["tradehistorical.executedby"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.executedby"
    },
    "tradeprice": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.tradeprice", "path": ["tradehistorical.tradeprice"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.tradeprice"
    },
    "fee": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.fee", "path": ["tradehistorical.fee"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.fee"
    },
    "commission": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.commission", "path": ["tradehistorical.commission"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.commission"
    },
    "tax": {
      "sources": [
        {"source_identifier": "wh_db_stage.tradetxt.tax", "path": ["tradehistorical.tax"]}
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "trade.tax"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    }
  }
}
```
2025-04-11 18:06:41,266 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:06:45,935 - INFO - AFC remote call 1 is done.
2025-04-11 18:06:45,943 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactCashBalances",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv('src/data/Batch1\\CashTransaction.txt', HEADER=FALSE, columns={'accountid': 'BIGINT', 'ct_dts': 'TIMESTAMP', 'ct_amt': 'DOUBLE', 'ct_name': 'VARCHAR'})",
      "alias_or_cte": "historical"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimAccount",
      "alias_or_cte": "a"
    }
  ],
  "lineage": {
    "sk_customerid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimAccount.sk_customerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "a.sk_customerid"
    },
    "sk_accountid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimAccount.sk_accountid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "a.sk_accountid"
    },
    "sk_dateid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\CashTransaction.txt', HEADER=FALSE, columns={'accountid': 'BIGINT', 'ct_dts': 'TIMESTAMP', 'ct_amt': 'DOUBLE', 'ct_name': 'VARCHAR'}).ct_dts",
          "path": [
            "historical.datevalue"
          ],
          "role": "date source"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(STRFTIME(datevalue, '%Y%m%d') AS BIGINT)"
    },
    "cash": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\CashTransaction.txt', HEADER=FALSE, columns={'accountid': 'BIGINT', 'ct_dts': 'TIMESTAMP', 'ct_amt': 'DOUBLE', 'ct_name': 'VARCHAR'}).ct_amt",
          "path": [
            "historical.account_daily_total"
          ],
          "role": "input for SUM"
        },
        {
          "source_identifier": "read_csv('src/data/Batch1\\CashTransaction.txt', HEADER=FALSE, columns={'accountid': 'BIGINT', 'ct_dts': 'TIMESTAMP', 'ct_amt': 'DOUBLE', 'ct_name': 'VARCHAR'}).accountid",
          "path": [
            "historical.accountid"
          ],
          "role": "partition key"
        },
        {
          "source_identifier": "read_csv('src/data/Batch1\\CashTransaction.txt', HEADER=FALSE, columns={'accountid': 'BIGINT', 'ct_dts': 'TIMESTAMP', 'ct_amt': 'DOUBLE', 'ct_name': 'VARCHAR'}).ct_dts",
          "path": [
            "historical.datevalue"
          ],
          "role": "order by key"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "SUM(account_daily_total) OVER (PARTITION BY c.accountid ORDER BY datevalue)"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "historical.batchid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.batchid"
    }
  }
}
```
2025-04-11 18:06:50,946 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:07:01,968 - INFO - AFC remote call 1 is done.
2025-04-11 18:07:01,982 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactHoldings",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'})",
      "alias_or_cte": "Holdings"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimTrade",
      "alias_or_cte": "dt"
    }
  ],
  "lineage": {
    "tradeid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_h_t_id",
          "path": [
            "h.hh_h_t_id"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "hh_h_t_id tradeid"
    },
    "currenttradeid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "hh_t_id currenttradeid"
    },
    "sk_customerid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_customerid",
          "path": [
            "dt.sk_customerid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dt.sk_customerid via JOIN ON tradeid = hh_t_id",
      "join_info": {
        "type": "INNER JOIN",
        "left_source": {
          "identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ]
        },
        "right_source": {
          "identifier": "wh_db.DimTrade.tradeid"
        }
      }
    },
    "sk_accountid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_accountid",
          "path": [
            "dt.sk_accountid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dt.sk_accountid via JOIN ON tradeid = hh_t_id",
      "join_info": {
        "type": "INNER JOIN",
        "left_source": {
          "identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ]
        },
        "right_source": {
          "identifier": "wh_db.DimTrade.tradeid"
        }
      }
    },
    "sk_securityid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_securityid",
          "path": [
            "dt.sk_securityid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dt.sk_securityid via JOIN ON tradeid = hh_t_id",
      "join_info": {
        "type": "INNER JOIN",
        "left_source": {
          "identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ]
        },
        "right_source": {
          "identifier": "wh_db.DimTrade.tradeid"
        }
      }
    },
    "sk_companyid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_companyid",
          "path": [
            "dt.sk_companyid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dt.sk_companyid via JOIN ON tradeid = hh_t_id",
      "join_info": {
        "type": "INNER JOIN",
        "left_source": {
          "identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ]
        },
        "right_source": {
          "identifier": "wh_db.DimTrade.tradeid"
        }
      }
    },
    "sk_dateid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_closedateid",
          "path": [
            "dt.sk_closedateid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "sk_closedateid sk_dateid"
    },
    "sk_timeid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.sk_closetimeid",
          "path": [
            "dt.sk_closetimeid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "sk_closetimeid sk_timeid"
    },
    "currentprice": {
      "sources": [
        {
          "source_identifier": "wh_db.DimTrade.tradeprice",
          "path": [
            "dt.tradeprice"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dt.tradeprice via JOIN ON tradeid = hh_t_id",
      "join_info": {
        "type": "INNER JOIN",
        "left_source": {
          "identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_t_id",
          "path": [
            "h.hh_t_id"
          ]
        },
        "right_source": {
          "identifier": "wh_db.DimTrade.tradeid"
        }
      }
    },
    "currentholding": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\HoldingHistory.txt', HEADER=FALSE, columns={'hh_h_t_id': 'INTEGER', 'hh_t_id': 'INTEGER', 'hh_before_qty': 'INTEGER', 'hh_after_qty': 'INTEGER'}).hh_after_qty",
          "path": [
            "h.hh_after_qty"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "hh_after_qty currentholding"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "Holdings.batchid",
          "path": [
            "h.batchid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "h.batchid"
    }
  }
}
```
2025-04-11 18:07:06,990 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:07:12,087 - INFO - AFC remote call 1 is done.
2025-04-11 18:07:12,103 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.FactWatches",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'})",
      "alias_or_cte": "watchhistory"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimSecurity",
      "alias_or_cte": "s"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimCustomer",
      "alias_or_cte": "c"
    }
  ],
  "lineage": {
    "sk_customerid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimCustomer.sk_customerid",
          "path": [
            "c.sk_customerid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.sk_customerid"
    },
    "sk_securityid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimSecurity.sk_securityid",
          "path": [
            "s.sk_securityid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "s.sk_securityid"
    },
    "sk_dateid_dateplaced": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_dts",
          "path": [
            "watchhistory.w_dts",
            "watches.dateplaced"
          ],
          "role": "date source"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(strftime(dateplaced, '%Y%m%d') AS BIGINT)"
    },
    "sk_dateid_dateremoved": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_dts",
          "path": [
            "watchhistory.w_dts",
            "watches.dateremoved"
          ],
          "role": "date source"
        },
        {
          "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).w_action",
          "path": [
            "watchhistory.w_action",
            "watches.dateremoved"
          ],
          "role": "condition"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(strftime(dateremoved, '%Y%m%d') AS BIGINT)"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "read_csv('src/data/Batch1\\WatchHistory.txt', HEADER=FALSE, columns={'w_c_id': 'BIGINT', 'w_s_symb': 'VARCHAR', 'w_dts': 'TIMESTAMP', 'w_action': 'VARCHAR'}).*",
          "path": [
            "watchhistory.*",
            "watches.batchid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "wh.batchid"
    }
  }
}
```
2025-04-11 18:07:17,108 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:07:27,513 - INFO - AFC remote call 1 is done.
2025-04-11 18:07:27,528 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.Financial",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_db_stage.FinWire",
      "alias_or_cte": "finwire_parsed"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimCompany",
      "alias_or_cte": "dc"
    }
  ],
  "lineage": {
    "sk_companyid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimCompany.sk_companyid",
          "role": "output",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.recdate",
              "path": [
                "fp.recdate"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.effectivedate"
            }
          }
        },
        {
          "source_identifier": "wh_db_stage.FinWire.recdate",
          "role": "output",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.recdate",
              "path": [
                "fp.recdate"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.enddate"
            }
          }
        },
        {
          "source_identifier": "wh_db_stage.FinWire.company_id_text",
          "role": "output",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.company_id_text",
              "path": [
                "fp.company_id_text"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.companyid"
            }
          }
        },
        {
          "source_identifier": "wh_db_stage.FinWire.company_name",
          "role": "output",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_db_stage.FinWire.company_name",
              "path": [
                "fp.company_name"
              ]
            },
            "right_source": {
              "identifier": "wh_db.DimCompany.name"
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "dc.sk_companyid via JOIN ON (fp.recdate >= dc.effectivedate AND fp.recdate < dc.enddate AND ((fp.company_id_text IS NOT NULL AND fp.company_id_text = dc.companyid::TEXT) OR (fp.company_name IS NOT NULL AND fp.company_name = dc.name)))"
    },
    "fi_year": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_year",
            "fp.fi_year"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 1 FOR 4) AS INTEGER)"
    },
    "fi_qtr": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_qtr",
            "fp.fi_qtr"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 5 FOR 1) AS INTEGER)"
    },
    "fi_qtr_start_date": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_qtr_start_date",
            "fp.fi_qtr_start_date"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "strptime(SUBSTRING(value FROM 6 FOR 8), '%Y%m%d')::DATE"
    },
    "fi_revenue": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_revenue",
            "fp.fi_revenue"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 22 FOR 17) AS DOUBLE)"
    },
    "fi_net_earn": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_net_earn",
            "fp.fi_net_earn"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 39 FOR 17) AS DOUBLE)"
    },
    "fi_basic_eps": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_basic_eps",
            "fp.fi_basic_eps"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 56 FOR 12) AS DOUBLE)"
    },
    "fi_dilut_eps": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_dilut_eps",
            "fp.fi_dilut_eps"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 68 FOR 12) AS DOUBLE)"
    },
    "fi_margin": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_margin",
            "fp.fi_margin"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 80 FOR 12) AS DOUBLE)"
    },
    "fi_inventory": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_inventory",
            "fp.fi_inventory"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 92 FOR 17) AS DOUBLE)"
    },
    "fi_assets": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_assets",
            "fp.fi_assets"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 109 FOR 17) AS DOUBLE)"
    },
    "fi_liability": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_liability",
            "fp.fi_liability"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 126 FOR 17) AS DOUBLE)"
    },
    "fi_out_basic": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_out_basic",
            "fp.fi_out_basic"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 143 FOR 13) AS BIGINT)"
    },
    "fi_out_dilut": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.FinWire.value",
          "path": [
            "finwire_parsed.fi_out_dilut",
            "fp.fi_out_dilut"
          ]
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(SUBSTRING(value FROM 156 FOR 13) AS BIGINT)"
    }
  }
}
```
2025-04-11 18:07:32,535 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:07:45,043 - INFO - AFC remote call 1 is done.
2025-04-11 18:07:45,059 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.Prospect",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_db_stage.ProspectIncremental",
      "alias_or_cte": "p"
    },
    {
      "type": "TABLE",
      "name": "wh_db.BatchDate",
      "alias_or_cte": "recdate"
    },
    {
      "type": "TABLE",
      "name": "wh_db.BatchDate",
      "alias_or_cte": "origdate"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimCustomer",
      "alias_or_cte": "cust"
    }
  ],
  "lineage": {
    "agencyid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.agencyid",
          "path": [
            "p.agencyid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.agencyid"
    },
    "sk_recorddateid": {
      "sources": [
        {
          "source_identifier": "wh_db.BatchDate.batchdate",
          "path": [
            "recdate.batchdate"
          ],
          "role": "date source"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(STRFTIME(recdate.batchdate, '%Y%m%d') AS BIGINT)"
    },
    "sk_updatedateid": {
      "sources": [
        {
          "source_identifier": "wh_db.BatchDate.batchdate",
          "path": [
            "origdate.batchdate"
          ],
          "role": "date source"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(STRFTIME(origdate.batchdate, '%Y%m%d') AS BIGINT)"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.batchid",
          "path": [
            "p.batchid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.batchid"
    },
    "iscustomer": {
      "sources": [
        {
          "source_identifier": "wh_db.DimCustomer.LastName",
          "path": [
            "c.LastName"
          ],
          "role": "existence check"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN c.LastName IS NOT NULL THEN TRUE ELSE FALSE END"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.lastname",
          "path": [
            "p.lastname"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.lastname"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.firstname",
          "path": [
            "p.firstname"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.firstname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.middleinitial",
          "path": [
            "p.middleinitial"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.middleinitial"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.gender",
          "path": [
            "p.gender"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.gender"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.addressline1",
          "path": [
            "p.addressline1"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.addressline2",
          "path": [
            "p.addressline2"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.postalcode",
          "path": [
            "p.postalcode"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.city",
          "path": [
            "p.city"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.city"
    },
    "state": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.state",
          "path": [
            "p.state"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.state"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.country",
          "path": [
            "p.country"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.country"
    },
    "phone": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.phone",
          "path": [
            "p.phone"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.phone"
    },
    "income": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.income",
          "path": [
            "p.income"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.income"
    },
    "numbercars": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.numbercars",
          "path": [
            "p.numbercars"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.numbercars"
    },
    "numberchildren": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.numberchildren",
          "path": [
            "p.numberchildren"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.numberchildren"
    },
    "maritalstatus": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.maritalstatus",
          "path": [
            "p.maritalstatus"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.maritalstatus"
    },
    "age": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.age",
          "path": [
            "p.age"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.age"
    },
    "creditrating": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.creditrating",
          "path": [
            "p.creditrating"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.creditrating"
    },
    "ownorrentflag": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.ownorrentflag",
          "path": [
            "p.ownorrentflag"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.ownorrentflag"
    },
    "employer": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.employer",
          "path": [
            "p.employer"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.employer"
    },
    "numbercreditcards": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.numbercreditcards",
          "path": [
            "p.numbercreditcards"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.numbercreditcards"
    },
    "networth": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.networth",
          "path": [
            "p.networth"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.networth"
    },
    "marketingnameplate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.marketingnameplate",
          "path": [
            "p.marketingnameplate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "p.marketingnameplate"
    }
  }
}
```
2025-04-11 18:07:50,068 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:07:55,325 - INFO - AFC remote call 1 is done.
2025-04-11 18:07:55,325 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh.DimComp",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_stg.FW",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh.Ind",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate",
            "T.effectivedate"
          ],
          "role": "Date part source"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK",
            "T.compid"
          ],
          "role": "ID part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT)"
    },
    "compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cmp.CIK AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.Status"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CompName"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.CompName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh.Ind.in_name",
          "path": [],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_stg.FW.value",
              "path": [
                "cmp.IndID"
              ]
            },
            "right_source": {
              "identifier": "wh.Ind.in_id",
              "path": []
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.IndID = ind.in_id"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.RecDate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate), '9999-12-31'::DATE)",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:08:00,341 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:08:07,976 - INFO - AFC remote call 1 is done.
2025-04-11 18:08:07,976 - ERROR - Failed to decode JSON from response: Okay, I understand. I will analyze the provided SQL query and generate a JSON output that represents the column-level lineage, adhering to the specified format and instructions.

**Input SQL:**

```sql
-- Example Input SQL:
INSERT INTO wh.DimComp -- Shortened target
WITH cmp AS (
  SELECT
    TRIM(SUBSTR(value, 1, 10)) AS CompName, -- String op
    TRIM(SUBSTR(value, 11, 5)) AS CIK,     -- String op -> CAST source
    TRIM(SUBSTR(value, 16, 4)) AS Status,   -- CASE source
    TRIM(SUBSTR(value, 20, 2)) AS IndID,    -- JOIN key
    TRY_CAST(SUBSTR(value, 22, 8) AS DATE) AS RecDate -- CAST & Window func source
  FROM wh_stg.FW -- Shortened source
  WHERE rectype = 'CMP'
)
SELECT
  -- sk_compid derived from RecDate (-> effectivedate) & CIK (-> compid)
  CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT) AS sk_compid,
  T.compid,
  T.status,
  T.name,
  T.industry,
  T.effectivedate,
  T.enddate
FROM (
    SELECT
        CAST(cmp.CIK AS BIGINT) AS compid, -- Define compid
        CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END AS status, -- Define status
        cmp.CompName AS name, -- Define name
        ind.in_name AS industry, -- Define industry
        cmp.RecDate AS effectivedate, -- Define effectivedate
        COALESCE(
            LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate),
            '9999-12-31'::DATE
        ) AS enddate -- Define enddate (SCD2 Window Func)
    FROM cmp
    JOIN wh.Ind ind ON cmp.IndID = ind.in_id -- Shortened join table
) T -- Derived table
WHERE T.effectivedate < T.enddate; -- Filter on derived table
```

**Output JSON:**

```json
{
  "target_table": "wh.DimComp",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_stg.FW",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh.Ind",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate",
            "T.effectivedate"
          ],
          "role": "Date part source"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK",
            "T.compid"
          ],
          "role": "ID part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT)"
    },
    "compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cmp.CIK AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.Status"
          ],
          "role": "Input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CompName"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.CompName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh.Ind.in_name",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_stg.FW.value",
              "path": [
                "cmp.IndID"
              ]
            },
            "right_source": {
              "identifier": "wh.Ind.in_id"
            }
          },
          "role": "Direct Input"
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.IndID = ind.in_id"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.RecDate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate), '9999-12-31'::DATE)",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:08:12,979 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:08:18,907 - INFO - AFC remote call 1 is done.
2025-04-11 18:08:18,915 - ERROR - Failed to decode JSON from response: Okay, I understand the task. I need to analyze the provided SQL query, trace the lineage of each column in the final `INSERT` statement, and output the lineage information in the specified JSON format. I will pay close attention to CTEs, joins, `CASE` statements, window functions, string manipulations, type casting, constants, and SCD2 logic.

Here's the JSON output representing the column-level lineage for the provided SQL query:

```json
{
  "target_table": "wh.DimComp",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "wh_stg.FW",
      "alias_or_cte": "cmp"
    },
    {
      "type": "TABLE",
      "name": "wh.Ind",
      "alias_or_cte": "ind"
    }
  ],
  "lineage": {
    "sk_compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK",
            "T.compid"
          ],
          "role": "ID part source"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate",
            "T.effectivedate"
          ],
          "role": "Date part source"
        }
      ],
      "transformation_type": "EXPRESSION_CONCAT",
      "transformation_logic": "CAST(strftime(T.effectivedate, '%Y%m%d') || T.compid AS BIGINT)"
    },
    "compid": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "CAST(cmp.CIK AS BIGINT)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.Status"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE cmp.Status WHEN 'ACTV' THEN 'Active' ELSE 'Inactive' END"
    },
    "name": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CompName"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.CompName AS name"
    },
    "industry": {
      "sources": [
        {
          "source_identifier": "wh.Ind.in_name",
          "path": [],
          "role": "direct input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "wh_stg.FW.value",
              "path": [
                "cmp.IndID"
              ]
            },
            "right_source": {
              "identifier": "wh.Ind.in_id",
              "path": []
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "ind.in_name via JOIN ON cmp.IndID = ind.in_id"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "cmp.RecDate AS effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.RecDate"
          ],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "wh_stg.FW.value",
          "path": [
            "cmp.CIK"
          ],
          "role": "Partition key for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LEAD(cmp.RecDate) OVER (PARTITION BY cmp.CIK ORDER BY cmp.RecDate), '9999-12-31'::DATE)",
      "notes": "SCD2 end date calculation"
    }
  }
}
```
2025-04-11 18:08:23,916 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:08:29,363 - INFO - AFC remote call 1 is done.
2025-04-11 18:08:29,363 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimBroker",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "temp_broker",
      "alias_or_cte": null
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimDate",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "sk_brokerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid AS sk_brokerid"
    },
    "brokerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeid AS brokerid"
    },
    "managerid": {
      "sources": [
        {
          "source_identifier": "temp_broker.managerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "managerid"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeefirstname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeefirstname AS firstname"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeelastname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeelastname AS lastname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeemi",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeemi AS middleinitial"
    },
    "branch": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeebranch",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeebranch AS branch"
    },
    "office": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeeoffice",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeeoffice AS office"
    },
    "phone": {
      "sources": [
        {
          "source_identifier": "temp_broker.employeephone",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employeephone AS phone"
    },
    "iscurrent": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "true",
      "notes": "Hardcoded value"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1",
      "notes": "Hardcoded value"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "wh_db.DimDate.datevalue",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "AGGREGATION",
      "transformation_logic": "(SELECT min(datevalue::DATE) as effectivedate FROM wh_db.DimDate)",
      "notes": "Minimum date from DimDate"
    },
    "enddate": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "'9999-12-31'::DATE",
      "notes": "Hardcoded value"
    }
  }
}
```
2025-04-11 18:08:34,371 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:08:37,255 - INFO - AFC remote call 1 is done.
2025-04-11 18:08:37,255 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.FinWire",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true)",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "rectype": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true).column0",
          "path": [],
          "role": "Condition and value source"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN SUBSTR(column0, 16, 3) = 'FIN' THEN CASE WHEN TRY_CAST(TRIM(SUBSTR(column0, 187, 60)) AS BIGINT) IS NOT NULL THEN 'FIN_COMPANYID' ELSE 'FIN_NAME' END ELSE SUBSTR(column0, 16, 3) END"
    },
    "recdate": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true).column0",
          "path": [],
          "role": "Date string"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "STRPTIME(SUBSTR(column0, 1, 8), '%Y%m%d')"
    },
    "value": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\FINWIRE1967Q2', HEADER=FALSE, filename=false, all_varchar=true).column0",
          "path": [],
          "role": "Value"
        }
      ],
      "transformation_type": "SUBSTRING",
      "transformation_logic": "SUBSTR(column0, 19)"
    }
  }
}
```
2025-04-11 18:08:42,264 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:09:07,714 - INFO - AFC remote call 1 is done.
2025-04-11 18:09:07,730 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_propect",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False)",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "agencyid": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).agencyid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "agencyid"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).lastname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "lastname"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).firstname",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "firstname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).middleinitial",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "middleinitial"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).gender",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "gender"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).addressline1",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).addressline2",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).postalcode",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).city",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "city"
    },
    "state": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).state",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "state"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).country",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "country"
    },
    "phone": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).phone",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "phone"
    },
    "income": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).income",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "income"
    },
    "numbercars": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).numbercars",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numbercars"
    },
    "numberchildren": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).numberchildren",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numberchildren"
    },
    "maritalstatus": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).maritalstatus",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "maritalstatus"
    },
    "age": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).age",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "age"
    },
    "creditrating": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).creditrating",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "creditrating"
    },
    "ownorrentflag": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).ownorrentflag",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "ownorrentflag"
    },
    "employer": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).employer",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "employer"
    },
    "numbercreditcards": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).numbercreditcards",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numbercreditcards"
    },
    "networth": {
      "sources": [
        {
          "source_identifier": "read_csv_auto('src/data/Batch1\\Prospect.csv', columns={\"agencyid\": \"STRING\", \"lastname\": \"STRING\", \"firstname\": \"STRING\", \"middleinitial\": \"STRING\", \"gender\": \"STRING\", \"addressline1\": \"STRING\", \"addressline2\": \"STRING\", \"postalcode\": \"STRING\", \"city\": \"STRING\", \"state\": \"STRING\", \"country\": \"STRING\", \"phone\": \"STRING\", \"income\": \"INT\", \"numbercars\": \"INT\", \"numberchildren\": \"INT\", \"maritalstatus\": \"STRING\", \"age\": \"INT\", \"creditrating\": \"INT\", \"ownorrentflag\": \"STRING\", \"employer\": \"STRING\", \"numbercreditcards\": \"INT\", \"networth\": \"INT\"}, header=False).networth",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "networth"
    },
    "batchid": {
      "sources": [],
      "transformation_type": "CONSTANT",
      "transformation_logic": "1"
    }
  }
}
```
2025-04-11 18:09:12,736 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:09:19,102 - INFO - AFC remote call 1 is done.
2025-04-11 18:09:19,112 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.tradetxt",
  "sources_summary": [
    {
      "type": "FUNCTION",
      "name": "read_csv",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "tradeid": {
      "sources": [
        {
          "source_identifier": "read_csv.V1",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V1 AS tradeid"
    },
    "t_dts": {
      "sources": [
        {
          "source_identifier": "read_csv.V2",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V2 AS t_dts"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "read_csv.V3",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V3 AS status"
    },
    "t_tt_id": {
      "sources": [
        {
          "source_identifier": "read_csv.V4",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V4 AS t_tt_id"
    },
    "cashflag": {
      "sources": [
        {
          "source_identifier": "read_csv.V5",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V5 AS cashflag"
    },
    "t_s_symb": {
      "sources": [
        {
          "source_identifier": "read_csv.V6",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V6 AS t_s_symb"
    },
    "quantity": {
      "sources": [
        {
          "source_identifier": "read_csv.V7",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V7 AS quantity"
    },
    "bidprice": {
      "sources": [
        {
          "source_identifier": "read_csv.V8",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V8 AS bidprice"
    },
    "t_ca_id": {
      "sources": [
        {
          "source_identifier": "read_csv.V9",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V9 AS t_ca_id"
    },
    "executedby": {
      "sources": [
        {
          "source_identifier": "read_csv.V10",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V10 AS executedby"
    },
    "tradeprice": {
      "sources": [
        {
          "source_identifier": "read_csv.V11",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V11 AS tradeprice"
    },
    "fee": {
      "sources": [
        {
          "source_identifier": "read_csv.V12",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V12 AS fee"
    },
    "commission": {
      "sources": [
        {
          "source_identifier": "read_csv.V13",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V13 AS commission"
    },
    "tax": {
      "sources": [
        {
          "source_identifier": "read_csv.V14",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "V14 AS tax"
    }
  }
}
```
2025-04-11 18:09:24,116 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:09:42,859 - INFO - AFC remote call 1 is done.
2025-04-11 18:09:42,881 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "customers_final",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "customers",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "customerid": {
      "sources": [
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "customerid"
    },
    "taxid": {
      "sources": [
        {
          "source_identifier": "customers.taxid",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "customers.status",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "status"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "customers.lastname",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "customers.firstname",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "customers.middleinitial",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "customers.gender",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)"
    },
    "tier": {
      "sources": [
        {
          "source_identifier": "customers.tier",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)"
    },
    "dob": {
      "sources": [
        {
          "source_identifier": "customers.dob",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "customers.addressline1",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "customers.addressline2",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "customers.postalcode",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)"
    },
    "CITY": {
      "sources": [
        {
          "source_identifier": "customers.CITY",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)"
    },
    "stateprov": {
      "sources": [
        {
          "source_identifier": "customers.stateprov",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "customers.country",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)"
    },
    "phone1": {
      "sources": [
        {
          "source_identifier": "customers.phone1",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)"
    },
    "phone2": {
      "sources": [
        {
          "source_identifier": "customers.phone2",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)"
    },
    "phone3": {
      "sources": [
        {
          "source_identifier": "customers.phone3",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)"
    },
    "email1": {
      "sources": [
        {
          "source_identifier": "customers.email1",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)"
    },
    "email2": {
      "sources": [
        {
          "source_identifier": "customers.email2",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)"
    },
    "LCL_TX_ID": {
      "sources": [
        {
          "source_identifier": "customers.LCL_TX_ID",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)"
    },
    "NAT_TX_ID": {
      "sources": [
        {
          "source_identifier": "customers.NAT_TX_ID",
          "path": [],
          "role": "Input for LAST_VALUE"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LAST_VALUE"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LAST_VALUE"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "customers.batchid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "batchid"
    },
    "iscurrent": {
      "sources": [
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LEAD"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LEAD"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN NULLIF(lead(update_ts) OVER w, NULL) IS NULL THEN 'Y' ELSE 'N' END"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "CAST",
      "transformation_logic": "update_ts::DATE"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Input for LEAD"
        },
        {
          "source_identifier": "customers.customerid",
          "path": [],
          "role": "Partition by for LEAD"
        },
        {
          "source_identifier": "customers.update_ts",
          "path": [],
          "role": "Order by for LEAD"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "COALESCE(lead(update_ts::DATE) OVER w, '9999-12-31'::DATE)"
    }
  }
}
```
2025-04-11 18:09:47,885 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:09:55,411 - INFO - AFC remote call 1 is done.
2025-04-11 18:09:55,414 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "temp_propect_marketingnameplate",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "temp_propect",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "age": {
      "sources": [
        {
          "source_identifier": "temp_propect.age",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "age"
    },
    "income": {
      "sources": [
        {
          "source_identifier": "temp_propect.income",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "income"
    },
    "networth": {
      "sources": [
        {
          "source_identifier": "temp_propect.networth",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "networth"
    },
    "numberchildren": {
      "sources": [
        {
          "source_identifier": "temp_propect.numberchildren",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numberchildren"
    },
    "numbercreditcards": {
      "sources": [
        {
          "source_identifier": "temp_propect.numbercreditcards",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numbercreditcards"
    },
    "numbercars": {
      "sources": [
        {
          "source_identifier": "temp_propect.numbercars",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "numbercars"
    },
    "creditrating": {
      "sources": [
        {
          "source_identifier": "temp_propect.creditrating",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "creditrating"
    },
    "marketingnameplate": {
      "sources": [
        {
          "source_identifier": "temp_propect.networth",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.income",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.numberchildren",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.numbercreditcards",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.age",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.income",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.creditrating",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.networth",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.numbercars",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.numbercreditcards",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.age",
          "path": [],
          "role": "condition"
        },
        {
          "source_identifier": "temp_propect.networth",
          "path": [],
          "role": "condition"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "CASE WHEN LENGTH(CONCAT(CASE WHEN networth > 1000000 OR income > 200000 THEN 'HighValue+' ELSE '' END, CASE WHEN numberchildren > 3 OR numbercreditcards > 5 THEN 'Expenses+' ELSE '' END, CASE WHEN age > 45 THEN 'Boomer+' ELSE '' END, CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END, CASE WHEN numbercars > 3 OR numbercreditcards > 7 THEN 'Spender+' ELSE '' END, CASE WHEN age < 25 AND networth > 1000000 THEN 'Inherited+' ELSE '' END)) > 0 THEN LEFT(CONCAT(CASE WHEN networth > 1000000 OR income > 200000 THEN 'HighValue+' ELSE '' END, CASE WHEN numberchildren > 3 OR numbercreditcards > 5 THEN 'Expenses+' ELSE '' END, CASE WHEN age > 45 THEN 'Boomer+' ELSE '' END, CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END, CASE WHEN numbercars > 3 OR numbercreditcards > 7 THEN 'Spender+' ELSE '' END, CASE WHEN age < 25 AND networth > 1000000 THEN 'Inherited+' ELSE '' END), LENGTH(CONCAT(CASE WHEN networth > 1000000 OR income > 200000 THEN 'HighValue+' ELSE '' END, CASE WHEN numberchildren > 3 OR numbercreditcards > 5 THEN 'Expenses+' ELSE '' END, CASE WHEN age > 45 THEN 'Boomer+' ELSE '' END, CASE WHEN income < 50000 OR creditrating < 600 OR networth < 100000 THEN 'MoneyAlert+' ELSE '' END, CASE WHEN numbercars > 3 OR numbercreditcards > 7 THEN 'Spender+' ELSE '' END, CASE WHEN age < 25 AND networth > 1000000 THEN 'Inherited+' ELSE '' END)) - 1) ELSE NULL END"
    }
  }
}
```
2025-04-11 18:10:00,423 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:10:02,335 - INFO - AFC remote call 1 is done.
2025-04-11 18:10:02,335 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.tradehistory",
  "sources_summary": [
    {
      "type": "FUNCTION",
      "name": "read_csv_auto",
      "alias_or_cte": null
    }
  ],
  "lineage": {
    "tradeid": {
      "sources": [
        {
          "source_identifier": "read_csv_auto.tradeid",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tradeid"
    },
    "th_dts": {
      "sources": [
        {
          "source_identifier": "read_csv_auto.th_dts",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "th_dts"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "read_csv_auto.status",
          "path": [],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "status"
    }
  }
}
```
2025-04-11 18:10:07,349 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:10:28,629 - INFO - AFC remote call 1 is done.
2025-04-11 18:10:28,637 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db.DimCustomer",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "customers_final",
      "alias_or_cte": "c"
    },
    {
      "type": "TABLE",
      "name": "wh_db.TaxRate",
      "alias_or_cte": "r_lcl"
    },
    {
      "type": "TABLE",
      "name": "wh_db.TaxRate",
      "alias_or_cte": "r_nat"
    },
    {
      "type": "TABLE",
      "name": "wh_db_stage.ProspectIncremental",
      "alias_or_cte": "p"
    },
    {
      "type": "TABLE",
      "name": "wh_db.DimCustomer",
      "alias_or_cte": "MaxSK"
    }
  ],
  "lineage": {
    "sk_customerid": {
      "sources": [
        {
          "source_identifier": "wh_db.DimCustomer.sk_customerid",
          "path": [
            "MaxSK.max_sk_customerid"
          ],
          "role": "Max SK Value"
        }
      ],
      "transformation_type": "WINDOW_FUNCTION",
      "transformation_logic": "ROW_NUMBER() OVER () + (SELECT max_sk_customerid FROM MaxSK) + 1",
      "notes": "Incrementing surrogate key"
    },
    "customerid": {
      "sources": [
        {
          "source_identifier": "customers_final.customerid",
          "path": [
            "CustomerData.customerid"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.customerid"
    },
    "taxid": {
      "sources": [
        {
          "source_identifier": "customers_final.taxid",
          "path": [
            "CustomerData.taxid"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.taxid"
    },
    "status": {
      "sources": [
        {
          "source_identifier": "customers_final.status",
          "path": [
            "CustomerData.status"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.status"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "customers_final.lastname",
          "path": [
            "CustomerData.lastname"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.lastname"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "customers_final.firstname",
          "path": [
            "CustomerData.firstname"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.firstname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "customers_final.middleinitial",
          "path": [
            "CustomerData.middleinitial"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.middleinitial"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "customers_final.gender",
          "path": [
            "CustomerData.gender"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "CASE_MAPPING",
      "transformation_logic": "IF(c.gender IN ('M', 'F'), c.gender, 'U')"
    },
    "tier": {
      "sources": [
        {
          "source_identifier": "customers_final.tier",
          "path": [
            "CustomerData.tier"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.tier"
    },
    "dob": {
      "sources": [
        {
          "source_identifier": "customers_final.dob",
          "path": [
            "CustomerData.dob"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.dob"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "customers_final.addressline1",
          "path": [
            "CustomerData.addressline1"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "customers_final.addressline2",
          "path": [
            "CustomerData.addressline2"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "customers_final.postalcode",
          "path": [
            "CustomerData.postalcode"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "customers_final.city",
          "path": [
            "CustomerData.city"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.city"
    },
    "stateprov": {
      "sources": [
        {
          "source_identifier": "customers_final.stateprov",
          "path": [
            "CustomerData.stateprov"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.stateprov"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "customers_final.country",
          "path": [
            "CustomerData.country"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.country"
    },
    "phone1": {
      "sources": [
        {
          "source_identifier": "customers_final.phone1",
          "path": [
            "CustomerData.phone1"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone1"
    },
    "phone2": {
      "sources": [
        {
          "source_identifier": "customers_final.phone2",
          "path": [
            "CustomerData.phone2"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone2"
    },
    "phone3": {
      "sources": [
        {
          "source_identifier": "customers_final.phone3",
          "path": [
            "CustomerData.phone3"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.phone3"
    },
    "email1": {
      "sources": [
        {
          "source_identifier": "customers_final.email1",
          "path": [
            "CustomerData.email1"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.email1"
    },
    "email2": {
      "sources": [
        {
          "source_identifier": "customers_final.email2",
          "path": [
            "CustomerData.email2"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.email2"
    },
    "nationaltaxratedesc": {
      "sources": [
        {
          "source_identifier": "wh_db.TaxRate.TX_NAME",
          "path": [
            "CustomerData.nationaltaxratedesc"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "customers_final.nat_tx_id",
              "path": [
                "c.nat_tx_id"
              ]
            },
            "right_source": {
              "identifier": "wh_db.TaxRate.TX_ID",
              "path": [
                "r_nat.TX_ID"
              ]
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "r_nat.TX_NAME"
    },
    "nationaltaxrate": {
      "sources": [
        {
          "source_identifier": "wh_db.TaxRate.TX_RATE",
          "path": [
            "CustomerData.nationaltaxrate"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "customers_final.nat_tx_id",
              "path": [
                "c.nat_tx_id"
              ]
            },
            "right_source": {
              "identifier": "wh_db.TaxRate.TX_ID",
              "path": [
                "r_nat.TX_ID"
              ]
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "r_nat.TX_RATE"
    },
    "localtaxratedesc": {
      "sources": [
        {
          "source_identifier": "wh_db.TaxRate.TX_NAME",
          "path": [
            "CustomerData.localtaxratedesc"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "customers_final.lcl_tx_id",
              "path": [
                "c.lcl_tx_id"
              ]
            },
            "right_source": {
              "identifier": "wh_db.TaxRate.TX_ID",
              "path": [
                "r_lcl.TX_ID"
              ]
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "r_lcl.TX_NAME"
    },
    "localtaxrate": {
      "sources": [
        {
          "source_identifier": "wh_db.TaxRate.TX_RATE",
          "path": [
            "CustomerData.localtaxrate"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "INNER JOIN",
            "left_source": {
              "identifier": "customers_final.lcl_tx_id",
              "path": [
                "c.lcl_tx_id"
              ]
            },
            "right_source": {
              "identifier": "wh_db.TaxRate.TX_ID",
              "path": [
                "r_lcl.TX_ID"
              ]
            }
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "r_lcl.TX_RATE"
    },
    "agencyid": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.agencyid",
          "path": [
            "CustomerData.agencyid"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "LEFT JOIN",
            "left_source": {
              "identifier": "customers_final.lastname",
              "path": [
                "c.lastname"
              ]
            },
            "right_source": {
              "identifier": "wh_db_stage.ProspectIncremental.lastname",
              "path": [
                "p.lastname"
              ]
            },
            "join_condition": "UPPER(p.lastname) = UPPER(c.lastname) AND UPPER(p.firstname) = UPPER(c.firstname) AND UPPER(p.addressline1) = UPPER(c.addressline1) AND UPPER(NULLIF(p.addressline2, '')) = UPPER(NULLIF(c.addressline2, '')) AND UPPER(p.postalcode) = UPPER(c.postalcode)"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "p.agencyid"
    },
    "creditrating": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.creditrating",
          "path": [
            "CustomerData.creditrating"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "LEFT JOIN",
            "left_source": {
              "identifier": "customers_final.lastname",
              "path": [
                "c.lastname"
              ]
            },
            "right_source": {
              "identifier": "wh_db_stage.ProspectIncremental.lastname",
              "path": [
                "p.lastname"
              ]
            },
            "join_condition": "UPPER(p.lastname) = UPPER(c.lastname) AND UPPER(p.firstname) = UPPER(c.firstname) AND UPPER(p.addressline1) = UPPER(c.addressline1) AND UPPER(NULLIF(p.addressline2, '')) = UPPER(NULLIF(c.addressline2, '')) AND UPPER(p.postalcode) = UPPER(c.postalcode)"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "p.creditrating"
    },
    "networth": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.networth",
          "path": [
            "CustomerData.networth"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "LEFT JOIN",
            "left_source": {
              "identifier": "customers_final.lastname",
              "path": [
                "c.lastname"
              ]
            },
            "right_source": {
              "identifier": "wh_db_stage.ProspectIncremental.lastname",
              "path": [
                "p.lastname"
              ]
            },
            "join_condition": "UPPER(p.lastname) = UPPER(c.lastname) AND UPPER(p.firstname) = UPPER(c.firstname) AND UPPER(p.addressline1) = UPPER(c.addressline1) AND UPPER(NULLIF(p.addressline2, '')) = UPPER(NULLIF(c.addressline2, '')) AND UPPER(p.postalcode) = UPPER(c.postalcode)"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "p.networth"
    },
    "marketingnameplate": {
      "sources": [
        {
          "source_identifier": "wh_db_stage.ProspectIncremental.marketingnameplate",
          "path": [
            "CustomerData.marketingnameplate"
          ],
          "role": "Direct Input",
          "join_info": {
            "type": "LEFT JOIN",
            "left_source": {
              "identifier": "customers_final.lastname",
              "path": [
                "c.lastname"
              ]
            },
            "right_source": {
              "identifier": "wh_db_stage.ProspectIncremental.lastname",
              "path": [
                "p.lastname"
              ]
            },
            "join_condition": "UPPER(p.lastname) = UPPER(c.lastname) AND UPPER(p.firstname) = UPPER(c.firstname) AND UPPER(p.addressline1) = UPPER(c.addressline1) AND UPPER(NULLIF(p.addressline2, '')) = UPPER(NULLIF(c.addressline2, '')) AND UPPER(p.postalcode) = UPPER(c.postalcode)"
          }
        }
      ],
      "transformation_type": "JOIN_LOOKUP",
      "transformation_logic": "p.marketingnameplate"
    },
    "iscurrent": {
      "sources": [
        {
          "source_identifier": "customers_final.iscurrent",
          "path": [
            "CustomerData.iscurrent"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.iscurrent"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "customers_final.batchid",
          "path": [
            "CustomerData.batchid"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.batchid"
    },
    "effectivedate": {
      "sources": [
        {
          "source_identifier": "customers_final.effectivedate",
          "path": [
            "CustomerData.effectivedate"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.effectivedate"
    },
    "enddate": {
      "sources": [
        {
          "source_identifier": "customers_final.enddate",
          "path": [
            "CustomerData.enddate"
          ],
          "role": "Direct Input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "c.enddate"
    }
  }
}
```
2025-04-11 18:10:33,645 - INFO - AFC is enabled with max remote calls: 10.
2025-04-11 18:10:44,712 - INFO - AFC remote call 1 is done.
2025-04-11 18:10:44,712 - ERROR - Failed to decode JSON from response: ```json
{
  "target_table": "wh_db_stage.ProspectIncremental",
  "sources_summary": [
    {
      "type": "TABLE",
      "name": "temp_propect_marketingnameplate",
      "alias_or_cte": "tp"
    }
  ],
  "lineage": {
    "agencyid": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.agencyid",
          "path": [
            "tp.agencyid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.agencyid"
    },
    "lastname": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.lastname",
          "path": [
            "tp.lastname"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.lastname"
    },
    "firstname": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.firstname",
          "path": [
            "tp.firstname"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.firstname"
    },
    "middleinitial": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.middleinitial",
          "path": [
            "tp.middleinitial"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.middleinitial"
    },
    "gender": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.gender",
          "path": [
            "tp.gender"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.gender"
    },
    "addressline1": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.addressline1",
          "path": [
            "tp.addressline1"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.addressline1"
    },
    "addressline2": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.addressline2",
          "path": [
            "tp.addressline2"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.addressline2"
    },
    "postalcode": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.postalcode",
          "path": [
            "tp.postalcode"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.postalcode"
    },
    "city": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.city",
          "path": [
            "tp.city"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.city"
    },
    "state": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.state",
          "path": [
            "tp.state"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.state"
    },
    "country": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.country",
          "path": [
            "tp.country"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.country"
    },
    "phone": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.phone",
          "path": [
            "tp.phone"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.phone"
    },
    "income": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.income",
          "path": [
            "tp.income"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.income"
    },
    "numbercars": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.numbercars",
          "path": [
            "tp.numbercars"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.numbercars"
    },
    "numberchildren": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.numberchildren",
          "path": [
            "tp.numberchildren"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.numberchildren"
    },
    "maritalstatus": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.maritalstatus",
          "path": [
            "tp.maritalstatus"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.maritalstatus"
    },
    "age": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.age",
          "path": [
            "tp.age"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.age"
    },
    "creditrating": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.creditrating",
          "path": [
            "tp.creditrating"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.creditrating"
    },
    "ownorrentflag": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.ownorrentflag",
          "path": [
            "tp.ownorrentflag"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.ownorrentflag"
    },
    "employer": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.employer",
          "path": [
            "tp.employer"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.employer"
    },
    "numbercreditcards": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.numbercreditcards",
          "path": [
            "tp.numbercreditcards"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.numbercreditcards"
    },
    "networth": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.networth",
          "path": [
            "tp.networth"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.networth"
    },
    "marketingnameplate": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.marketingnameplate",
          "path": [
            "tp.marketingnameplate"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.marketingnameplate"
    },
    "recordbatchid": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.batchid",
          "path": [
            "tp.batchid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.batchid"
    },
    "batchid": {
      "sources": [
        {
          "source_identifier": "temp_propect_marketingnameplate.batchid",
          "path": [
            "tp.batchid"
          ],
          "role": "direct input"
        }
      ],
      "transformation_type": "RENAME",
      "transformation_logic": "tp.batchid"
    }
  }
}
```
