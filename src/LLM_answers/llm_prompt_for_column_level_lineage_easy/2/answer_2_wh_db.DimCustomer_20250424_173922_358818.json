{
    "customerid": {
        "input": "customers.customerid"
    },
    "taxid": {
        "inputs": [
            {
                "column": "customers.taxid",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(taxid ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(taxid, last_value(taxid ORDER BY update_ts DESC) OVER w)"
    },
    "status": {
        "input": "customers.status"
    },
    "lastname": {
        "inputs": [
            {
                "column": "customers.lastname",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(lastname ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(lastname, last_value(lastname ORDER BY update_ts DESC) OVER w)"
    },
    "firstname": {
        "inputs": [
            {
                "column": "customers.firstname",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(firstname ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(firstname, last_value(firstname ORDER BY update_ts DESC) OVER w)"
    },
    "middleinitial": {
        "inputs": [
            {
                "column": "customers.middleinitial",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(middleinitial ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(middleinitial, last_value(middleinitial ORDER BY update_ts DESC) OVER w)"
    },
    "gender": {
        "inputs": [
            {
                "column": "customers.gender",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(gender ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(gender, last_value(gender ORDER BY update_ts DESC) OVER w)"
    },
    "tier": {
        "inputs": [
            {
                "column": "customers.tier",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(tier ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(tier, last_value(tier ORDER BY update_ts DESC) OVER w)"
    },
    "dob": {
        "inputs": [
            {
                "column": "customers.dob",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(dob ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(dob, last_value(dob ORDER BY update_ts DESC) OVER w)"
    },
    "addressline1": {
        "inputs": [
            {
                "column": "customers.addressline1",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(addressline1 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(addressline1, last_value(addressline1 ORDER BY update_ts DESC) OVER w)"
    },
    "addressline2": {
        "inputs": [
            {
                "column": "customers.addressline2",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(addressline2 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(addressline2, last_value(addressline2 ORDER BY update_ts DESC) OVER w)"
    },
    "postalcode": {
        "inputs": [
            {
                "column": "customers.postalcode",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(postalcode ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(postalcode, last_value(postalcode ORDER BY update_ts DESC) OVER w)"
    },
    "CITY": {
        "inputs": [
            {
                "column": "customers.CITY",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(CITY ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(CITY, last_value(CITY ORDER BY update_ts DESC) OVER w)"
    },
    "stateprov": {
        "inputs": [
            {
                "column": "customers.stateprov",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(stateprov ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(stateprov, last_value(stateprov ORDER BY update_ts DESC) OVER w)"
    },
    "country": {
        "inputs": [
            {
                "column": "customers.country",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(country ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(country, last_value(country ORDER BY update_ts DESC) OVER w)"
    },
    "phone1": {
        "inputs": [
            {
                "column": "customers.phone1",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(phone1 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(phone1, last_value(phone1 ORDER BY update_ts DESC) OVER w)"
    },
    "phone2": {
        "inputs": [
            {
                "column": "customers.phone2",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(phone2 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(phone2, last_value(phone2 ORDER BY update_ts DESC) OVER w)"
    },
    "phone3": {
        "inputs": [
            {
                "column": "customers.phone3",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(phone3 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(phone3, last_value(phone3 ORDER BY update_ts DESC) OVER w)"
    },
    "email1": {
        "inputs": [
            {
                "column": "customers.email1",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(email1 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(email1, last_value(email1 ORDER BY update_ts DESC) OVER w)"
    },
    "email2": {
        "inputs": [
            {
                "column": "customers.email2",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(email2 ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(email2, last_value(email2 ORDER BY update_ts DESC) OVER w)"
    },
    "LCL_TX_ID": {
        "inputs": [
            {
                "column": "customers.LCL_TX_ID",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(LCL_TX_ID, last_value(LCL_TX_ID ORDER BY update_ts DESC) OVER w)"
    },
    "NAT_TX_ID": {
        "inputs": [
            {
                "column": "customers.NAT_TX_ID",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)",
                "masking": false
            },
            {
                "column": "customers.update_ts",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(NAT_TX_ID, last_value(NAT_TX_ID ORDER BY update_ts DESC) OVER w)"
    },
    "batchid": {
        "input": "customers.batchid"
    },
    "iscurrent": {
        "inputs": [
            {
                "column": "customers.update_ts",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "lead(update_ts) OVER w",
                "masking": false
            }
        ],
        "transformation": "CASE WHEN NULLIF(lead(update_ts) OVER w, NULL) IS NULL THEN 'Y' ELSE 'N' END"
    },
    "effectivedate": {
        "inputs": [
            {
                "column": "customers.update_ts",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "update_ts::DATE",
                "masking": false
            }
        ],
        "transformation": "update_ts::DATE"
    },
    "enddate": {
        "inputs": [
            {
                "column": "customers.update_ts",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "lead(update_ts::DATE) OVER w",
                "masking": false
            }
        ],
        "transformation": "COALESCE(lead(update_ts::DATE) OVER w, '9999-12-31'::DATE)"
    }
}