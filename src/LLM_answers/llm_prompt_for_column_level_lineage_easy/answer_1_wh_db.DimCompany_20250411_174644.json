{
    "sk_companyid": {
        "inputs": [
            {
                "column": "cmp.cik",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "CAST(cik AS BIGINT)",
                "masking": false
            },
            {
                "column": "cmp.recdate",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "strftime(effectivedate, '%Y%m%d')",
                "masking": false
            }
        ],
        "transformation": "CAST(strftime(effectivedate, '%Y%m%d') || companyid AS BIGINT)"
    },
    "companyid": {
        "inputs": [
            {
                "column": "cmp.cik",
                "type": "DIRECT",
                "subtype": "Transformation",
                "description": "CAST(cik AS BIGINT)",
                "masking": false
            }
        ],
        "transformation": "CAST(cik AS BIGINT)"
    },
    "status": {
        "inputs": [
            {
                "column": "cmp.status",
                "type": "DIRECT",
                "subtype": "Conditional",
                "description": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END",
                "masking": false
            }
        ],
        "transformation": "CASE cmp.status WHEN 'ACTV' THEN 'Active' WHEN 'CMPT' THEN 'Completed' WHEN 'CNCL' THEN 'Canceled' WHEN 'PNDG' THEN 'Pending' WHEN 'SBMT' THEN 'Submitted' WHEN 'INAC' THEN 'Inactive' ELSE NULL END"
    },
    "name": {
        "input": "cmp.CompanyName"
    },
    "industry": {
        "inputs": [
            {
                "column": "wh_db.industry.in_name",
                "type": "DIRECT",
                "subtype": "Join",
                "description": "industry name from wh_db.industry table",
                "masking": false
            }
        ]
    },
    "sprating": {
        "inputs": [
            {
                "column": "cmp.SPrating",
                "type": "DIRECT",
                "subtype": "Conditional",
                "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END",
                "masking": false
            }
        ],
        "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'AA+', 'AA-', 'A', 'A+', 'A-', 'BBB', 'BBB+', 'BBB-', 'BB', 'BB+', 'BB-', 'B', 'B+', 'B-', 'CCC', 'CCC+', 'CCC-', 'CC', 'C', 'D') THEN SPrating ELSE NULL::VARCHAR END"
    },
    "islowgrade": {
        "inputs": [
            {
                "column": "cmp.SPrating",
                "type": "DIRECT",
                "subtype": "Conditional",
                "description": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END",
                "masking": false
            }
        ],
        "transformation": "CASE WHEN SPrating IN ('AAA', 'AA', 'A', 'AA+', 'A+', 'AA-', 'A-', 'BBB', 'BBB+', 'BBB-') THEN FALSE WHEN SPrating IN ('BB', 'B', 'CCC', 'CC', 'C', 'D', 'BB+', 'B+', 'CCC+', 'BB-', 'B-', 'CCC-') THEN TRUE ELSE NULL::BOOLEAN END"
    },
    "ceo": {
        "input": "cmp.CEOname"
    },
    "addressline1": {
        "input": "cmp.AddrLine1"
    },
    "addressline2": {
        "input": "cmp.AddrLine2"
    },
    "postalcode": {
        "input": "cmp.PostalCode"
    },
    "city": {
        "input": "cmp.City"
    },
    "stateprov": {
        "input": "cmp.StateProvince"
    },
    "country": {
        "input": "cmp.Country"
    },
    "description": {
        "input": "cmp.Description"
    },
    "foundingdate": {
        "input": "cmp.FoundingDate"
    },
    "iscurrent": {
        "inputs": [
            {
                "column": "enddate",
                "type": "DIRECT",
                "subtype": "Conditional",
                "description": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END",
                "masking": false
            }
        ],
        "transformation": "CASE WHEN enddate = '9999-12-31'::DATE THEN TRUE ELSE FALSE END"
    },
    "batchid": {
        "input": "1"
    },
    "effectivedate": {
        "input": "cmp.recdate"
    },
    "enddate": {
        "inputs": [
            {
                "column": "cmp.recdate",
                "type": "DIRECT",
                "subtype": "Window",
                "description": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))",
                "masking": false
            },
            {
                "column": "cmp.cik",
                "type": "INDIRECT",
                "subtype": "Window",
                "description": "PARTITION BY cik",
                "masking": false
            }
        ],
        "transformation": "COALESCE(LEAD(try_cast(recdate AS DATE)) OVER (PARTITION BY cik ORDER BY recdate), try_cast('9999-12-31' AS DATE))"
    }
}